!function(){var e,t,r;!function(a){function n(e,t){return v.call(e,t)}function s(e,t){var r,a,n,s,i,o,c,u,l,p,d,f=t&&t.split("/"),y=m.map,C=y&&y["*"]||{};if(e&&"."===e.charAt(0))if(t){for(f=f.slice(0,f.length-1),e=e.split("/"),i=e.length-1,m.nodeIdCompat&&T.test(e[i])&&(e[i]=e[i].replace(T,"")),e=f.concat(e),l=0;l<e.length;l+=1)if(d=e[l],"."===d)e.splice(l,1),l-=1;else if(".."===d){if(1===l&&(".."===e[2]||".."===e[0]))break;l>0&&(e.splice(l-1,2),l-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((f||C)&&y){for(r=e.split("/"),l=r.length;l>0;l-=1){if(a=r.slice(0,l).join("/"),f)for(p=f.length;p>0;p-=1)if(n=y[f.slice(0,p).join("/")],n&&(n=n[a])){s=n,o=l;break}if(s)break;!c&&C&&C[a]&&(c=C[a],u=l)}!s&&c&&(s=c,o=u),s&&(r.splice(0,o,s),e=r.join("/"))}return e}function i(e,t){return function(){return f.apply(a,I.call(arguments,0).concat([e,t]))}}function o(e){return function(t){return s(t,e)}}function c(e){return function(t){g[e]=t}}function u(e){if(n(h,e)){var t=h[e];delete h[e],E[e]=!0,d.apply(a,t)}if(!n(g,e)&&!n(E,e))throw new Error("No "+e);return g[e]}function l(e){var t,r=e?e.indexOf("!"):-1;return r>-1&&(t=e.substring(0,r),e=e.substring(r+1,e.length)),[t,e]}function p(e){return function(){return m&&m.config&&m.config[e]||{}}}var d,f,y,C,g={},h={},m={},E={},v=Object.prototype.hasOwnProperty,I=[].slice,T=/\.js$/;y=function(e,t){var r,a=l(e),n=a[0];return e=a[1],n&&(n=s(n,t),r=u(n)),n?e=r&&r.normalize?r.normalize(e,o(t)):s(e,t):(e=s(e,t),a=l(e),n=a[0],e=a[1],n&&(r=u(n))),{f:n?n+"!"+e:e,n:e,pr:n,p:r}},C={require:function(e){return i(e)},exports:function(e){var t=g[e];return"undefined"!=typeof t?t:g[e]={}},module:function(e){return{id:e,uri:"",exports:g[e],config:p(e)}}},d=function(e,t,r,s){var o,l,p,d,f,m,v=[],I=typeof r;if(s=s||e,"undefined"===I||"function"===I){for(t=!t.length&&r.length?["require","exports","module"]:t,f=0;f<t.length;f+=1)if(d=y(t[f],s),l=d.f,"require"===l)v[f]=C.require(e);else if("exports"===l)v[f]=C.exports(e),m=!0;else if("module"===l)o=v[f]=C.module(e);else if(n(g,l)||n(h,l)||n(E,l))v[f]=u(l);else{if(!d.p)throw new Error(e+" missing "+l);d.p.load(d.n,i(s,!0),c(l),{}),v[f]=g[l]}p=r?r.apply(g[e],v):void 0,e&&(o&&o.exports!==a&&o.exports!==g[e]?g[e]=o.exports:p===a&&m||(g[e]=p))}else e&&(g[e]=r)},e=t=f=function(e,t,r,n,s){if("string"==typeof e)return C[e]?C[e](t):u(y(e,t).f);if(!e.splice){if(m=e,m.deps&&f(m.deps,m.callback),!t)return;t.splice?(e=t,t=r,r=null):e=a}return t=t||function(){},"function"==typeof r&&(r=n,n=s),n?d(a,e,t,r):setTimeout(function(){d(a,e,t,r)},4),f},f.config=function(e){return f(e)},e._defined=g,r=function(e,t,r){t.splice||(r=t,t=[]),n(g,e)||n(h,e)||(h[e]=[e,t,r])},r.amd={jQuery:!0}}(),r("node_modules/almond/almond",function(){}),function(){function e(e){e.pki=e.pki||{};var t=e.pki.oids=e.oids=e.oids||{};t["1.2.840.113549.1.1.1"]="rsaEncryption",t.rsaEncryption="1.2.840.113549.1.1.1",t["1.2.840.113549.1.1.4"]="md5WithRSAEncryption",t.md5WithRSAEncryption="1.2.840.113549.1.1.4",t["1.2.840.113549.1.1.5"]="sha1WithRSAEncryption",t.sha1WithRSAEncryption="1.2.840.113549.1.1.5",t["1.2.840.113549.1.1.7"]="RSAES-OAEP",t["RSAES-OAEP"]="1.2.840.113549.1.1.7",t["1.2.840.113549.1.1.8"]="mgf1",t.mgf1="1.2.840.113549.1.1.8",t["1.2.840.113549.1.1.9"]="pSpecified",t.pSpecified="1.2.840.113549.1.1.9",t["1.2.840.113549.1.1.10"]="RSASSA-PSS",t["RSASSA-PSS"]="1.2.840.113549.1.1.10",t["1.2.840.113549.1.1.11"]="sha256WithRSAEncryption",t.sha256WithRSAEncryption="1.2.840.113549.1.1.11",t["1.2.840.113549.1.1.12"]="sha384WithRSAEncryption",t.sha384WithRSAEncryption="1.2.840.113549.1.1.12",t["1.2.840.113549.1.1.13"]="sha512WithRSAEncryption",t.sha512WithRSAEncryption="1.2.840.113549.1.1.13",t["1.3.14.3.2.7"]="desCBC",t.desCBC="1.3.14.3.2.7",t["1.3.14.3.2.26"]="sha1",t.sha1="1.3.14.3.2.26",t["2.16.840.1.101.3.4.2.1"]="sha256",t.sha256="2.16.840.1.101.3.4.2.1",t["2.16.840.1.101.3.4.2.2"]="sha384",t.sha384="2.16.840.1.101.3.4.2.2",t["2.16.840.1.101.3.4.2.3"]="sha512",t.sha512="2.16.840.1.101.3.4.2.3",t["1.2.840.113549.2.5"]="md5",t.md5="1.2.840.113549.2.5",t["1.2.840.113549.1.7.1"]="data",t.data="1.2.840.113549.1.7.1",t["1.2.840.113549.1.7.2"]="signedData",t.signedData="1.2.840.113549.1.7.2",t["1.2.840.113549.1.7.3"]="envelopedData",t.envelopedData="1.2.840.113549.1.7.3",t["1.2.840.113549.1.7.4"]="signedAndEnvelopedData",t.signedAndEnvelopedData="1.2.840.113549.1.7.4",t["1.2.840.113549.1.7.5"]="digestedData",t.digestedData="1.2.840.113549.1.7.5",t["1.2.840.113549.1.7.6"]="encryptedData",t.encryptedData="1.2.840.113549.1.7.6",t["1.2.840.113549.1.9.1"]="emailAddress",t.emailAddress="1.2.840.113549.1.9.1",t["1.2.840.113549.1.9.2"]="unstructuredName",t.unstructuredName="1.2.840.113549.1.9.2",t["1.2.840.113549.1.9.3"]="contentType",t.contentType="1.2.840.113549.1.9.3",t["1.2.840.113549.1.9.4"]="messageDigest",t.messageDigest="1.2.840.113549.1.9.4",t["1.2.840.113549.1.9.5"]="signingTime",t.signingTime="1.2.840.113549.1.9.5",t["1.2.840.113549.1.9.6"]="counterSignature",t.counterSignature="1.2.840.113549.1.9.6",t["1.2.840.113549.1.9.7"]="challengePassword",t.challengePassword="1.2.840.113549.1.9.7",t["1.2.840.113549.1.9.8"]="unstructuredAddress",t.unstructuredAddress="1.2.840.113549.1.9.8",t["1.2.840.113549.1.9.20"]="friendlyName",t.friendlyName="1.2.840.113549.1.9.20",t["1.2.840.113549.1.9.21"]="localKeyId",t.localKeyId="1.2.840.113549.1.9.21",t["1.2.840.113549.1.9.22.1"]="x509Certificate",t.x509Certificate="1.2.840.113549.1.9.22.1",t["1.2.840.113549.1.12.10.1.1"]="keyBag",t.keyBag="1.2.840.113549.1.12.10.1.1",t["1.2.840.113549.1.12.10.1.2"]="pkcs8ShroudedKeyBag",t.pkcs8ShroudedKeyBag="1.2.840.113549.1.12.10.1.2",t["1.2.840.113549.1.12.10.1.3"]="certBag",t.certBag="1.2.840.113549.1.12.10.1.3",t["1.2.840.113549.1.12.10.1.4"]="crlBag",t.crlBag="1.2.840.113549.1.12.10.1.4",t["1.2.840.113549.1.12.10.1.5"]="secretBag",t.secretBag="1.2.840.113549.1.12.10.1.5",t["1.2.840.113549.1.12.10.1.6"]="safeContentsBag",t.safeContentsBag="1.2.840.113549.1.12.10.1.6",t["1.2.840.113549.1.5.13"]="pkcs5PBES2",t.pkcs5PBES2="1.2.840.113549.1.5.13",t["1.2.840.113549.1.5.12"]="pkcs5PBKDF2",t.pkcs5PBKDF2="1.2.840.113549.1.5.12",t["1.2.840.113549.1.12.1.1"]="pbeWithSHAAnd128BitRC4",t.pbeWithSHAAnd128BitRC4="1.2.840.113549.1.12.1.1",t["1.2.840.113549.1.12.1.2"]="pbeWithSHAAnd40BitRC4",t.pbeWithSHAAnd40BitRC4="1.2.840.113549.1.12.1.2",t["1.2.840.113549.1.12.1.3"]="pbeWithSHAAnd3-KeyTripleDES-CBC",t["pbeWithSHAAnd3-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.3",t["1.2.840.113549.1.12.1.4"]="pbeWithSHAAnd2-KeyTripleDES-CBC",t["pbeWithSHAAnd2-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.4",t["1.2.840.113549.1.12.1.5"]="pbeWithSHAAnd128BitRC2-CBC",t["pbeWithSHAAnd128BitRC2-CBC"]="1.2.840.113549.1.12.1.5",t["1.2.840.113549.1.12.1.6"]="pbewithSHAAnd40BitRC2-CBC",t["pbewithSHAAnd40BitRC2-CBC"]="1.2.840.113549.1.12.1.6",t["1.2.840.113549.3.7"]="des-EDE3-CBC",t["des-EDE3-CBC"]="1.2.840.113549.3.7",t["2.16.840.1.101.3.4.1.2"]="aes128-CBC",t["aes128-CBC"]="2.16.840.1.101.3.4.1.2",t["2.16.840.1.101.3.4.1.22"]="aes192-CBC",t["aes192-CBC"]="2.16.840.1.101.3.4.1.22",t["2.16.840.1.101.3.4.1.42"]="aes256-CBC",t["aes256-CBC"]="2.16.840.1.101.3.4.1.42",t["2.5.4.3"]="commonName",t.commonName="2.5.4.3",t["2.5.4.5"]="serialName",t.serialName="2.5.4.5",t["2.5.4.6"]="countryName",t.countryName="2.5.4.6",t["2.5.4.7"]="localityName",t.localityName="2.5.4.7",t["2.5.4.8"]="stateOrProvinceName",t.stateOrProvinceName="2.5.4.8",t["2.5.4.10"]="organizationName",t.organizationName="2.5.4.10",t["2.5.4.11"]="organizationalUnitName",t.organizationalUnitName="2.5.4.11",t["2.16.840.1.113730.1.1"]="nsCertType",t.nsCertType="2.16.840.1.113730.1.1",t["2.5.29.1"]="authorityKeyIdentifier",t["2.5.29.2"]="keyAttributes",t["2.5.29.3"]="certificatePolicies",t["2.5.29.4"]="keyUsageRestriction",t["2.5.29.5"]="policyMapping",t["2.5.29.6"]="subtreesConstraint",t["2.5.29.7"]="subjectAltName",t["2.5.29.8"]="issuerAltName",t["2.5.29.9"]="subjectDirectoryAttributes",t["2.5.29.10"]="basicConstraints",t["2.5.29.11"]="nameConstraints",t["2.5.29.12"]="policyConstraints",t["2.5.29.13"]="basicConstraints",t["2.5.29.14"]="subjectKeyIdentifier",t.subjectKeyIdentifier="2.5.29.14",t["2.5.29.15"]="keyUsage",t.keyUsage="2.5.29.15",t["2.5.29.16"]="privateKeyUsagePeriod",t["2.5.29.17"]="subjectAltName",t.subjectAltName="2.5.29.17",t["2.5.29.18"]="issuerAltName",t.issuerAltName="2.5.29.18",t["2.5.29.19"]="basicConstraints",t.basicConstraints="2.5.29.19",t["2.5.29.20"]="cRLNumber",t["2.5.29.21"]="cRLReason",t["2.5.29.22"]="expirationDate",t["2.5.29.23"]="instructionCode",t["2.5.29.24"]="invalidityDate",t["2.5.29.25"]="cRLDistributionPoints",t["2.5.29.26"]="issuingDistributionPoint",t["2.5.29.27"]="deltaCRLIndicator",t["2.5.29.28"]="issuingDistributionPoint",t["2.5.29.29"]="certificateIssuer",t["2.5.29.30"]="nameConstraints",t["2.5.29.31"]="cRLDistributionPoints",t["2.5.29.32"]="certificatePolicies",t["2.5.29.33"]="policyMappings",t["2.5.29.34"]="policyConstraints",t["2.5.29.35"]="authorityKeyIdentifier",t["2.5.29.36"]="policyConstraints",t["2.5.29.37"]="extKeyUsage",t.extKeyUsage="2.5.29.37",t["2.5.29.46"]="freshestCRL",t["2.5.29.54"]="inhibitAnyPolicy",t["1.3.6.1.5.5.7.3.1"]="serverAuth",t.serverAuth="1.3.6.1.5.5.7.3.1",t["1.3.6.1.5.5.7.3.2"]="clientAuth",t.clientAuth="1.3.6.1.5.5.7.3.2",t["1.3.6.1.5.5.7.3.3"]="codeSigning",t.codeSigning="1.3.6.1.5.5.7.3.3",t["1.3.6.1.5.5.7.3.4"]="emailProtection",t.emailProtection="1.3.6.1.5.5.7.3.4",t["1.3.6.1.5.5.7.3.8"]="timeStamping",t.timeStamping="1.3.6.1.5.5.7.3.8"}var a="oids";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);var n=!0;r=function(e,r){r(t,module)}}var s,i=function(t,r){r.exports=function(r){var n=s.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<n.length;++i)n[i](r);return r[a]}},o=r;(r=function(e,t){return s="string"==typeof e?t.slice(2):e.slice(2),n?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/jsrose_forge_oids",["require","module"],function(){i.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e._asn1=e._asn1||{};t.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},t.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},t.create=function(t,r,a,n){if(e.util.isArray(n)){for(var s=[],i=0;i<n.length;++i)void 0!==n[i]&&s.push(n[i]);n=s}return{tagClass:t,type:r,constructed:a,composed:a||e.util.isArray(n),value:n}};var r=function(e){var t=e.getByte();if(128!==t){var r,a=128&t;return r=a?e.getInt((127&t)<<3):t}};t.fromDer=function(a,n){if(void 0===n&&(n=!0),"string"==typeof a&&(a=e.util.createBuffer(a)),a.length()<2)throw{message:"Too few bytes to parse DER.",bytes:a.length()};var s=a.getByte(),i=192&s,o=31&s,c=r(a);if(a.length()<c){if(n)throw{message:"Too few bytes to read ASN.1 value.",detail:a.length()+" < "+c};c=a.length()}var u,l=32===(32&s),p=l;if(!p&&i===t.Class.UNIVERSAL&&o===t.Type.BITSTRING&&c>1){var d=a.read,f=a.getByte();if(0===f){s=a.getByte();var y=192&s;if(y===t.Class.UNIVERSAL||y===t.Class.CONTEXT_SPECIFIC)try{var C=r(a);p=C===c-(a.read-d),p&&(++d,--c)}catch(g){}}a.read=d}if(p)if(u=[],void 0===c)for(;;){if(a.bytes(2)===String.fromCharCode(0,0)){a.getBytes(2);break}u.push(t.fromDer(a,n))}else for(var h=a.length();c>0;)u.push(t.fromDer(a,n)),c-=h-a.length(),h=a.length();else{if(void 0===c){if(n)throw{message:"Non-constructed ASN.1 object of indefinite length."};c=a.length()}if(o===t.Type.BMPSTRING){u="";for(var m=0;c>m;m+=2)u+=String.fromCharCode(a.getInt16())}else u=a.getBytes(c)}return t.create(i,o,l,u)},t.toDer=function(r){var a=e.util.createBuffer(),n=r.tagClass|r.type,s=e.util.createBuffer();if(r.composed){r.constructed?n|=32:s.putByte(0);for(var i=0;i<r.value.length;++i)void 0!==r.value[i]&&s.putBuffer(t.toDer(r.value[i]))}else if(r.type===t.Type.BMPSTRING)for(var i=0;i<r.value.length;++i)s.putInt16(r.value.charCodeAt(i));else s.putBytes(r.value);if(a.putByte(n),s.length()<=127)a.putByte(127&s.length());else{var o=s.length(),c="";do c+=String.fromCharCode(255&o),o>>>=8;while(o>0);a.putByte(128|c.length);for(var i=c.length-1;i>=0;--i)a.putByte(c.charCodeAt(i))}return a.putBuffer(s),a},t.oidToDer=function(t){var r=t.split("."),a=e.util.createBuffer();a.putByte(40*parseInt(r[0],10)+parseInt(r[1],10));for(var n,s,i,o,c=2;c<r.length;++c){n=!0,s=[],i=parseInt(r[c],10);do o=127&i,i>>>=7,n||(o|=128),s.push(o),n=!1;while(i>0);for(var u=s.length-1;u>=0;--u)a.putByte(s[u])}return a},t.derToOid=function(t){var r;"string"==typeof t&&(t=e.util.createBuffer(t));var a=t.getByte();r=Math.floor(a/40)+"."+a%40;for(var n=0;t.length()>0;)a=t.getByte(),n<<=7,128&a?n+=127&a:(r+="."+(n+a),n=0);return r},t.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var a=parseInt(e.substr(2,2),10)-1,n=parseInt(e.substr(4,2),10),s=parseInt(e.substr(6,2),10),i=parseInt(e.substr(8,2),10),o=0;if(e.length>11){var c=e.charAt(10),u=10;"+"!==c&&"-"!==c&&(o=parseInt(e.substr(10,2),10),u+=2)}if(t.setUTCFullYear(r,a,n),t.setUTCHours(s,i,o,0),u&&(c=e.charAt(u),"+"===c||"-"===c)){var l=parseInt(e.substr(u+1,2),10),p=parseInt(e.substr(u+4,2),10),d=60*l+p;d*=6e4,"+"===c?t.setTime(+t-d):t.setTime(+t+d)}return t},t.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),a=parseInt(e.substr(4,2),10)-1,n=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),i=parseInt(e.substr(10,2),10),o=parseInt(e.substr(12,2),10),c=0,u=0,l=!1;"Z"===e.charAt(e.length-1)&&(l=!0);var p=e.length-5,d=e.charAt(p);if("+"===d||"-"===d){var f=parseInt(e.substr(p+1,2),10),y=parseInt(e.substr(p+4,2),10);u=60*f+y,u*=6e4,"+"===d&&(u*=-1),l=!0}return"."===e.charAt(14)&&(c=1e3*parseFloat(e.substr(14),10)),l?(t.setUTCFullYear(r,a,n),t.setUTCHours(s,i,o,c),t.setTime(+t+u)):(t.setFullYear(r,a,n),t.setHours(s,i,o,c)),t},t.dateToUtcTime=function(e){var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var a=0;a<r.length;++a)r[a].length<2&&(t+="0"),t+=r[a];return t+="Z"},t.integerToDer=function(t){var r=e.util.createBuffer();if(t>=-128&&128>t)return r.putSignedInt(t,8);if(t>=-32768&&32768>t)return r.putSignedInt(t,16);if(t>=-8388608&&8388608>t)return r.putSignedInt(t,24);if(t>=-2147483648&&2147483648>t)return r.putSignedInt(t,32);throw{message:"Integer too large; max is 32-bits.",integer:t}},t.derToInteger=function(t){"string"==typeof t&&(t=e.util.createBuffer(t));var r=8*t.length();if(r>32)throw{message:"Integer too large; max is 32-bits."};return t.getSignedInt(r)},t.validate=function(r,a,n,s){var i=!1;if(r.tagClass!==a.tagClass&&"undefined"!=typeof a.tagClass||r.type!==a.type&&"undefined"!=typeof a.type)s&&(r.tagClass!==a.tagClass&&s.push("["+a.name+'] Expected tag class "'+a.tagClass+'", got "'+r.tagClass+'"'),r.type!==a.type&&s.push("["+a.name+'] Expected type "'+a.type+'", got "'+r.type+'"'));else if(r.constructed===a.constructed||"undefined"==typeof a.constructed){if(i=!0,a.value&&e.util.isArray(a.value))for(var o=0,c=0;i&&c<a.value.length;++c)i=a.value[c].optional||!1,r.value[o]&&(i=t.validate(r.value[o],a.value[c],n,s),i?++o:a.value[c].optional&&(i=!0)),!i&&s&&s.push("["+a.name+'] Tag class "'+a.tagClass+'", type "'+a.type+'" expected value length "'+a.value.length+'", got "'+r.value.length+'"');i&&n&&(a.capture&&(n[a.capture]=r.value),a.captureAsn1&&(n[a.captureAsn1]=r))}else s&&s.push("["+a.name+'] Expected constructed "'+a.constructed+'", got "'+r.constructed+'"');return i};var a=/[^\\u0000-\\u00ff]/;t.prettyPrint=function(r,n,s){var i="";n=n||0,s=s||2,n>0&&(i+="\n");for(var o="",c=0;n*s>c;++c)o+=" ";switch(i+=o+"Tag: ",r.tagClass){case t.Class.UNIVERSAL:i+="Universal:";break;case t.Class.APPLICATION:i+="Application:";break;case t.Class.CONTEXT_SPECIFIC:i+="Context-Specific:";break;case t.Class.PRIVATE:i+="Private:"}if(r.tagClass===t.Class.UNIVERSAL)switch(i+=r.type,r.type){case t.Type.NONE:i+=" (None)";break;case t.Type.BOOLEAN:i+=" (Boolean)";break;case t.Type.BITSTRING:i+=" (Bit string)";break;case t.Type.INTEGER:i+=" (Integer)";break;case t.Type.OCTETSTRING:i+=" (Octet string)";break;case t.Type.NULL:i+=" (Null)";break;case t.Type.OID:i+=" (Object Identifier)";break;case t.Type.ODESC:i+=" (Object Descriptor)";break;case t.Type.EXTERNAL:i+=" (External or Instance of)";break;case t.Type.REAL:i+=" (Real)";break;case t.Type.ENUMERATED:i+=" (Enumerated)";break;case t.Type.EMBEDDED:i+=" (Embedded PDV)";break;case t.Type.UTF8:i+=" (UTF8)";break;case t.Type.ROID:i+=" (Relative Object Identifier)";break;case t.Type.SEQUENCE:i+=" (Sequence)";break;case t.Type.SET:i+=" (Set)";break;case t.Type.PRINTABLESTRING:i+=" (Printable String)";break;case t.Type.IA5String:i+=" (IA5String (ASCII))";break;case t.Type.UTCTIME:i+=" (UTC time)";break;case t.Type.GENERALIZEDTIME:i+=" (Generalized time)";break;case t.Type.BMPSTRING:i+=" (BMP String)"}else i+=r.type;if(i+="\n",i+=o+"Constructed: "+r.constructed+"\n",r.composed){for(var u=0,l="",c=0;c<r.value.length;++c)void 0!==r.value[c]&&(u+=1,l+=t.prettyPrint(r.value[c],n+1,s),c+1<r.value.length&&(l+=","));i+=o+"Sub values: "+u+l}else{if(i+=o+"Value: ",r.type===t.Type.OID){var p=t.derToOid(r.value);i+=p,e.pki&&e.pki.oids&&p in e.pki.oids&&(i+=" ("+e.pki.oids[p]+")")}if(r.type===t.Type.INTEGER)try{i+=t.derToInteger(r.value)}catch(d){i+="0x"+e.util.bytesToHex(r.value)}else i+=a.test(r.value)?"0x"+e.util.createBuffer(r.value,"utf8").toHex():0===r.value.length?"[null]":r.value}return i}}var a="_asn1";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);var n=!0;r=function(e,r){r(t,module)}}var s,i=function(t,r){r.exports=function(r){var n=s.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<n.length;++i)n[i](r);return r[a]}},o=r;(r=function(e,t){return s="string"==typeof e?t.slice(2):e.slice(2),n?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/jsrose_forge_asn1",["require","module","./jsrose_forge_oids"],function(){i.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(e){if("object"!=typeof e)throw"yt.asn1: invalid input";this._asn=e}t.prototype.getAsn1=function(){return this._asn},t.prototype.validate=function(t,r,a){return e._asn1.validate(this._asn,t,r,a)},t.prototype.toBytes=function(){return e._asn1.toDer(this._asn).getBytes()},t.prototype.toHex=function(){return e.util.bytesToHex(this.toBytes())},t.prototype.toBase64=function(){return e.util.encode64(this.toBytes())},t.fromRaw=function(e){return new t(e)},t.fromDer=function(t){var r=e._asn1.fromDer(t);return e.asn1.fromRaw(r)},t.fromBytes=t.fromDer,t.fromString=function(t){var r;return r=e.util.hexToBytes(t),e.asn1.fromDer(r)},e.asn1=t}var a="asn1";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);r=function(e,r){r(t,module)}}var n,s=function(t,r){r.exports=function(r){var s=n.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<s.length;++i)s[i](r);return r[a]}},i=r;(r=function(e,t){return n="string"==typeof e?t.slice(2):e.slice(2),r=i,r.apply(null,Array.prototype.slice.call(arguments,0))})("js/jsrose_asn1",["require","module","js/jsrose_forge_asn1"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){e.mgf=e.mgf||{};var t=e.mgf.mgf1=e.mgf1=e.mgf1||{};t.create=function(t){var r={generate:function(r,a){for(var n=new e.util.ByteBuffer,s=Math.ceil(a/t.digestLength),i=0;s>i;i++){var o=new e.util.ByteBuffer;o.putInt32(i),t.start(),t.update(r+o.getBytes()),n.putBuffer(t.digest())}return n.truncate(n.length()-a),n.getBytes()}};return r}}var a="mgf1";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);var n=!0;r=function(e,r){r(t,module)}}var s,i=function(t,r){r.exports=function(r){var n=s.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<n.length;++i)n[i](r);return r[a]}},o=r;(r=function(e,t){return s="string"==typeof e?t.slice(2):e.slice(2),n?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/jsrose_forge_mgf1",["require","module"],function(){i.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){e.mgf=e.mgf||{},e.mgf.mgf1=e.mgf1}var a="mgf";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);var n=!0;r=function(e,r){r(t,module)}}var s,i=function(t,r){r.exports=function(r){var n=s.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<n.length;++i)n[i](r);return r[a]}},o=r;(r=function(e,t){return s="string"==typeof e?t.slice(2):e.slice(2),n?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/jsrose_forge_mgf",["require","module","./jsrose_forge_mgf1"],function(){i.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(e){for(var t=e.name+": ",r=[],a=0;a<e.values.length;++a)r.push(e.values[a].replace(/^(\S+\r\n)/,function(e,t){return" "+t}));t+=r.join(",")+"\r\n";for(var n=0,s=-1,a=0;a<t.length;++a,++n)if(n>65&&-1!==s){var i=t[s];","===i?(++s,t=t.substr(0,s)+"\r\n "+t.substr(s)):t=t.substr(0,s)+"\r\n"+i+t.substr(s+1),n=a-s-1,s=-1,++a}else" "!==t[a]&&"	"!==t[a]&&","!==t[a]||(s=a);return t}function r(e){return e.replace(/^\s+/,"")}var a=e.pem=e.pem||{};a.encode=function(r,a){a=a||{};var n,s="-----BEGIN "+r.type+"-----\r\n";if(r.procType&&(n={name:"Proc-Type",values:[String(r.procType.version),r.procType.type]},s+=t(n)),r.contentDomain&&(n={name:"Content-Domain",values:[r.contentDomain]},s+=t(n)),r.dekInfo&&(n={name:"DEK-Info",values:[r.dekInfo.algorithm]},r.dekInfo.parameters&&n.values.push(r.dekInfo.parameters),s+=t(n)),r.headers)for(var i=0;i<r.headers.length;++i)s+=t(r.headers[i]);return r.procType&&(s+="\r\n"),s+=e.util.encode64(r.body,a.maxline||64)+"\r\n",s+="-----END "+r.type+"-----\r\n"},a.decode=function(t){for(var a,n=[],s=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,i=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,o=/\r?\n/;;){if(a=s.exec(t),!a)break;var c={type:a[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:e.util.decode64(a[3])};if(n.push(c),a[2]){for(var u=a[2].split(o),l=0;a&&l<u.length;){for(var p=u[l].replace(/\s+$/,""),d=l+1;d<u.length;++d){var f=u[d];if(!/\s/.test(f[0]))break;p+=f,l=d}if(a=p.match(i)){for(var y={name:a[1],values:[]},C=a[2].split(","),g=0;g<C.length;++g)y.values.push(r(C[g]));if(c.procType)if(c.contentDomain||"Content-Domain"!==y.name)if(c.dekInfo||"DEK-Info"!==y.name)c.headers.push(y);else{if(0===y.values.length)throw{message:'Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.'};c.dekInfo={algorithm:C[0],parameters:C[1]||null}}else c.contentDomain=C[0]||"";else{if("Proc-Type"!==y.name)throw{message:'Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".'};if(2!==y.values.length)throw{message:'Invalid PEM formatted message. The "Proc-Type" header must have two subfields.'};c.procType={version:C[0],type:C[1]}}}++l}if("ENCRYPTED"===c.procType&&!c.dekInfo)throw{message:'Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".'}}}if(0===n.length)throw{message:"Invalid PEM formatted message."};return n}}var a="pem";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);var n=!0;r=function(e,r){r(t,module)}}var s,i=function(t,r){r.exports=function(r){var n=s.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<n.length;++i)n[i](r);return r[a]}},o=r;(r=function(e,t){return s="string"==typeof e?t.slice(2):e.slice(2),n?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/jsrose_forge_pem",["require","module"],function(){i.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(e,t){"string"==typeof t&&(t={shortName:t});for(var r,a=null,n=0;null===a&&n<e.attributes.length;++n)r=e.attributes[n],t.type&&t.type===r.type?a=r:t.name&&t.name===r.name?a=r:t.shortName&&t.shortName===r.shortName&&(a=r);return a}function r(t){for(var r,a,n=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]),s=t.attributes,i=0;i<s.length;++i){r=s[i];var c=r.value,u=o.Type.PRINTABLESTRING;"valueTagClass"in r&&(u=r.valueTagClass,u===o.Type.UTF8&&(c=e.util.encodeUtf8(c))),a=o.create(o.Class.UNIVERSAL,o.Type.SET,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(r.type).getBytes()),o.create(o.Class.UNIVERSAL,u,!1,c)])]),n.value.push(a)}return n}function a(e){var t=o.create(o.Class.CONTEXT_SPECIFIC,3,!0,[]),r=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);t.value.push(r);for(var a,n,s=0;s<e.length;++s){a=e[s],n=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]),r.value.push(n),n.value.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a.id).getBytes())),a.critical&&n.value.push(o.create(o.Class.UNIVERSAL,o.Type.BOOLEAN,!1,String.fromCharCode(255)));var i=a.value;"string"!=typeof a.value&&(i=o.toDer(i).getBytes()),n.value.push(o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,i))}return t}function n(e){for(var t,r=0;r<e.length;++r){if(t=e[r],"undefined"==typeof t.name&&(t.type&&t.type in c.oids?t.name=c.oids[t.type]:t.shortName&&t.shortName in l&&(t.name=c.oids[l[t.shortName]])),"undefined"==typeof t.type){if(!(t.name&&t.name in c.oids))throw{message:"Attribute type not specified.",attribute:t};t.type=c.oids[t.name]}if("undefined"==typeof t.shortName&&t.name&&t.name in l&&(t.shortName=l[t.name]),"undefined"==typeof t.value)throw{message:"Attribute value not specified.",attribute:t}}}function s(e,t){switch(e){case u["RSASSA-PSS"]:var r=[];return void 0!==t.hash.algorithmOid&&r.push(o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(t.hash.algorithmOid).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")])])),void 0!==t.mgf.algorithmOid&&r.push(o.create(o.Class.CONTEXT_SPECIFIC,1,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(t.mgf.algorithmOid).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(t.mgf.hash.algorithmOid).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")])])])),void 0!==t.saltLength&&r.push(o.create(o.Class.CONTEXT_SPECIFIC,2,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(t.saltLength).getBytes())])),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,r);default:return o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")}}function i(t){var r=o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===t.attributes.length)return r;for(var a=t.attributes,n=0;n<a.length;++n){var s=a[n],i=s.value,c=o.Type.UTF8;"valueTagClass"in s&&(c=s.valueTagClass),c===o.Type.UTF8&&(i=e.util.encodeUtf8(i));var u=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(s.type).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SET,!0,[o.create(o.Class.UNIVERSAL,c,!1,i)])]);r.value.push(u)}return r}var o=e._asn1,c=e.pki=e.pki||{},u=c.oids,l={};l.CN=u.commonName,l.commonName="CN",l.C=u.countryName,l.countryName="C",l.L=u.localityName,l.localityName="L",l.ST=u.stateOrProvinceName,l.stateOrProvinceName="ST",l.O=u.organizationName,l.organizationName="O",l.OU=u.organizationalUnitName,l.organizationalUnitName="OU",l.E=u.emailAddress,l.emailAddress="E";var p=ytcrypto.pki.rsa.publicKeyValidator,d={name:"Certificate",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:o.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:o.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:o.Class.UNIVERSAL,type:o.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:o.Class.UNIVERSAL,type:o.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:o.Class.UNIVERSAL,type:o.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:o.Class.UNIVERSAL,type:o.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},p,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:o.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,capture:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:o.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,capture:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:o.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:o.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,capture:"certSignature"}]},f={name:"rsapss",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:o.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,
value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:o.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:o.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:o.Class.UNIVERSAL,type:o.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:o.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:o.Class.UNIVERSAL,type:o.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},y={name:"CertificationRequestInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},p,{name:"CertificationRequestInfo.attributes",tagClass:o.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:o.Class.UNIVERSAL,type:o.Type.SET,constructed:!0}]}]}]},C={name:"CertificationRequest",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[y,{name:"CertificationRequest.signatureAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:o.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,capture:"csrSignature"}]};c.RDNAttributesAsArray=function(t,r){for(var a,n,s,i=[],c=0;c<t.value.length;++c){a=t.value[c];for(var p=0;p<a.value.length;++p)s={},n=a.value[p],s.type=o.derToOid(n.value[0].value),s.value=n.value[1].value,s.valueTagClass=n.value[1].type,s.type in u&&(s.name=u[s.type],s.name in l&&(s.shortName=l[s.name])),r&&(r.update(s.type),r.update(s.value)),12==s.valueTagClass&&(s.value=e.util.decodeUTF8(s.value)),s.rdnIndex=c,i.push(s)}return i},c.CRIAttributesAsArray=function(e){for(var t=[],r=0;r<e.length;++r)for(var a=e[r],n=o.derToOid(a.value[0].value),s=a.value[1].value,i=0;i<s.length;++i){var c={};c.type=n,c.value=s[i].value,c.valueTagClass=s[i].type,c.type in u&&(c.name=u[c.type],c.name in l&&(c.shortName=l[c.name])),t.push(c)}return t};var g=function(t){for(var r,a,n,s=[],i=0;i<t.value.length;++i){n=t.value[i];for(var c=0;c<n.value.length;++c){if(a=n.value[c],r={},r.id=o.derToOid(a.value[0].value),r.critical=!1,a.value[1].type===o.Type.BOOLEAN?(r.critical=0!==a.value[1].value.charCodeAt(0),r.value=a.value[2].value):r.value=a.value[1].value,r.id in u)if(r.name=u[r.id],"keyUsage"===r.name){var l=o.fromDer(r.value),p=0,d=0;l.value.length>1&&(p=l.value.charCodeAt(1),d=l.value.length>2?l.value.charCodeAt(2):0),r.digitalSignature=128===(128&p),r.nonRepudiation=64===(64&p),r.keyEncipherment=32===(32&p),r.dataEncipherment=16===(16&p),r.keyAgreement=8===(8&p),r.keyCertSign=4===(4&p),r.cRLSign=2===(2&p),r.encipherOnly=1===(1&p),r.decipherOnly=128===(128&d)}else if("basicConstraints"===r.name){var l=o.fromDer(r.value);l.value.length>0&&l.value[0].type===o.Type.BOOLEAN?r.cA=0!==l.value[0].value.charCodeAt(0):r.cA=!1;var f=null;l.value.length>0&&l.value[0].type===o.Type.INTEGER?f=l.value[0].value:l.value.length>1&&(f=l.value[1].value),null!==f&&(r.pathLenConstraint=o.derToInteger(f))}else if("extKeyUsage"===r.name)for(var l=o.fromDer(r.value),y=0;y<l.value.length;++y){var C=o.derToOid(l.value[y].value);C in u?r[u[C]]=!0:r[C]=!0}else if("nsCertType"===r.name){var l=o.fromDer(r.value),p=0;l.value.length>1&&(p=l.value.charCodeAt(1)),r.client=128===(128&p),r.server=64===(64&p),r.email=32===(32&p),r.objsign=16===(16&p),r.reserved=8===(8&p),r.sslCA=4===(4&p),r.emailCA=2===(2&p),r.objCA=1===(1&p)}else if("subjectAltName"===r.name||"issuerAltName"===r.name){r.altNames=[];for(var g,l=o.fromDer(r.value),h=0;h<l.value.length;++h){g=l.value[h];var m={type:g.type,value:g.value};switch(r.altNames.push(m),g.type){case 1:case 2:case 6:break;case 7:m.ip=e.util.bytesToIP(g.value);break;case 8:m.oid=o.derToOid(g.value)}}}else if("subjectKeyIdentifier"===r.name){var l=o.fromDer(r.value);r.subjectKeyIdentifier=e.util.bytesToHex(l.value)}s.push(r)}}return s},h=function(e,t,r){var a={};if(e!==u["RSASSA-PSS"])return a;r&&(a={hash:{algorithmOid:u.sha1},mgf:{algorithmOid:u.mgf1,hash:{algorithmOid:u.sha1}},saltLength:20});var n={},s=[];if(!o.validate(t,f,n,s))throw{message:"Cannot read RSASSA-PSS parameter block.",errors:s};return void 0!==n.hashOid&&(a.hash=a.hash||{},a.hash.algorithmOid=o.derToOid(n.hashOid)),void 0!==n.maskGenOid&&(a.mgf=a.mgf||{},a.mgf.algorithmOid=o.derToOid(n.maskGenOid),a.mgf.hash=a.mgf.hash||{},a.mgf.hash.algorithmOid=o.derToOid(n.maskGenHashOid)),void 0!==n.saltLength&&(a.saltLength=n.saltLength.charCodeAt(0)),a};c.certificateFromPem=function(t,r,a){var n=e.pem.decode(t)[0];if("CERTIFICATE"!==n.type&&"X509 CERTIFICATE"!==n.type&&"TRUSTED CERTIFICATE"!==n.type)throw{message:'Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".',headerType:n.type};if(n.procType&&"ENCRYPTED"===n.procType.type)throw{message:"Could not convert certificate from PEM; PEM is encrypted."};var s=o.fromDer(n.body,a);return c.certificateFromAsn1(s,r)},c.certificateToPem=function(t,r){var a={type:"CERTIFICATE",body:o.toDer(c.certificateToAsn1(t)).getBytes()};return e.pem.encode(a,{maxline:r})},c.publicKeyFromPem=function(t){var r=e.pem.decode(t)[0];if("PUBLIC KEY"!==r.type&&"RSA PUBLIC KEY"!==r.type)throw{message:'Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".',headerType:r.type};if(r.procType&&"ENCRYPTED"===r.procType.type)throw{message:"Could not convert public key from PEM; PEM is encrypted."};var a=o.fromDer(r.body);return ytcrypto.pki.publicKeyFromAsn1(a)},c.publicKeyToPem=function(t,r){var a={type:"PUBLIC KEY",body:o.toDer(c.publicKeyToAsn1(t)).getBytes()};return e.pem.encode(a,{maxline:r})},c.publicKeyToRSAPublicKeyPem=function(t,r){var a={type:"RSA PUBLIC KEY",body:o.toDer(c.publicKeyToRSAPublicKey(t)).getBytes()};return e.pem.encode(a,{maxline:r})},c.certificationRequestFromPem=function(t,r,a){var n=e.pem.decode(t)[0];if("CERTIFICATE REQUEST"!==n.type)throw{message:'Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".',headerType:n.type};if(n.procType&&"ENCRYPTED"===n.procType.type)throw{message:"Could not convert certification request from PEM; PEM is encrypted."};var s=o.fromDer(n.body,a);return c.certificationRequestFromAsn1(s,r)},c.certificationRequestToPem=function(t,r){var a={type:"CERTIFICATE REQUEST",body:o.toDer(c.certificationRequestToAsn1(t)).getBytes()};return e.pem.encode(a,{maxline:r})},c.createCertificate=function(){var r={};return r.version=2,r.serialNumber="00",r.signatureOid=null,r.signature=null,r.siginfo={},r.siginfo.algorithmOid=null,r.validity={},r.validity.notBefore=new Date,r.validity.notAfter=new Date,r.issuer={},r.issuer.getField=function(e){return t(r.issuer,e)},r.issuer.addField=function(e){n([e]),r.issuer.attributes.push(e)},r.issuer.attributes=[],r.issuer.hash=null,r.subject={},r.subject.getField=function(e){return t(r.subject,e)},r.subject.addField=function(e){n([e]),r.subject.attributes.push(e)},r.subject.attributes=[],r.subject.hash=null,r.extensions=[],r.publicKey=null,r.md=null,r.setSubject=function(e,t){n(e),r.subject.attributes=e,delete r.subject.uniqueId,t&&(r.subject.uniqueId=t),r.subject.hash=null},r.setIssuer=function(e,t){n(e),r.issuer.attributes=e,delete r.issuer.uniqueId,t&&(r.issuer.uniqueId=t),r.issuer.hash=null},r.setExtensions=function(t){for(var a,n=0;n<t.length;++n){if(a=t[n],"undefined"==typeof a.name&&a.id&&a.id in c.oids&&(a.name=c.oids[a.id]),"undefined"==typeof a.id){if(!(a.name&&a.name in c.oids))throw{message:"Extension ID not specified.",extension:a};a.id=c.oids[a.name]}if("undefined"==typeof a.value){if("keyUsage"===a.name){var s=0,i=0,l=0;a.digitalSignature&&(i|=128,s=7),a.nonRepudiation&&(i|=64,s=6),a.keyEncipherment&&(i|=32,s=5),a.dataEncipherment&&(i|=16,s=4),a.keyAgreement&&(i|=8,s=3),a.keyCertSign&&(i|=4,s=2),a.cRLSign&&(i|=2,s=1),a.encipherOnly&&(i|=1,s=0),a.decipherOnly&&(l|=128,s=7);var p=String.fromCharCode(s);0!==l?p+=String.fromCharCode(i)+String.fromCharCode(l):0!==i&&(p+=String.fromCharCode(i)),a.value=o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,p)}else if("basicConstraints"===a.name)a.value=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]),a.cA&&a.value.value.push(o.create(o.Class.UNIVERSAL,o.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in a&&a.value.value.push(o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(a.pathLenConstraint).getBytes()));else if("extKeyUsage"===a.name){a.value=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);var d=a.value.value;for(var f in a)a[f]===!0&&(f in u?d.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u[f]).getBytes())):-1!==f.indexOf(".")&&d.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(f).getBytes())))}else if("nsCertType"===a.name){var s=0,i=0;a.client&&(i|=128,s=7),a.server&&(i|=64,s=6),a.email&&(i|=32,s=5),a.objsign&&(i|=16,s=4),a.reserved&&(i|=8,s=3),a.sslCA&&(i|=4,s=2),a.emailCA&&(i|=2,s=1),a.objCA&&(i|=1,s=0);var p=String.fromCharCode(s);0!==i&&(p+=String.fromCharCode(i)),a.value=o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,p)}else if("subjectAltName"===a.name||"issuerAltName"===a.name){a.value=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);for(var y,C=0;C<a.altNames.length;++C){y=a.altNames[C];var p=y.value;if(7===y.type&&y.ip){if(p=e.util.bytesFromIP(y.ip),null===p)throw{message:'Extension "ip" value is not a valid IPv4 or IPv6 address.',extension:a}}else 8===y.type&&(p=y.oid?o.oidToDer(o.oidToDer(y.oid)):o.oidToDer(p));a.value.value.push(o.create(o.Class.CONTEXT_SPECIFIC,y.type,!1,p))}}else if("subjectKeyIdentifier"===a.name){var g=r.generateSubjectKeyIdentifier();a.subjectKeyIdentifier=g.toHex(),a.value=o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,g.getBytes())}if("undefined"==typeof a.value)throw{message:"Extension value not specified.",extension:a}}}r.extensions=t},r.getExtension=function(e){"string"==typeof e&&(e={name:e});for(var t,a=null,n=0;null===a&&n<r.extensions.length;++n)t=r.extensions[n],e.id&&t.id===e.id?a=t:e.name&&t.name===e.name&&(a=t);return a},r.sign=function(e,t){r.md=t||ytcrypto.md.sha1.create();var a=u[r.md.algorithm+"WithRSAEncryption"];if(!a)throw{message:"Could not compute certificate digest. Unknown message digest algorithm OID.",algorithm:r.md.algorithm};r.signatureOid=r.siginfo.algorithmOid=a,r.tbsCertificate=c.getTBSCertificate(r);var n=o.toDer(r.tbsCertificate);r.md.update(n.getBytes()),r.signature=e.sign(r.md)},r.verify=function(t){var a=!1;if(!r.issued(t)){var n=t.issuer,s=r.subject;throw{message:"The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.",expectedIssuer:n.attributes,actualIssuer:s.attributes}}var i=t.md;if(null===i){if(t.signatureOid in u){var l=u[t.signatureOid];switch(l){case"sha1WithRSAEncryption":i=ytcrypto.md.sha1.create();break;case"md5WithRSAEncryption":i=ytcrypto.md.md5.create();break;case"sha256WithRSAEncryption":i=ytcrypto.md.sha256.create();break;case"RSASSA-PSS":i=ytcrypto.md.sha256.create()}}if(null===i)throw{message:"Could not compute certificate digest. Unknown signature OID.",signatureOid:t.signatureOid};var p=t.tbsCertificate||c.getTBSCertificate(t),d=o.toDer(p);i.update(d.getBytes())}if(null!==i){var f=void 0;switch(t.signatureOid){case u.sha1WithRSAEncryption:f=void 0;break;case u["RSASSA-PSS"]:var y,C;if(y=u[t.signatureParameters.mgf.hash.algorithmOid],void 0===y||void 0===ytcrypto.md[y])throw{message:"Unsupported MGF hash function.",oid:t.signatureParameters.mgf.hash.algorithmOid,name:y};if(C=u[t.signatureParameters.mgf.algorithmOid],void 0===C||void 0===e.mgf[C])throw{message:"Unsupported MGF function.",oid:t.signatureParameters.mgf.algorithmOid,name:C};if(C=e.mgf[C].create(ytcrypto.md[y].create()),y=u[t.signatureParameters.hash.algorithmOid],void 0===y||void 0===ytcrypto.md[y])throw{message:"Unsupported RSASSA-PSS hash function.",oid:t.signatureParameters.hash.algorithmOid,name:y};f=ytcrypto.pss.create(ytcrypto.md[y].create(),C,t.signatureParameters.saltLength)}a=r.publicKey.verify(i.digest().getBytes(),t.signature,f)}return a},r.isIssuer=function(e){var t=!1,a=r.issuer,n=e.subject;if(a.hash&&n.hash)t=a.hash===n.hash;else if(a.attributes.length===n.attributes.length){t=!0;for(var s,i,o=0;t&&o<a.attributes.length;++o)s=a.attributes[o],i=n.attributes[o],s.type===i.type&&s.value===i.value||(t=!1)}return t},r.issued=function(e){return e.isIssuer(r)},r.generateSubjectKeyIdentifier=function(){var e=o.toDer(c.publicKeyToRSAPublicKey(r.publicKey)),t=ytcrypto.md.sha1.create();return t.update(e.getBytes()),t.digest()},r.verifySubjectKeyIdentifier=function(){for(var t=u.subjectKeyIdentifier,a=0;a<r.extensions.length;++a){var n=r.extensions[a];if(n.id===t){var s=r.generateSubjectKeyIdentifier().getBytes();return e.util.hexToBytes(n.subjectKeyIdentifier)===s}}return!1},r},c.certificateFromAsn1=function(r,a){var s={},i=[];if(!o.validate(r,d,s,i))throw{message:"Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.",errors:i};if("string"!=typeof s.certSignature){for(var l="\x00",p=0;p<s.certSignature.length;++p)l+=o.toDer(s.certSignature[p]).getBytes();s.certSignature=l}var f=c.createCertificate();f.version=s.certVersion?s.certVersion.charCodeAt(0):0;var y=e.util.createBuffer(s.certSerialNumber);f.serialNumber=y.toHex(),f.signatureOid=e._asn1.derToOid(s.certSignatureOid),f.signatureParameters=h(f.signatureOid,s.certSignatureParams,!0),f.siginfo.algorithmOid=e._asn1.derToOid(s.certinfoSignatureOid),f.siginfo.parameters=h(f.siginfo.algorithmOid,s.certinfoSignatureParams,!1);var C=e.util.createBuffer(s.certSignature);++C.read,f.signature=C.getBytes();var m=[];if(void 0!==s.certValidity1UTCTime&&m.push(o.utcTimeToDate(s.certValidity1UTCTime)),void 0!==s.certValidity2GeneralizedTime&&m.push(o.generalizedTimeToDate(s.certValidity2GeneralizedTime)),void 0!==s.certValidity3UTCTime&&m.push(o.utcTimeToDate(s.certValidity3UTCTime)),void 0!==s.certValidity4GeneralizedTime&&m.push(o.generalizedTimeToDate(s.certValidity4GeneralizedTime)),m.length>2)throw{message:"Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate."};if(m.length<2)throw{message:"Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime."};if(f.validity.notBefore=m[0],f.validity.notAfter=m[1],f.tbsCertificate=s.tbsCertificate,a){if(f.md=null,f.signatureOid in u){var E=u[f.signatureOid];switch(E){case"sha1WithRSAEncryption":f.md=ytcrypto.md.sha1.create();break;case"md5WithRSAEncryption":f.md=ytcrypto.md.md5.create();break;case"sha256WithRSAEncryption":f.md=ytcrypto.md.sha256.create();break;case"RSASSA-PSS":f.md=ytcrypto.md.sha256.create()}}if(null===f.md)throw{message:"Could not compute certificate digest. Unknown signature OID.",signatureOid:f.signatureOid};var v=o.toDer(f.tbsCertificate);f.md.update(v.getBytes())}var I=ytcrypto.md.sha1.create();f.issuer.getField=function(e){return t(f.issuer,e)},f.issuer.addField=function(e){n([e]),f.issuer.attributes.push(e)},f.issuer.attributes=c.RDNAttributesAsArray(s.certIssuer,I),s.certIssuerUniqueId&&(f.issuer.uniqueId=s.certIssuerUniqueId),f.issuer.hash=I.digest().toHex();var T=ytcrypto.md.sha1.create();return f.subject.getField=function(e){return t(f.subject,e)},f.subject.addField=function(e){n([e]),f.subject.attributes.push(e)},f.subject.attributes=c.RDNAttributesAsArray(s.certSubject,T),s.certSubjectUniqueId&&(f.subject.uniqueId=s.certSubjectUniqueId),f.subject.hash=T.digest().toHex(),s.certExtensions?f.extensions=g(s.certExtensions):f.extensions=[],f.publicKey=ytcrypto.pki.publicKeyFromAsn1(s.subjectPublicKeyInfo),f},c.certificationRequestFromAsn1=function(r,a){var s={},i=[];if(!o.validate(r,C,s,i))throw{message:"Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.",errors:i};if("string"!=typeof s.csrSignature){for(var l="\x00",p=0;p<s.csrSignature.length;++p)l+=o.toDer(s.csrSignature[p]).getBytes();s.csrSignature=l}var d=o.derToOid(s.publicKeyOid);if(d!==c.oids.rsaEncryption)throw{message:"Cannot read public key. OID is not RSA."};var f=c.createCertificationRequest();f.version=s.csrVersion?s.csrVersion.charCodeAt(0):0,f.signatureOid=e._asn1.derToOid(s.csrSignatureOid),f.signatureParameters=h(f.signatureOid,s.csrSignatureParams,!0),f.siginfo.algorithmOid=e._asn1.derToOid(s.csrSignatureOid),f.siginfo.parameters=h(f.siginfo.algorithmOid,s.csrSignatureParams,!1);var y=e.util.createBuffer(s.csrSignature);if(++y.read,f.signature=y.getBytes(),f.certificationRequestInfo=s.certificationRequestInfo,a){if(f.md=null,f.signatureOid in u){var d=u[f.signatureOid];switch(d){case"sha1WithRSAEncryption":f.md=ytcrypto.md.sha1.create();break;case"md5WithRSAEncryption":f.md=ytcrypto.md.md5.create();break;case"sha256WithRSAEncryption":f.md=ytcrypto.md.sha256.create();break;case"RSASSA-PSS":f.md=ytcrypto.md.sha256.create()}}if(null===f.md)throw{message:"Could not compute certification request digest. Unknown signature OID.",signatureOid:f.signatureOid};var g=o.toDer(f.certificationRequestInfo);f.md.update(g.getBytes())}var m=ytcrypto.md.sha1.create();return f.subject.getField=function(e){return t(f.subject,e)},f.subject.addField=function(e){n([e]),f.subject.attributes.push(e)},f.subject.attributes=c.RDNAttributesAsArray(s.certificationRequestInfoSubject,m),f.subject.hash=m.digest().toHex(),f.publicKey=ytcrypto.pki.publicKeyFromAsn1(s.subjectPublicKeyInfo),f.getAttribute=function(e){return t(f.attributes,e)},f.addAttribute=function(e){n([e]),f.attributes.push(e)},f.attributes=c.CRIAttributesAsArray(s.certificationRequestInfoAttributes||[]),f},c.createCertificationRequest=function(){var r={};return r.version=0,r.signatureOid=null,r.signature=null,r.siginfo={},r.siginfo.algorithmOid=null,r.subject={},r.subject.getField=function(e){return t(r.subject,e)},r.subject.addField=function(e){n([e]),r.subject.attributes.push(e)},r.subject.attributes=[],r.subject.hash=null,r.publicKey=null,r.attributes=[],r.getAttribute=function(e){return t(r.attributes,e)},r.addAttribute=function(e){n([e]),r.attributes.push(e)},r.md=null,r.setSubject=function(e){n(e),r.subject.attributes=e,r.subject.hash=null},r.setAttributes=function(e){n(e),r.attributes=e},r.sign=function(e,t){r.md=t||ytcrypto.md.sha1.create();var a=u[r.md.algorithm+"WithRSAEncryption"];if(!a)throw{message:"Could not compute certification request digest. Unknown message digest algorithm OID.",algorithm:r.md.algorithm};r.signatureOid=r.siginfo.algorithmOid=a,r.certificationRequestInfo=c.getCertificationRequestInfo(r);var n=o.toDer(r.certificationRequestInfo);r.md.update(n.getBytes()),r.signature=e.sign(r.md)},r.verify=function(){var t=!1,a=r.md;if(null===a){if(r.signatureOid in u){var n=u[r.signatureOid];switch(n){case"sha1WithRSAEncryption":a=ytcrypto.md.sha1.create();break;case"md5WithRSAEncryption":a=ytcrypto.md.md5.create();break;case"sha256WithRSAEncryption":a=ytcrypto.md.sha256.create();break;case"RSASSA-PSS":a=ytcrypto.md.sha256.create()}}if(null===a)throw{message:"Could not compute certification request digest. Unknown signature OID.",signatureOid:r.signatureOid};var s=r.certificationRequestInfo||c.getCertificationRequestInfo(r),i=o.toDer(s);a.update(i.getBytes())}if(null!==a){var l;switch(r.signatureOid){case u.sha1WithRSAEncryption:break;case u["RSASSA-PSS"]:var p,d;if(p=u[r.signatureParameters.mgf.hash.algorithmOid],void 0===p||void 0===ytcrypto.md[p])throw{message:"Unsupported MGF hash function.",oid:r.signatureParameters.mgf.hash.algorithmOid,name:p};if(d=u[r.signatureParameters.mgf.algorithmOid],void 0===d||void 0===e.mgf[d])throw{message:"Unsupported MGF function.",oid:r.signatureParameters.mgf.algorithmOid,name:d};if(d=e.mgf[d].create(ytcrypto.md[p].create()),p=u[r.signatureParameters.hash.algorithmOid],void 0===p||void 0===ytcrypto.md[p])throw{message:"Unsupported RSASSA-PSS hash function.",oid:r.signatureParameters.hash.algorithmOid,name:p};l=e.pss.create(ytcrypto.md[p].create(),d,r.signatureParameters.saltLength)}t=r.publicKey.verify(a.digest().getBytes(),r.signature,l)}return t},r},c.getTBSCertificate=function(t){var n=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(t.version).getBytes())]),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,e.util.hexToBytes(t.serialNumber)),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(t.siginfo.algorithmOid).getBytes()),s(t.siginfo.algorithmOid,t.siginfo.parameters)]),r(t.issuer),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.UTCTIME,!1,o.dateToUtcTime(t.validity.notBefore)),o.create(o.Class.UNIVERSAL,o.Type.UTCTIME,!1,o.dateToUtcTime(t.validity.notAfter))]),r(t.subject),c.publicKeyToAsn1(t.publicKey)]);return t.issuer.uniqueId&&n.value.push(o.create(o.Class.CONTEXT_SPECIFIC,1,!0,[o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,String.fromCharCode(0)+t.issuer.uniqueId)])),t.subject.uniqueId&&n.value.push(o.create(o.Class.CONTEXT_SPECIFIC,2,!0,[o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,String.fromCharCode(0)+t.subject.uniqueId)])),t.extensions.length>0&&n.value.push(a(t.extensions)),n},c.getCertificationRequestInfo=function(e){var t=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(e.version).getBytes()),r(e.subject),c.publicKeyToAsn1(e.publicKey),i(e)]);return t},c.distinguishedNameToAsn1=function(e){return r(e)},c.certificateToAsn1=function(e){var t=e.tbsCertificate||c.getTBSCertificate(e);return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[t,o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(e.signatureOid).getBytes()),s(e.signatureOid,e.signatureParameters)]),o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},c.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||c.getCertificationRequestInfo(e);return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[t,o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(e.signatureOid).getBytes()),s(e.signatureOid,e.signatureParameters)]),o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},c.createCaStore=function(t){var a={certs:{}};if(a.getIssuer=function(t){var n=null;if(!t.issuer.hash){var s=ytcrypto.md.sha1.create();t.issuer.attributes=c.RDNAttributesAsArray(r(t.issuer),s),t.issuer.hash=s.digest().toHex()}if(t.issuer.hash in a.certs&&(n=a.certs[t.issuer.hash],e.util.isArray(n)))throw{message:"Resolving multiple issuer matches not implemented yet."};return n},a.addCertificate=function(t){if("string"==typeof t&&(t=e.pki.certificateFromPem(t)),!t.subject.hash){var n=ytcrypto.md.sha1.create();t.subject.attributes=c.RDNAttributesAsArray(r(t.subject),n),t.subject.hash=n.digest().toHex()}if(t.subject.hash in a.certs){var s=a.certs[t.subject.hash];e.util.isArray(s)||(s=[s]),s.push(t)}else a.certs[t.subject.hash]=t},t)for(var n=0;n<t.length;++n){var s=t[n];a.addCertificate(s)}return a},c.certificateError={bad_certificate:"yt.pki.BadCertificate",unsupported_certificate:"yt.pki.UnsupportedCertificate",certificate_revoked:"yt.pki.CertificateRevoked",certificate_expired:"yt.pki.CertificateExpired",certificate_unknown:"yt.pki.CertificateUnknown",unknown_ca:"yt.pki.UnknownCertificateAuthority"},c.verifyCertificateChain=function(t,r,a){r=r.slice(0);var n=r.slice(0),s=new Date,i=!0,o=null,u=0,l=null;do{var p=r.shift();if(s<p.validity.notBefore||s>p.validity.notAfter)o={message:"Certificate is not valid yet or has expired.",error:c.certificateError.certificate_expired,notBefore:p.validity.notBefore,notAfter:p.validity.notAfter,now:s};else{var d=!1;if(r.length>0){l=r[0];try{d=l.verify(p)}catch(f){}}else{var y=t.getIssuer(p);if(null===y)o={message:"Certificate is not trusted.",error:c.certificateError.unknown_ca};else for(e.util.isArray(y)||(y=[y]);!d&&y.length>0;){l=y.shift();try{d=l.verify(p)}catch(f){}}}null!==o||d||(o={message:"Certificate signature is invalid.",error:c.certificateError.bad_certificate})}if(null!==o||p.isIssuer(l)||(o={message:"Certificate issuer is invalid.",error:c.certificateError.bad_certificate}),null===o)for(var C={keyUsage:!0,basicConstraints:!0},g=0;null===o&&g<p.extensions.length;++g){var h=p.extensions[g];!h.critical||h.name in C||(o={message:"Certificate has an unsupported critical extension.",error:c.certificateError.unsupported_certificate})}if(!i||0===r.length&&!l){var m=p.getExtension("basicConstraints"),E=p.getExtension("keyUsage");if(null!==E&&(E.keyCertSign&&null!==m||(o={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:c.certificateError.bad_certificate})),null!==o||null===m||m.cA||(o={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:c.certificateError.bad_certificate}),null===o&&null!==E&&"pathLenConstraint"in m){for(var v=0,g=1;g<r.length-1;++g)r[g].isIssuer(r[g])&&++v;var I=m.pathLenConstraint+1;r.length-v>I&&(o={message:"Certificate basicConstraints pathLenConstraint violated.",error:c.certificateError.bad_certificate})}}var T=null===o?!0:o.error,S=a?a(T,u,n):T;if(S!==!0)throw T===!0&&(o={message:"The application rejected the certificate.",error:c.certificateError.bad_certificate}),(S||0===S)&&("object"!=typeof S||e.util.isArray(S)?"string"==typeof S&&(o.error=S):(S.message&&(o.message=S.message),S.error&&(o.error=S.error))),o;o=null,i=!1,++u}while(r.length>0);return!0}}var a="x509";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);var n=!0;r=function(e,r){r(t,module)}}var s,i=function(t,r){r.exports=function(r){var n=s.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<n.length;++i)n[i](r);return r.pki}},o=r;(r=function(e,t){return s="string"==typeof e?t.slice(2):e.slice(2),n?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/jsrose_forge_x509",["require","module","./jsrose_forge_mgf","./jsrose_forge_oids","./jsrose_forge_pem"],function(){i.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e.pkcs5=e.pkcs5||{};e.pbkdf2=t.pbkdf2=function(t,r,a,n,s){"undefined"!=typeof s&&null!==s||(s=ytcrypto.md.sha1.create());var i=s.digestLength;if(n>4294967295*i)throw{message:"Derived key is too long."};var o=Math.ceil(n/i),c=n-(o-1)*i,u=ytcrypto.hmac.create();u.start(s,t);for(var l,p,d,f="",y=1;o>=y;++y){u.start(null,null),u.update(r),u.update(e.util.int32ToBytes(y)),l=d=u.digest().getBytes();for(var C=2;a>=C;++C)u.start(null,null),u.update(d),p=u.digest().getBytes(),l=e.util.xorBytes(l,p,i),d=p;f+=o>y?l:l.substr(0,c)}return f}}var a="pbkdf2";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);var n=!0;r=function(e,r){r(t,module)}}var s,i=function(t,r){r.exports=function(r){var n=s.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<n.length;++i)n[i](r);return r[a]}},o=r;(r=function(e,t){return s="string"==typeof e?t.slice(2):e.slice(2),n?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/jsrose_forge_pbkdf2",["require","module"],function(){i.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(e,t,a){for(var n=[r(e+t)],s=16,i=1;a>s;++i,s+=16)n.push(r(n[i-1]+e+t));return n.join("").substr(0,a)}function r(e){return ytcrypto.md.md5.create().update(e).digest().getBytes()}if("undefined"==typeof a)var a=ytcrypto.jsbn.BigInteger;var n=e._asn1,s=e.pki=e.pki||{};s.pbe=e.pbe=e.pbe||{};var i=s.oids,o={name:"EncryptedPrivateKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},c={name:"PBES2Algorithms",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,onstructed:!0,capture:"kdfIterationCount"}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},u={name:"pkcs-12PbeParams",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"iterations"}]};s.encryptPrivateKeyInfo=function(t,r,a){a=a||{},a.saltSize=a.saltSize||8,a.count=a.count||2048,a.algorithm=a.algorithm||"aes128";var o,c,u,l=ytcrypto.random.getBytesSync(a.saltSize),p=a.count,d=n.integerToDer(p);if(0===a.algorithm.indexOf("aes")||"des"===a.algorithm){
var f,y,C;switch(a.algorithm){case"aes128":o=16,f=16,y=i["aes128-CBC"],C=ytcrypto.aes.createEncryptionCipher;break;case"aes192":o=24,f=16,y=i["aes192-CBC"],C=ytcrypto.aes.createEncryptionCipher;break;case"aes256":o=32,f=16,y=i["aes256-CBC"],C=ytcrypto.aes.createEncryptionCipher;break;case"des":o=8,f=8,y=i.desCBC,C=ytcrypto.des.createEncryptionCipher;break;default:throw{message:"Cannot encrypt private key. Unknown encryption algorithm.",algorithm:a.algorithm}}var g=e.pkcs5.pbkdf2(r,l,p,o),h=ytcrypto.random.getBytesSync(f),m=C(g);m.start(h),m.update(n.toDer(t)),m.finish(),u=m.output.getBytes(),c=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(i.pkcs5PBES2).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(i.pkcs5PBKDF2).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,l),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,d.getBytes())])]),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(y).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,h)])])])}else{if("3des"!==a.algorithm)throw{message:"Cannot encrypt private key. Unknown encryption algorithm.",algorithm:a.algorithm};o=24;var E=new e.util.ByteBuffer(l),g=s.pbe.generatePkcs12Key(r,E,1,p,o),h=s.pbe.generatePkcs12Key(r,E,2,p,o),m=ytcrypto.des.createEncryptionCipher(g);m.start(h),m.update(n.toDer(t)),m.finish(),u=m.output.getBytes(),c=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(i["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,l),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,d.getBytes())])])}var v=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[c,n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,u)]);return v},s.decryptPrivateKeyInfo=function(t,r){var a=null,i={},c=[];if(!n.validate(t,o,i,c))throw{message:"Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.",errors:c};var u=n.derToOid(i.encryptionOid),l=s.pbe.getCipher(u,i.encryptionParams,r),p=e.util.createBuffer(i.encryptedData);return l.update(p),l.finish()&&(a=n.fromDer(l.output)),a},s.encryptedPrivateKeyToPem=function(t,r){var a={type:"ENCRYPTED PRIVATE KEY",body:n.toDer(t).getBytes()};return e.pem.encode(a,{maxline:r})},s.encryptedPrivateKeyFromPem=function(t){var r=e.pem.decode(t)[0];if("ENCRYPTED PRIVATE KEY"!==r.type)throw{message:'Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".',headerType:r.type};if(r.procType&&"ENCRYPTED"===r.procType.type)throw{message:"Could not convert encrypted private key from PEM; PEM is encrypted."};return n.fromDer(r.body)},s.encryptRsaPrivateKey=function(r,a,i){if(i=i||{},!i.legacy){var o=s.wrapRsaPrivateKey(s.privateKeyToAsn1(r));return o=s.encryptPrivateKeyInfo(o,a,i),s.encryptedPrivateKeyToPem(o)}var c,u,l,p;switch(i.algorithm){case"aes128":c="AES-128-CBC",l=16,u=ytcrypto.random.getBytesSync(16),p=ytcrypto.aes.createEncryptionCipher;break;case"aes192":c="AES-192-CBC",l=24,u=ytcrypto.random.getBytesSync(16),p=ytcrypto.aes.createEncryptionCipher;break;case"aes256":c="AES-256-CBC",l=32,u=ytcrypto.random.getBytesSync(16),p=ytcrypto.aes.createEncryptionCipher;break;case"3des":c="DES-EDE3-CBC",l=24,u=ytcrypto.random.getBytesSync(8),p=ytcrypto.des.createEncryptionCipher;break;case"des":c="DES-CBC",l=8,u=ytcrypto.random.getBytesSync(8),p=ytcrypto.des.createEncryptionCipher;break;default:throw{message:'Could not encrypt RSA private key; unsupported encryption algorithm "'+i.algorithm+'".',algorithm:i.algorithm}}var d=t(a,u.substr(0,8),l),f=p(d);f.start(u),f.update(n.toDer(s.privateKeyToAsn1(r))),f.finish();var y={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:c,parameters:e.util.bytesToHex(u).toUpperCase()},body:f.output.getBytes()};return e.pem.encode(y)},s.decryptRsaPrivateKey=function(r,a){var i=null,o=e.pem.decode(r)[0];if("ENCRYPTED PRIVATE KEY"!==o.type&&"PRIVATE KEY"!==o.type&&"RSA PRIVATE KEY"!==o.type)throw{message:'Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".',headerType:o.type};if(o.procType&&"ENCRYPTED"===o.procType.type){var c,u;switch(o.dekInfo.algorithm){case"DES-CBC":c=8,u=ytcrypto.des.createDecryptionCipher;break;case"DES-EDE3-CBC":c=24,u=ytcrypto.des.createDecryptionCipher;break;case"AES-128-CBC":c=16,u=ytcrypto.aes.createDecryptionCipher;break;case"AES-192-CBC":c=24,u=ytcrypto.aes.createDecryptionCipher;break;case"AES-256-CBC":c=32,u=ytcrypto.aes.createDecryptionCipher;break;case"RC2-40-CBC":c=5,u=function(e){return ytcrypto.rc2.createDecryptionCipher(e,40)};break;case"RC2-64-CBC":c=8,u=function(e){return ytcrypto.rc2.createDecryptionCipher(e,64)};break;case"RC2-128-CBC":c=16,u=function(e){return ytcrypto.rc2.createDecryptionCipher(e,128)};break;default:throw{message:'Could not decrypt private key; unsupported encryption algorithm "'+o.dekInfo.algorithm+'".',algorithm:o.dekInfo.algorithm}}var l=e.util.hexToBytes(o.dekInfo.parameters),p=t(a,l.substr(0,8),c),d=u(p);if(d.start(l),d.update(e.util.createBuffer(o.body)),!d.finish())return i;i=d.output.getBytes()}else i=o.body;return i="ENCRYPTED PRIVATE KEY"===o.type?s.decryptPrivateKeyInfo(n.fromDer(i),a):n.fromDer(i),null!==i&&(i=s.privateKeyFromAsn1(i)),i},s.pbe.generatePkcs12Key=function(t,r,a,n,s,i){var o,c;"undefined"!=typeof i&&null!==i||(i=ytcrypto.md.sha1.create());var u=i.digestLength,l=i.blockLength,p=new e.util.ByteBuffer,d=new e.util.ByteBuffer;for(c=0;c<t.length;c++)d.putInt16(t.charCodeAt(c));d.putInt16(0);var f=d.length(),y=r.length(),C=new e.util.ByteBuffer;C.fillWithByte(a,l);var g=l*Math.ceil(y/l),h=new e.util.ByteBuffer;for(c=0;g>c;c++)h.putByte(r.at(c%y));var m=l*Math.ceil(f/l),E=new e.util.ByteBuffer;for(c=0;m>c;c++)E.putByte(d.at(c%f));var v=h;v.putBuffer(E);for(var I=Math.ceil(s/u),T=1;I>=T;T++){var S=new e.util.ByteBuffer;S.putBytes(C.bytes()),S.putBytes(v.bytes());for(var A=0;n>A;A++)i.start(),i.update(S.getBytes()),S=i.digest();var N=new e.util.ByteBuffer;for(c=0;l>c;c++)N.putByte(S.at(c%u));var R=Math.ceil(y/l)+Math.ceil(f/l),b=new e.util.ByteBuffer;for(o=0;R>o;o++){var U=new e.util.ByteBuffer(v.getBytes(l)),B=511;for(c=N.length()-1;c>=0;c--)B>>=8,B+=N.at(c)+U.at(c),U.setAt(c,255&B);b.putBuffer(U)}v=b,p.putBuffer(S)}return p.truncate(p.length()-s),p},s.pbe.getCipher=function(e,t,r){switch(e){case s.oids.pkcs5PBES2:return s.pbe.getCipherForPBES2(e,t,r);case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case s.oids["pbewithSHAAnd40BitRC2-CBC"]:return s.pbe.getCipherForPKCS12PBE(e,t,r);default:throw{message:"Cannot read encrypted PBE data block. Unsupported OID.",oid:e,supportedOids:["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"]}}},s.pbe.getCipherForPBES2=function(t,r,a){var i={},o=[];if(!n.validate(r,c,i,o))throw{message:"Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.",errors:o};if(t=n.derToOid(i.kdfOid),t!==s.oids.pkcs5PBKDF2)throw{message:"Cannot read encrypted private key. Unsupported key derivation function OID.",oid:t,supportedOids:["pkcs5PBKDF2"]};if(t=n.derToOid(i.encOid),t!==s.oids["aes128-CBC"]&&t!==s.oids["aes192-CBC"]&&t!==s.oids["aes256-CBC"]&&t!==s.oids["des-EDE3-CBC"]&&t!==s.oids.desCBC)throw{message:"Cannot read encrypted private key. Unsupported encryption scheme OID.",oid:t,supportedOids:["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"]};var u=i.kdfSalt,l=e.util.createBuffer(i.kdfIterationCount);l=l.getInt(l.length()<<3);var p,d;switch(s.oids[t]){case"aes128-CBC":p=16,d=ytcrypto.aes.createDecryptionCipher;break;case"aes192-CBC":p=24,d=ytcrypto.aes.createDecryptionCipher;break;case"aes256-CBC":p=32,d=ytcrypto.aes.createDecryptionCipher;break;case"des-EDE3-CBC":p=24,d=ytcrypto.des.createDecryptionCipher;break;case"desCBC":p=8,d=ytcrypto.des.createDecryptionCipher}var f=e.pkcs5.pbkdf2(a,u,l,p),y=i.encIv,C=d(f);return C.start(y),C},s.pbe.getCipherForPKCS12PBE=function(t,r,a){var i={},o=[];if(!n.validate(r,u,i,o))throw{message:"Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.",errors:o};var c=e.util.createBuffer(i.salt),l=e.util.createBuffer(i.iterations);l=l.getInt(l.length()<<3);var p,d,f;switch(t){case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:p=24,d=8,f=ytcrypto.des.startDecrypting;break;case s.oids["pbewithSHAAnd40BitRC2-CBC"]:p=5,d=8,f=function(e,t){var r=ytcrypto.rc2.createDecryptionCipher(e,40);return r.start(t,null),r};break;default:throw{message:"Cannot read PKCS #12 PBE data block. Unsupported OID.",oid:t}}var y=s.pbe.generatePkcs12Key(a,c,1,l,p),C=s.pbe.generatePkcs12Key(a,c,2,l,d);return f(y,C)}}var a="pbe";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);var n=!0;r=function(e,r){r(t,module)}}var s,i=function(t,r){r.exports=function(r){var n=s.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<n.length;++i)n[i](r);return r[a]}},o=r;(r=function(e,t){return s="string"==typeof e?t.slice(2):e.slice(2),n?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/jsrose_forge_pbe",["require","module","./jsrose_forge_oids","./jsrose_forge_pem","./jsrose_forge_pbkdf2"],function(){i.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e._asn1,r=e.pkcs7asn1=e.pkcs7asn1||{};e.pkcs7=e.pkcs7||{},e.pkcs7.asn1=r;var a={name:"ContentInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};r.contentInfoValidator=a;var n={name:"EncryptedContentInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:t.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent"}]};r.envelopedDataValidator={name:"EnvelopedData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(n)},r.encryptedDataValidator={name:"EncryptedData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"}].concat(n)};var s={name:"SignerInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1},{name:"SignerInfo.IssuerAndSerialNumber",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.DigestAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.AuthenticatedAttributes",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.DigestEncryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.EncryptedDigest",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.UnauthenticatedAttributes",tagClass:t.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0}]};r.signedDataValidator={name:"SignedData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},a,{name:"SignedData.Certificates",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:t.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,capture:"signerInfos",optional:!0,value:[s]}]},r.recipientInfoValidator={name:"RecipientInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:t.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}}var a="pkcs7asn1";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);var n=!0;r=function(e,r){r(t,module)}}var s,i=function(t,r){r.exports=function(r){var n=s.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<n.length;++i)n[i](r);return r[a]}},o=r;(r=function(e,t){return s="string"==typeof e?t.slice(2):e.slice(2),n?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/jsrose_forge_pkcs7asn1",["require","module","./jsrose_forge_asn1"],function(){i.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t,r,a,n;t=e._asn1,e.pki||(e.pki={}),r=e.pki,n=e.oids,void 0==e.kisa&&(e.kisa={}),a=e.kisa,void 0==e.yessign&&(e.yessign={}),yessign=e.yessign,t.dateToGeneralizedTime=function(e){var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var a=0;a<r.length;++a)r[a].length<2&&(t+="0"),t+=r[a];return t+="Z"},r.GeneralName={},r.GeneralName.toAsn1=function(e){var a,n=!1;if("rfc822Name"in e)contextID=1,a=e.rfc822Name;else{if(!("directoryName"in e))throw"not supported generalname";contextID=4,n=!0,a=[r.distinguishedNameToAsn1(e.directoryName)]}return t.create(t.Class.CONTEXT_SPECIFIC,contextID,n,a)},r.AlgorithmIdentifier={},r.AlgorithmIdentifier.toAsn1=function(e){var r,a;if(0==e.hasOwnProperty("algorithm"))throw"AlgorithmIdentifier.algorithm does not defined as OID";return r=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(e.algorithm).getBytes())]),"parameters"in e&&(a=e.parameters,null==a&&(a=t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")),r.value.push(a)),r},r.AlgorithmIdentifier.toObject=function(e){var r,a={};return r=t.derToOid(e.value[0].value),a.algorithm=r,a},r.Validity={},r.Validity.toAsn1=function(e){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.UTCTIME,!1,t.dateToUtcTime(e.notBefore)),t.create(t.Class.UNIVERSAL,t.Type.UTCTIME,!1,t.dateToUtcTime(e.notAfter))])},EncryptedVID={},EncryptedVID.oid="1.2.410.200004.10.1.1.2",EncryptedVID.toAsn1=function(e){var a,n;return a=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),n=t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(e.version).getBytes())]),a.value.push(n),"vidHashAlg"in e&&(n=t.create(t.Class.CONTEXT_SPECIFIC,1,!0,[r.AlgorithmIdentifier.toAsn1(e.vidEncAlg)]),a.value.push(n)),n=t.create(t.Class.CONTEXT_SPECIFIC,2,!0,[r.AlgorithmIdentifier.toAsn1(e.vidEncAlg)]),a.value.push(n),n=t.create(t.Class.CONTEXT_SPECIFIC,3,!0,[r.IssuerAndSerialNumber.toAsn1(e.certID)]),a.value.push(n),n=t.create(t.Class.CONTEXT_SPECIFIC,4,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,e.encryptedVID)]),a.value.push(n),a},r.IssuerAndSerialNumber={},r.IssuerAndSerialNumber.toAsn1=function(a){var n,s;return n=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),n.value.push(r.distinguishedNameToAsn1(a.issuer)),s=e.util.hexToBytes(a.serialNumber),n.value.push(t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,s)),n},HashContent={},HashContent.toAsn1=function(e){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.PRINTABLESTRING,!1,e.idn),t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,String.fromCharCode(0)+e.randomNum)])},EncryptContent={},EncryptContent.toAsn1=function(e){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[VID.toAsn1(e.vid),t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,String.fromCharCode(0)+e.randomNum)])},VID={},VID.toAsn1=function(e){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[r.AlgorithmIdentifier.toAsn1(e.hashAlg),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,e.virtualID)])])},a.EncryptedVID=EncryptedVID,a.EncryptContent=EncryptContent,yessign.VIDCertificate={},yessign.VIDCertificate.oid="1.2.410.200005.1.10.1";var s={};s.toAsn1=function(e){var r,a=0,n=0;return e.userAgree.realName&&(n|=128,a=7),e.userAgree.gender&&(n|=64,a=6),e.userAgree.nationalInfo&&(n|=32,a=5),e.userAgree.birthDate&&(n|=16,a=4),r=e.userAgreement,t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.UTF8,!1,r),t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,String.fromCharCode(a)+""+String.fromCharCode(n))])},a.PersonInfoReq=s,n["1.2.410.200004.1.15"]="seedCBCWithSHA1",n.seedCBCWithSHA1="1.2.410.200004.1.15",n["1.2.410.200004.1.4"]="seedCBC",n.seedCBC="1.2.410.200004.1.4",n.vid="1.2.410.200004.10.1.1.1",n["1.2.410.200004.10.1.1.1"]="vid",n.randomNum="1.2.410.200004.10.1.1.3",n["1.2.410.200004.10.1.1.3"]="randomNum",n["1.3.6.1.5.5.7.5.1.5"]="oldCertId",n.oldCertId="1.3.6.1.5.5.7.5.1.5"}var a="yt";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);r=function(e,r){r(t,module)}}var n,s=function(t,r){r.exports=function(r){var s=n.map(function(e){return t(e)}).concat(e);r=r||{},r.defined=r.defined||{};for(var i=0;i<s.length;++i)s[i](r);return r[a]}},i=r;(r=function(e,t){return n="string"==typeof e?t.slice(2):e.slice(2),r=i,r.apply(null,Array.prototype.slice.call(arguments,0))})("js/jsrose_forge_extension",["require","module","./jsrose_forge_x509","./jsrose_forge_pbe","./jsrose_forge_pkcs7asn1"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e.util=e.util||{};"undefined"!=typeof process&&process.nextTick?(t.nextTick=process.nextTick,"function"==typeof setImmediate?t.setImmediate=setImmediate:t.setImmediate=t.nextTick):"function"==typeof setImmediate?(t.setImmediate=setImmediate,t.nextTick=function(e){return setImmediate(e)}):(t.setImmediate=function(e){setTimeout(e,0)},t.nextTick=t.setImmediate),t.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},t.isArrayBuffer=function(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer};var r=[];"undefined"!=typeof Int8Array&&r.push(Int8Array),"undefined"!=typeof Uint8Array&&r.push(Uint8Array),"undefined"!=typeof Uint8ClampedArray&&r.push(Uint8ClampedArray),"undefined"!=typeof Int16Array&&r.push(Int16Array),"undefined"!=typeof Uint16Array&&r.push(Uint16Array),"undefined"!=typeof Int32Array&&r.push(Int32Array),"undefined"!=typeof Uint32Array&&r.push(Uint32Array),"undefined"!=typeof Float32Array&&r.push(Float32Array),"undefined"!=typeof Float64Array&&r.push(Float64Array),t.isArrayBufferView=function(e){for(var t=0;t<r.length;++t)if(e instanceof r[t])return!0;return!1},t.ByteBuffer=function(e){if(this.data="",this.read=0,"string"==typeof e)this.data=e;else if(t.isArrayBuffer(e)||t.isArrayBufferView(e)){var r=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,r)}catch(a){for(var n=0;n<r.length;++n)this.putByte(r[n])}}},t.ByteBuffer.prototype.length=function(){return this.data.length-this.read},t.ByteBuffer.prototype.isEmpty=function(){return this.length()<=0},t.ByteBuffer.prototype.putByte=function(e){return this.data+=String.fromCharCode(e),this},t.ByteBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)1&t&&(r+=e),t>>>=1,t>0&&(e+=e);return this.data=r,this},t.ByteBuffer.prototype.putBytes=function(e){return this.data+=e,this},t.ByteBuffer.prototype.putString=function(e){return this.data+=t.encodeUtf8(e),this},t.ByteBuffer.prototype.putInt16=function(e){return this.data+=String.fromCharCode(e>>8&255)+String.fromCharCode(255&e),this},t.ByteBuffer.prototype.putInt24=function(e){return this.data+=String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e),this},t.ByteBuffer.prototype.putInt32=function(e){return this.data+=String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e),this},t.ByteBuffer.prototype.putInt16Le=function(e){return this.data+=String.fromCharCode(255&e)+String.fromCharCode(e>>8&255),this},t.ByteBuffer.prototype.putInt24Le=function(e){return this.data+=String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255),this},t.ByteBuffer.prototype.putInt32Le=function(e){return this.data+=String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255),this},t.ByteBuffer.prototype.putInt=function(e,t){do t-=8,this.data+=String.fromCharCode(e>>t&255);while(t>0);return this},t.ByteBuffer.prototype.putSignedInt=function(e,t){return 0>e&&(e+=2<<t-1),this.putInt(e,t)},t.ByteBuffer.prototype.putBuffer=function(e){return this.data+=e.getBytes(),this},t.ByteBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},t.ByteBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},t.ByteBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},t.ByteBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},t.ByteBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},t.ByteBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},t.ByteBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},t.ByteBuffer.prototype.getInt=function(e){var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t},t.ByteBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},t.ByteBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},t.ByteBuffer.prototype.bytes=function(e){return"undefined"==typeof e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},t.ByteBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},t.ByteBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},t.ByteBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},t.ByteBuffer.prototype.copy=function(){var e=t.createBuffer(this.data);return e.read=this.read,e},t.ByteBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},t.ByteBuffer.prototype.clear=function(){return this.data="",this.read=0,this},t.ByteBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},t.ByteBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);16>r&&(e+="0"),e+=r.toString(16)}return e},t.ByteBuffer.prototype.toString=function(){return t.decodeUtf8(this.bytes())},t.createBuffer=function(e,r){return r=r||"raw",void 0!==e&&"utf8"===r&&(e=t.encodeUtf8(e)),new t.ByteBuffer(e)},t.fillString=function(e,t){for(var r="";t>0;)1&t&&(r+=e),t>>>=1,t>0&&(e+=e);return r},t.xorBytes=function(e,t,r){for(var a="",n="",s="",i=0,o=0;r>0;--r,++i)n=e.charCodeAt(i)^t.charCodeAt(i),o>=10&&(a+=s,s="",o=0),s+=String.fromCharCode(n),++o;return a+=s},t.hexToBytes=function(e){var t="",r=0;for(e.length&!0&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t},t.bytesToHex=function(e){return t.createBuffer(e).toHex()},t.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];t.encode64=function(e,t){for(var r,n,s,i="",o="",c=0;c<e.length;)r=e.charCodeAt(c++),n=e.charCodeAt(c++),s=e.charCodeAt(c++),i+=a.charAt(r>>2),i+=a.charAt((3&r)<<4|n>>4),isNaN(n)?i+="==":(i+=a.charAt((15&n)<<2|s>>6),i+=isNaN(s)?"=":a.charAt(63&s)),t&&i.length>t&&(o+=i.substr(0,t)+"\r\n",i=i.substr(t));return o+=i},t.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,r,a,s,i="",o=0;o<e.length;)t=n[e.charCodeAt(o++)-43],r=n[e.charCodeAt(o++)-43],a=n[e.charCodeAt(o++)-43],s=n[e.charCodeAt(o++)-43],i+=String.fromCharCode(t<<2|r>>4),64!==a&&(i+=String.fromCharCode((15&r)<<4|a>>2),64!==s&&(i+=String.fromCharCode((3&a)<<6|s)));return i},t.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},t.decodeUtf8=function(e){return decodeURIComponent(escape(e))},t.deflate=function(e,r,a){if(r=t.decode64(e.deflate(t.encode64(r)).rval),a){var n=2,s=r.charCodeAt(1);32&s&&(n=6),r=r.substring(n,r.length-4)}return r},t.inflate=function(e,r,a){var n=e.inflate(t.encode64(r)).rval;return null===n?null:t.decode64(n)};var s=function(e,r,a){if(!e)throw{message:"WebStorage not available."};var n;if(null===a?n=e.removeItem(r):(a=t.encode64(JSON.stringify(a)),n=e.setItem(r,a)),"undefined"!=typeof n&&n.rval!==!0)throw n.error},i=function(e,r){if(!e)throw{message:"WebStorage not available."};var a=e.getItem(r);if(e.init)if(null===a.rval){if(a.error)throw a.error;a=null}else a=a.rval;return null!==a&&(a=JSON.parse(t.decode64(a))),a},o=function(e,t,r,a){var n=i(e,t);null===n&&(n={}),n[r]=a,s(e,t,n)},c=function(e,t,r){var a=i(e,t);return null!==a&&(a=r in a?a[r]:null),a},u=function(e,t,r){var a=i(e,t);if(null!==a&&r in a){delete a[r];var n=!0;for(var o in a){n=!1;break}n&&(a=null),s(e,t,a)}},l=function(e,t){s(e,t,null)},p=function(e,t,r){var a=null;"undefined"==typeof r&&(r=["web","flash"]);var n,s=!1,i=null;for(var o in r){n=r[o];try{if("flash"===n||"both"===n){if(null===t[0])throw{message:"Flash local storage not available."};a=e.apply(this,t),s="flash"===n}"web"!==n&&"both"!==n||(t[0]=localStorage,a=e.apply(this,t),s=!0)}catch(c){i=c}if(s)break}if(!s)throw i;return a};t.setItem=function(e,t,r,a,n){p(o,arguments,n)},t.getItem=function(e,t,r,a){return p(c,arguments,a)},t.removeItem=function(e,t,r,a){p(u,arguments,a)},t.clearItems=function(e,t,r){p(l,arguments,r)},t.parseUrl=function(e){var t=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;t.lastIndex=0;var r=t.exec(e),a=null===r?null:{full:e,scheme:r[1],host:r[2],port:r[3],path:r[4]};return a&&(a.fullHost=a.host,a.port?80!==a.port&&"http"===a.scheme?a.fullHost+=":"+a.port:443!==a.port&&"https"===a.scheme&&(a.fullHost+=":"+a.port):"http"===a.scheme?a.port=80:"https"===a.scheme&&(a.port=443),a.full=a.scheme+"://"+a.fullHost),a};var d=null;t.getQueryVariables=function(e){var t,r=function(e){for(var t={},r=e.split("&"),a=0;a<r.length;a++){var n,s,i=r[a].indexOf("=");i>0?(n=r[a].substring(0,i),s=r[a].substring(i+1)):(n=r[a],s=null),n in t||(t[n]=[]),n in Object.prototype||null===s||t[n].push(unescape(s))}return t};return"undefined"==typeof e?(null===d&&(d="undefined"==typeof window?{}:r(window.location.search.substring(1))),t=d):t=r(e),t},t.parseFragment=function(e){var r=e,a="",n=e.indexOf("?");n>0&&(r=e.substring(0,n),a=e.substring(n+1));var s=r.split("/");s.length>0&&""===s[0]&&s.shift();var i=""===a?{}:t.getQueryVariables(a);return{pathString:r,queryString:a,path:s,query:i}},t.makeRequest=function(e){var r=t.parseFragment(e),a={path:r.pathString,query:r.queryString,getPath:function(e){return"undefined"==typeof e?r.path:r.path[e]},getQuery:function(e,t){var a;return"undefined"==typeof e?a=r.query:(a=r.query[e],a&&"undefined"!=typeof t&&(a=a[t])),a},getQueryLast:function(e,t){var r,n=a.getQuery(e);return r=n?n[n.length-1]:t}};return a},t.makeLink=function(e,t,r){e=jQuery.isArray(e)?e.join("/"):e;var a=jQuery.param(t||{});return r=r||"",e+(a.length>0?"?"+a:"")+(r.length>0?"#"+r:"")},t.setPath=function(e,t,r){if("object"==typeof e&&null!==e)for(var a=0,n=t.length;n>a;){var s=t[a++];if(a==n)e[s]=r;else{var i=s in e;(!i||i&&"object"!=typeof e[s]||i&&null===e[s])&&(e[s]={}),e=e[s]}}},t.getPath=function(e,t,r){for(var a=0,n=t.length,s=!0;s&&n>a&&"object"==typeof e&&null!==e;){var i=t[a++];s=i in e,s&&(e=e[i])}return s?e:r},t.deletePath=function(e,t){if("object"==typeof e&&null!==e)for(var r=0,a=t.length;a>r;){var n=t[r++];if(r==a)delete e[n];else{if(!(n in e)||"object"!=typeof e[n]||null===e[n])break;e=e[n]}}},t.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},t.format=function(e){for(var t,r,a=/%./g,n=0,s=[],i=0;t=a.exec(e);){r=e.substring(i,a.lastIndex-2),r.length>0&&s.push(r),i=a.lastIndex;var o=t[0][1];switch(o){case"s":case"o":n<arguments.length?s.push(arguments[n++ +1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+o+"?>")}}return s.push(e.substring(i)),s.join("")},t.formatNumber=function(e,t,r,a){var n=e,s=isNaN(t=Math.abs(t))?2:t,i=void 0===r?",":r,o=void 0===a?".":a,c=0>n?"-":"",u=parseInt(n=Math.abs(+n||0).toFixed(s),10)+"",l=u.length>3?u.length%3:0;return c+(l?u.substr(0,l)+o:"")+u.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+o)+(s?i+Math.abs(n-u).toFixed(s).slice(2):"")},t.formatSize=function(e){
return e=e>=1073741824?t.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?t.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?t.formatNumber(e/1024,0)+" KiB":t.formatNumber(e,0)+" bytes"},t.bytesFromIP=function(e){return-1!==e.indexOf(".")?t.bytesFromIPv4(e):-1!==e.indexOf(":")?t.bytesFromIPv6(e):null},t.bytesFromIPv4=function(e){if(e=e.split("."),4!==e.length)return null;for(var r=t.createBuffer(),a=0;a<e.length;++a){var n=parseInt(e[a],10);if(isNaN(n))return null;r.putByte(n)}return r.getBytes()},t.bytesFromIPv6=function(e){var r=0;e=e.split(":").filter(function(e){return 0===e.length&&++r,!0});for(var a=2*(8-e.length+r),n=t.createBuffer(),s=0;8>s;++s)if(e[s]&&0!==e[s].length){var i=t.hexToBytes(e[s]);i.length<2&&n.putByte(0),n.putBytes(i)}else n.fillWithByte(0,a),a=0;return n.getBytes()},t.bytesToIP=function(e){return 4===e.length?t.bytesToIPv4(e):16===e.length?t.bytesToIPv6(e):null},t.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")},t.bytesToIPv6=function(e){if(16!==e.length)return null;for(var r=[],a=[],n=0,s=0;s<e.length;s+=2){for(var i=t.bytesToHex(e[s]+e[s+1]);"0"===i[0]&&"0"!==i;)i=i.substr(1);if("0"===i){var o=a[a.length-1],c=r.length;o&&c===o.end+1?(o.end=c,o.end-o.start>a[n].end-a[n].start&&(n=a.length-1)):a.push({start:c,end:c})}r.push(i)}if(a.length>0){var u=a[n];u.end-u.start>0&&(r.splice(u.start,u.end-u.start+1,""),0===u.start&&r.unshift(""),7===u.end&&r.push(""))}return r.join(":")},t.estimateCores=function(e,r){function a(e,o,c){if(0===o){var u=Math.floor(e.reduce(function(e,t){return e+t},0)/e.length);return t.cores=Math.max(1,u),URL.revokeObjectURL(i),r(null,t.cores)}n(c,function(t,r){e.push(s(c,r)),a(e,o-1,c)})}function n(e,t){for(var r=[],a=[],n=0;e>n;++n){var s=new Worker(i);s.addEventListener("message",function(n){if(a.push(n.data),a.length===e){for(var s=0;e>s;++s)r[s].terminate();t(null,a)}}),r.push(s)}for(var n=0;e>n;++n)r[n].postMessage(n)}function s(e,t){for(var r=[],a=0;e>a;++a)for(var n=t[a],s=r[a]=[],i=0;e>i;++i)if(a!==i){var o=t[i];(n.st>o.st&&n.st<o.et||o.st>n.st&&o.st<n.et)&&s.push(i)}return r.reduce(function(e,t){return Math.max(e,t.length)},0)}if("function"==typeof e&&(r=e,e={}),e=e||{},"cores"in t&&!e.update)return r(null,t.cores);if(void 0===typeof Worker)return t.cores=1,r(null,t.cores);if(void 0===typeof Blob)return t.cores=2,r(null,t.cores);var i=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(e){for(var t=Date.now(),r=t+4;Date.now()<r;);self.postMessage({st:t,et:r})})}.toString(),")()"],{type:"application/javascript"}));a([],5,16)}}var a="util";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);var n=!0;r=function(e,r){r(t,module)}}var s,i=function(t,r){r.exports=function(r){var n=s.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<n.length;++i)n[i](r);return r[a]}},o=r;(r=function(e,t){return s="string"==typeof e?t.slice(2):e.slice(2),n?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/jsrose_forge_util",["require","module"],function(){i.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e.util||{};t.tableKSC5601=[12288,12289,12290,183,8229,8230,168,12291,173,8213,8741,65340,8764,8216,8217,8220,8221,12308,12309,12296,12297,12298,12299,12300,12301,12302,12303,12304,12305,177,215,247,8800,8804,8805,8734,8756,176,8242,8243,8451,8491,65504,65505,65509,9794,9792,8736,8869,8978,8706,8711,8801,8786,167,8251,9734,9733,9675,9679,9678,9671,9670,9633,9632,9651,9650,9661,9660,8594,8592,8593,8595,8596,12307,8810,8811,8730,8765,8733,8757,8747,8748,8712,8715,8838,8839,8834,8835,8746,8745,8743,8744,65506,8658,8660,8704,8707,180,65374,711,728,733,730,729,184,731,161,191,720,8750,8721,8719,164,8457,8240,9665,9664,9655,9654,9828,9824,9825,9829,9831,9827,8857,9672,9635,9680,9681,9618,9636,9637,9640,9639,9638,9641,9832,9743,9742,9756,9758,182,8224,8225,8597,8599,8601,8598,8600,9837,9833,9834,9836,12927,12828,8470,13255,8482,13250,13272,8481,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,65281,65282,65283,65284,65285,65286,65287,65288,65289,65290,65291,65292,65293,65294,65295,65296,65297,65298,65299,65300,65301,65302,65303,65304,65305,65306,65307,65308,65309,65310,65311,65312,65313,65314,65315,65316,65317,65318,65319,65320,65321,65322,65323,65324,65325,65326,65327,65328,65329,65330,65331,65332,65333,65334,65335,65336,65337,65338,65339,65510,65341,65342,65343,65344,65345,65346,65347,65348,65349,65350,65351,65352,65353,65354,65355,65356,65357,65358,65359,65360,65361,65362,65363,65364,65365,65366,65367,65368,65369,65370,65371,65372,65373,65507,12593,12594,12595,12596,12597,12598,12599,12600,12601,12602,12603,12604,12605,12606,12607,12608,12609,12610,12611,12612,12613,12614,12615,12616,12617,12618,12619,12620,12621,12622,12623,12624,12625,12626,12627,12628,12629,12630,12631,12632,12633,12634,12635,12636,12637,12638,12639,12640,12641,12642,12643,12644,12645,12646,12647,12648,12649,12650,12651,12652,12653,12654,12655,12656,12657,12658,12659,12660,12661,12662,12663,12664,12665,12666,12667,12668,12669,12670,12671,12672,12673,12674,12675,12676,12677,12678,12679,12680,12681,12682,12683,12684,12685,12686,8560,8561,8562,8563,8564,8565,8566,8567,8568,8569,-1,-1,-1,-1,-1,8544,8545,8546,8547,8548,8549,8550,8551,8552,8553,-1,-1,-1,-1,-1,-1,-1,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,931,932,933,934,935,936,937,-1,-1,-1,-1,-1,-1,-1,-1,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,963,964,965,966,967,968,969,-1,-1,-1,-1,-1,-1,9472,9474,9484,9488,9496,9492,9500,9516,9508,9524,9532,9473,9475,9487,9491,9499,9495,9507,9523,9515,9531,9547,9504,9519,9512,9527,9535,9501,9520,9509,9528,9538,9490,9489,9498,9497,9494,9493,9486,9485,9502,9503,9505,9506,9510,9511,9513,9514,9517,9518,9521,9522,9525,9526,9529,9530,9533,9534,9536,9537,9539,9540,9541,9542,9543,9544,9545,9546,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13205,13206,13207,8467,13208,13252,13219,13220,13221,13222,13209,13210,13211,13212,13213,13214,13215,13216,13217,13218,13258,13197,13198,13199,13263,13192,13193,13256,13223,13224,13232,13233,13234,13235,13236,13237,13238,13239,13240,13241,13184,13185,13186,13187,13188,13242,13243,13244,13245,13246,13247,13200,13201,13202,13203,13204,8486,13248,13249,13194,13195,13196,13270,13253,13229,13230,13231,13275,13225,13226,13227,13228,13277,13264,13267,13251,13257,13276,13254,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,198,208,170,294,-1,306,-1,319,321,216,338,186,222,358,330,-1,12896,12897,12898,12899,12900,12901,12902,12903,12904,12905,12906,12907,12908,12909,12910,12911,12912,12913,12914,12915,12916,12917,12918,12919,12920,12921,12922,12923,9424,9425,9426,9427,9428,9429,9430,9431,9432,9433,9434,9435,9436,9437,9438,9439,9440,9441,9442,9443,9444,9445,9446,9447,9448,9449,9312,9313,9314,9315,9316,9317,9318,9319,9320,9321,9322,9323,9324,9325,9326,189,8531,8532,188,190,8539,8540,8541,8542,230,273,240,295,305,307,312,320,322,248,339,223,254,359,331,329,12800,12801,12802,12803,12804,12805,12806,12807,12808,12809,12810,12811,12812,12813,12814,12815,12816,12817,12818,12819,12820,12821,12822,12823,12824,12825,12826,12827,9372,9373,9374,9375,9376,9377,9378,9379,9380,9381,9382,9383,9384,9385,9386,9387,9388,9389,9390,9391,9392,9393,9394,9395,9396,9397,9332,9333,9334,9335,9336,9337,9338,9339,9340,9341,9342,9343,9344,9345,9346,185,178,179,8308,8319,8321,8322,8323,8324,12353,12354,12355,12356,12357,12358,12359,12360,12361,12362,12363,12364,12365,12366,12367,12368,12369,12370,12371,12372,12373,12374,12375,12376,12377,12378,12379,12380,12381,12382,12383,12384,12385,12386,12387,12388,12389,12390,12391,12392,12393,12394,12395,12396,12397,12398,12399,12400,12401,12402,12403,12404,12405,12406,12407,12408,12409,12410,12411,12412,12413,12414,12415,12416,12417,12418,12419,12420,12421,12422,12423,12424,12425,12426,12427,12428,12429,12430,12431,12432,12433,12434,12435,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,12449,12450,12451,12452,12453,12454,12455,12456,12457,12458,12459,12460,12461,12462,12463,12464,12465,12466,12467,12468,12469,12470,12471,12472,12473,12474,12475,12476,12477,12478,12479,12480,12481,12482,12483,12484,12485,12486,12487,12488,12489,12490,12491,12492,12493,12494,12495,12496,12497,12498,12499,12500,12501,12502,12503,12504,12505,12506,12507,12508,12509,12510,12511,12512,12513,12514,12515,12516,12517,12518,12519,12520,12521,12522,12523,12524,12525,12526,12527,12528,12529,12530,12531,12532,12533,12534,-1,-1,-1,-1,-1,-1,-1,-1,1040,1041,1042,1043,1044,1045,1025,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1072,1073,1074,1075,1076,1077,1105,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,44032,44033,44036,44039,44040,44041,44042,44048,44049,44050,44051,44052,44053,44054,44055,44057,44058,44059,44060,44061,44064,44068,44076,44077,44079,44080,44081,44088,44089,44092,44096,44107,44109,44116,44120,44124,44144,44145,44148,44151,44152,44154,44160,44161,44163,44164,44165,44166,44169,44170,44171,44172,44176,44180,44188,44189,44191,44192,44193,44200,44201,44202,44204,44207,44208,44216,44217,44219,44220,44221,44225,44228,44232,44236,44245,44247,44256,44257,44260,44263,44264,44266,44268,44271,44272,44273,44275,44277,44278,44284,44285,44288,44292,44294,44300,44301,44303,44305,44312,44316,44320,44329,44332,44333,44340,44341,44344,44348,44356,44357,44359,44361,44368,44372,44376,44385,44387,44396,44397,44400,44403,44404,44405,44406,44411,44412,44413,44415,44417,44418,44424,44425,44428,44432,44444,44445,44452,44471,44480,44481,44484,44488,44496,44497,44499,44508,44512,44516,44536,44537,44540,44543,44544,44545,44552,44553,44555,44557,44564,44592,44593,44596,44599,44600,44602,44608,44609,44611,44613,44614,44618,44620,44621,44622,44624,44628,44630,44636,44637,44639,44640,44641,44645,44648,44649,44652,44656,44664,44665,44667,44668,44669,44676,44677,44684,44732,44733,44734,44736,44740,44748,44749,44751,44752,44753,44760,44761,44764,44776,44779,44781,44788,44792,44796,44807,44808,44813,44816,44844,44845,44848,44850,44852,44860,44861,44863,44865,44866,44867,44872,44873,44880,44892,44893,44900,44901,44921,44928,44932,44936,44944,44945,44949,44956,44984,44985,44988,44992,44999,45e3,45001,45003,45005,45006,45012,45020,45032,45033,45040,45041,45044,45048,45056,45057,45060,45068,45072,45076,45084,45085,45096,45124,45125,45128,45130,45132,45134,45139,45140,45141,45143,45145,45149,45180,45181,45184,45188,45196,45197,45199,45201,45208,45209,45210,45212,45215,45216,45217,45218,45224,45225,45227,45228,45229,45230,45231,45233,45235,45236,45237,45240,45244,45252,45253,45255,45256,45257,45264,45265,45268,45272,45280,45285,45320,45321,45323,45324,45328,45330,45331,45336,45337,45339,45340,45341,45347,45348,45349,45352,45356,45364,45365,45367,45368,45369,45376,45377,45380,45384,45392,45393,45396,45397,45400,45404,45408,45432,45433,45436,45440,45442,45448,45449,45451,45453,45458,45459,45460,45464,45468,45480,45516,45520,45524,45532,45533,45535,45544,45545,45548,45552,45561,45563,45565,45572,45573,45576,45579,45580,45588,45589,45591,45593,45600,45620,45628,45656,45660,45664,45672,45673,45684,45685,45692,45700,45701,45705,45712,45713,45716,45720,45721,45722,45728,45729,45731,45733,45734,45738,45740,45744,45748,45768,45769,45772,45776,45778,45784,45785,45787,45789,45794,45796,45797,45798,45800,45803,45804,45805,45806,45807,45811,45812,45813,45815,45816,45817,45818,45819,45823,45824,45825,45828,45832,45840,45841,45843,45844,45845,45852,45908,45909,45910,45912,45915,45916,45918,45919,45924,45925,45927,45929,45931,45934,45936,45937,45940,45944,45952,45953,45955,45956,45957,45964,45968,45972,45984,45985,45992,45996,46020,46021,46024,46027,46028,46030,46032,46036,46037,46039,46041,46043,46045,46048,46052,46056,46076,46096,46104,46108,46112,46120,46121,46123,46132,46160,46161,46164,46168,46176,46177,46179,46181,46188,46208,46216,46237,46244,46248,46252,46261,46263,46265,46272,46276,46280,46288,46293,46300,46301,46304,46307,46308,46310,46316,46317,46319,46321,46328,46356,46357,46360,46363,46364,46372,46373,46375,46376,46377,46378,46384,46385,46388,46392,46400,46401,46403,46404,46405,46411,46412,46413,46416,46420,46428,46429,46431,46432,46433,46496,46497,46500,46504,46506,46507,46512,46513,46515,46516,46517,46523,46524,46525,46528,46532,46540,46541,46543,46544,46545,46552,46572,46608,46609,46612,46616,46629,46636,46644,46664,46692,46696,46748,46749,46752,46756,46763,46764,46769,46804,46832,46836,46840,46848,46849,46853,46888,46889,46892,46895,46896,46904,46905,46907,46916,46920,46924,46932,46933,46944,46948,46952,46960,46961,46963,46965,46972,46973,46976,46980,46988,46989,46991,46992,46993,46994,46998,46999,47e3,47001,47004,47008,47016,47017,47019,47020,47021,47028,47029,47032,47047,47049,47084,47085,47088,47092,47100,47101,47103,47104,47105,47111,47112,47113,47116,47120,47128,47129,47131,47133,47140,47141,47144,47148,47156,47157,47159,47160,47161,47168,47172,47185,47187,47196,47197,47200,47204,47212,47213,47215,47217,47224,47228,47245,47272,47280,47284,47288,47296,47297,47299,47301,47308,47312,47316,47325,47327,47329,47336,47337,47340,47344,47352,47353,47355,47357,47364,47384,47392,47420,47421,47424,47428,47436,47439,47441,47448,47449,47452,47456,47464,47465,47467,47469,47476,47477,47480,47484,47492,47493,47495,47497,47498,47501,47502,47532,47533,47536,47540,47548,47549,47551,47553,47560,47561,47564,47566,47567,47568,47569,47570,47576,47577,47579,47581,47582,47585,47587,47588,47589,47592,47596,47604,47605,47607,47608,47609,47610,47616,47617,47624,47637,47672,47673,47676,47680,47682,47688,47689,47691,47693,47694,47699,47700,47701,47704,47708,47716,47717,47719,47720,47721,47728,47729,47732,47736,47747,47748,47749,47751,47756,47784,47785,47787,47788,47792,47794,47800,47801,47803,47805,47812,47816,47832,47833,47868,47872,47876,47885,47887,47889,47896,47900,47904,47913,47915,47924,47925,47926,47928,47931,47932,47933,47934,47940,47941,47943,47945,47949,47951,47952,47956,47960,47969,47971,47980,48008,48012,48016,48036,48040,48044,48052,48055,48064,48068,48072,48080,48083,48120,48121,48124,48127,48128,48130,48136,48137,48139,48140,48141,48143,48145,48148,48149,48150,48151,48152,48155,48156,48157,48158,48159,48164,48165,48167,48169,48173,48176,48177,48180,48184,48192,48193,48195,48196,48197,48201,48204,48205,48208,48221,48260,48261,48264,48267,48268,48270,48276,48277,48279,48281,48282,48288,48289,48292,48295,48296,48304,48305,48307,48308,48309,48316,48317,48320,48324,48333,48335,48336,48337,48341,48344,48348,48372,48373,48374,48376,48380,48388,48389,48391,48393,48400,48404,48420,48428,48448,48456,48457,48460,48464,48472,48473,48484,48488,48512,48513,48516,48519,48520,48521,48522,48528,48529,48531,48533,48537,48538,48540,48548,48560,48568,48596,48597,48600,48604,48617,48624,48628,48632,48640,48643,48645,48652,48653,48656,48660,48668,48669,48671,48708,48709,48712,48716,48718,48724,48725,48727,48729,48730,48731,48736,48737,48740,48744,48746,48752,48753,48755,48756,48757,48763,48764,48765,48768,48772,48780,48781,48783,48784,48785,48792,48793,48808,48848,48849,48852,48855,48856,48864,48867,48868,48869,48876,48897,48904,48905,48920,48921,48923,48924,48925,48960,48961,48964,48968,48976,48977,48981,49044,49072,49093,49100,49101,49104,49108,49116,49119,49121,49212,49233,49240,49244,49248,49256,49257,49296,49297,49300,49304,49312,49313,49315,49317,49324,49325,49327,49328,49331,49332,49333,49334,49340,49341,49343,49344,49345,49349,49352,49353,49356,49360,49368,49369,49371,49372,49373,49380,49381,49384,49388,49396,49397,49399,49401,49408,49412,49416,49424,49429,49436,49437,49438,49439,49440,49443,49444,49446,49447,49452,49453,49455,49456,49457,49462,49464,49465,49468,49472,49480,49481,49483,49484,49485,49492,49493,49496,49500,49508,49509,49511,49512,49513,49520,49524,49528,49541,49548,49549,49550,49552,49556,49558,49564,49565,49567,49569,49573,49576,49577,49580,49584,49597,49604,49608,49612,49620,49623,49624,49632,49636,49640,49648,49649,49651,49660,49661,49664,49668,49676,49677,49679,49681,49688,49689,49692,49695,49696,49704,49705,49707,49709,49711,49713,49714,49716,49736,49744,49745,49748,49752,49760,49765,49772,49773,49776,49780,49788,49789,49791,49793,49800,49801,49808,49816,49819,49821,49828,49829,49832,49836,49837,49844,49845,49847,49849,49884,49885,49888,49891,49892,49899,49900,49901,49903,49905,49910,49912,49913,49915,49916,49920,49928,49929,49932,49933,49939,49940,49941,49944,49948,49956,49957,49960,49961,49989,50024,50025,50028,50032,50034,50040,50041,50044,50045,50052,50056,50060,50112,50136,50137,50140,50143,50144,50146,50152,50153,50157,50164,50165,50168,50184,50192,50212,50220,50224,50228,50236,50237,50248,50276,50277,50280,50284,50292,50293,50297,50304,50324,50332,50360,50364,50409,50416,50417,50420,50424,50426,50431,50432,50433,50444,50448,50452,50460,50472,50473,50476,50480,50488,50489,50491,50493,50500,50501,50504,50505,50506,50508,50509,50510,50515,50516,50517,50519,50520,50521,50525,50526,50528,50529,50532,50536,50544,50545,50547,50548,50549,50556,50557,50560,50564,50567,50572,50573,50575,50577,50581,50583,50584,50588,50592,50601,50612,50613,50616,50617,50619,50620,50621,50622,50628,50629,50630,50631,50632,50633,50634,50636,50638,50640,50641,50644,50648,50656,50657,50659,50661,50668,50669,50670,50672,50676,50678,50679,50684,50685,50686,50687,50688,50689,50693,50694,50695,50696,50700,50704,50712,50713,50715,50716,50724,50725,50728,50732,50733,50734,50736,50739,50740,50741,50743,50745,50747,50752,50753,50756,50760,50768,50769,50771,50772,50773,50780,50781,50784,50796,50799,50801,50808,50809,50812,50816,50824,50825,50827,50829,50836,50837,50840,50844,50852,50853,50855,50857,50864,50865,50868,50872,50873,50874,50880,50881,50883,50885,50892,50893,50896,50900,50908,50909,50912,50913,50920,50921,50924,50928,50936,50937,50941,50948,50949,50952,50956,50964,50965,50967,50969,50976,50977,50980,50984,50992,50993,50995,50997,50999,51004,51005,51008,51012,51018,51020,51021,51023,51025,51026,51027,51028,51029,51030,51031,51032,51036,51040,51048,51051,51060,51061,51064,51068,51069,51070,51075,51076,51077,51079,51080,51081,51082,51086,51088,51089,51092,51094,51095,51096,51098,51104,51105,51107,51108,51109,51110,51116,51117,51120,51124,51132,51133,51135,51136,51137,51144,51145,51148,51150,51152,51160,51165,51172,51176,51180,51200,51201,51204,51208,51210,51216,51217,51219,51221,51222,51228,51229,51232,51236,51244,51245,51247,51249,51256,51260,51264,51272,51273,51276,51277,51284,51312,51313,51316,51320,51322,51328,51329,51331,51333,51334,51335,51339,51340,51341,51348,51357,51359,51361,51368,51388,51389,51396,51400,51404,51412,51413,51415,51417,51424,51425,51428,51445,51452,51453,51456,51460,51461,51462,51468,51469,51471,51473,51480,51500,51508,51536,51537,51540,51544,51552,51553,51555,51564,51568,51572,51580,51592,51593,51596,51600,51608,51609,51611,51613,51648,51649,51652,51655,51656,51658,51664,51665,51667,51669,51670,51673,51674,51676,51677,51680,51682,51684,51687,51692,51693,51695,51696,51697,51704,51705,51708,51712,51720,51721,51723,51724,51725,51732,51736,51753,51788,51789,51792,51796,51804,51805,51807,51808,51809,51816,51837,51844,51864,51900,51901,51904,51908,51916,51917,51919,51921,51923,51928,51929,51936,51948,51956,51976,51984,51988,51992,52e3,52001,52033,52040,52041,52044,52048,52056,52057,52061,52068,52088,52089,52124,52152,52180,52196,52199,52201,52236,52237,52240,52244,52252,52253,52257,52258,52263,52264,52265,52268,52270,52272,52280,52281,52283,52284,52285,52286,52292,52293,52296,52300,52308,52309,52311,52312,52313,52320,52324,52326,52328,52336,52341,52376,52377,52380,52384,52392,52393,52395,52396,52397,52404,52405,52408,52412,52420,52421,52423,52425,52432,52436,52452,52460,52464,52481,52488,52489,52492,52496,52504,52505,52507,52509,52516,52520,52524,52537,52572,52576,52580,52588,52589,52591,52593,52600,52616,52628,52629,52632,52636,52644,52645,52647,52649,52656,52676,52684,52688,52712,52716,52720,52728,52729,52731,52733,52740,52744,52748,52756,52761,52768,52769,52772,52776,52784,52785,52787,52789,52824,52825,52828,52831,52832,52833,52840,52841,52843,52845,52852,52853,52856,52860,52868,52869,52871,52873,52880,52881,52884,52888,52896,52897,52899,52900,52901,52908,52909,52929,52964,52965,52968,52971,52972,52980,52981,52983,52984,52985,52992,52993,52996,53e3,53008,53009,53011,53013,53020,53024,53028,53036,53037,53039,53040,53041,53048,53076,53077,53080,53084,53092,53093,53095,53097,53104,53105,53108,53112,53120,53125,53132,53153,53160,53168,53188,53216,53217,53220,53224,53232,53233,53235,53237,53244,53248,53252,53265,53272,53293,53300,53301,53304,53308,53316,53317,53319,53321,53328,53332,53336,53344,53356,53357,53360,53364,53372,53373,53377,53412,53413,53416,53420,53428,53429,53431,53433,53440,53441,53444,53448,53449,53456,53457,53459,53460,53461,53468,53469,53472,53476,53484,53485,53487,53488,53489,53496,53517,53552,53553,53556,53560,53562,53568,53569,53571,53572,53573,53580,53581,53584,53588,53596,53597,53599,53601,53608,53612,53628,53636,53640,53664,53665,53668,53672,53680,53681,53683,53685,53690,53692,53696,53720,53748,53752,53767,53769,53776,53804,53805,53808,53812,53820,53821,53823,53825,53832,53852,53860,53888,53889,53892,53896,53904,53905,53909,53916,53920,53924,53932,53937,53944,53945,53948,53951,53952,53954,53960,53961,53963,53972,53976,53980,53988,53989,54e3,54001,54004,54008,54016,54017,54019,54021,54028,54029,54030,54032,54036,54038,54044,54045,54047,54048,54049,54053,54056,54057,54060,54064,54072,54073,54075,54076,54077,54084,54085,54140,54141,54144,54148,54156,54157,54159,54160,54161,54168,54169,54172,54176,54184,54185,54187,54189,54196,54200,54204,54212,54213,54216,54217,54224,54232,54241,54243,54252,54253,54256,54260,54268,54269,54271,54273,54280,54301,54336,54340,54364,54368,54372,54381,54383,54392,54393,54396,54399,54400,54402,54408,54409,54411,54413,54420,54441,54476,54480,54484,54492,54495,54504,54508,54512,54520,54523,54525,54532,54536,54540,54548,54549,54551,54588,54589,54592,54596,54604,54605,54607,54609,54616,54617,54620,54624,54629,54632,54633,54635,54637,54644,54645,54648,54652,54660,54661,54663,54664,54665,54672,54693,54728,54729,54732,54736,54738,54744,54745,54747,54749,54756,54757,54760,54764,54772,54773,54775,54777,54784,54785,54788,54792,54800,54801,54803,54804,54805,54812,54816,54820,54829,54840,54841,54844,54848,54853,54856,54857,54859,54861,54865,54868,54869,54872,54876,54887,54889,54896,54897,54900,54915,54917,54924,54925,54928,54932,54941,54943,54945,54952,54956,54960,54969,54971,54980,54981,54984,54988,54993,54996,54999,55001,55008,55012,55016,55024,55029,55036,55037,55040,55044,55057,55064,55065,55068,55072,55080,55081,55083,55085,55092,55093,55096,55100,55108,55111,55113,55120,55121,55124,55126,55127,55128,55129,55136,55137,55139,55141,55145,55148,55152,55156,55164,55165,55169,55176,55177,55180,55184,55192,55193,55195,55197,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,20285,20339,20551,20729,21152,21487,21621,21733,22025,23233,23478,26247,26550,26551,26607,27468,29634,30146,31292,33499,33540,34903,34952,35382,36040,36303,36603,36838,39381,21051,21364,21508,24682,24932,27580,29647,33050,35258,35282,38307,20355,21002,22718,22904,23014,24178,24185,25031,25536,26438,26604,26751,28567,30286,30475,30965,31240,31487,31777,32925,33390,33393,35563,38291,20075,21917,26359,28212,30883,31469,33883,35088,34638,38824,21208,22350,22570,23884,24863,25022,25121,25954,26577,27204,28187,29976,30131,30435,30640,32058,37039,37969,37970,40853,21283,23724,30002,32987,37440,38296,21083,22536,23004,23713,23831,24247,24378,24394,24951,27743,30074,30086,31968,32115,32177,32652,33108,33313,34193,35137,35611,37628,38477,40007,20171,20215,20491,20977,22607,24887,24894,24936,25913,27114,28433,30117,30342,30422,31623,33445,33995,63744,37799,38283,21888,23458,22353,63745,31923,32697,37301,20520,21435,23621,24040,25298,25454,25818,25831,28192,28844,31067,36317,36382,63746,36989,37445,37624,20094,20214,20581,24062,24314,24838,26967,33137,34388,36423,37749,39467,20062,20625,26480,26688,20745,21133,21138,27298,30652,37392,40660,21163,24623,36850,20552,25001,25581,25802,26684,27268,28608,33160,35233,38548,22533,29309,29356,29956,32121,32365,32937,35211,35700,36963,40273,25225,27770,28500,32080,32570,35363,20860,24906,31645,35609,37463,37772,20140,20435,20510,20670,20742,21185,21197,21375,22384,22659,24218,24465,24950,25004,25806,25964,26223,26299,26356,26775,28039,28805,28913,29855,29861,29898,30169,30828,30956,31455,31478,32069,32147,32789,32831,33051,33686,35686,36629,36885,37857,38915,38968,39514,39912,20418,21843,22586,22865,23395,23622,24760,25106,26690,26800,26856,28330,30028,30328,30926,31293,31995,32363,32380,35336,35489,35903,38542,40388,21476,21481,21578,21617,22266,22993,23396,23611,24235,25335,25911,25925,25970,26272,26543,27073,27837,30204,30352,30590,31295,32660,32771,32929,33167,33510,33533,33776,34241,34865,34996,35493,63747,36764,37678,38599,39015,39640,40723,21741,26011,26354,26767,31296,35895,40288,22256,22372,23825,26118,26801,26829,28414,29736,34974,39908,27752,63748,39592,20379,20844,20849,21151,23380,24037,24656,24685,25329,25511,25915,29657,31354,34467,36002,38799,20018,23521,25096,26524,29916,31185,33747,35463,35506,36328,36942,37707,38982,24275,27112,34303,37101,63749,20896,23448,23532,24931,26874,27454,28748,29743,29912,31649,32592,33733,35264,36011,38364,39208,21038,24669,25324,36866,20362,20809,21281,22745,24291,26336,27960,28826,29378,29654,31568,33009,37979,21350,25499,32619,20054,20608,22602,22750,24618,24871,25296,27088,39745,23439,32024,32945,36703,20132,20689,21676,21932,23308,23968,24039,25898,25934,26657,27211,29409,30350,30703,32094,32761,33184,34126,34527,36611,36686,37066,39171,39509,39851,19992,20037,20061,20167,20465,20855,21246,21312,21475,21477,21646,22036,22389,22434,23495,23943,24272,25084,25304,25937,26552,26601,27083,27472,27590,27628,27714,28317,28792,29399,29590,29699,30655,30697,31350,32127,32777,33276,33285,33290,33503,34914,35635,36092,36544,36881,37041,37476,37558,39378,39493,40169,40407,40860,22283,23616,33738,38816,38827,40628,21531,31384,32676,35033,36557,37089,22528,23624,25496,31391,23470,24339,31353,31406,33422,36524,20518,21048,21240,21367,22280,25331,25458,27402,28099,30519,21413,29527,34152,36470,38357,26426,27331,28528,35437,36556,39243,63750,26231,27512,36020,39740,63751,21483,22317,22862,25542,27131,29674,30789,31418,31429,31998,33909,35215,36211,36917,38312,21243,22343,30023,31584,33740,37406,63752,27224,20811,21067,21127,25119,26840,26997,38553,20677,21156,21220,25027,26020,26681,27135,29822,31563,33465,33771,35250,35641,36817,39241,63753,20170,22935,25810,26129,27278,29748,31105,31165,33449,34942,34943,35167,63754,37670,20235,21450,24613,25201,27762,32026,32102,20120,20834,30684,32943,20225,20238,20854,20864,21980,22120,22331,22522,22524,22804,22855,22931,23492,23696,23822,24049,24190,24524,25216,26071,26083,26398,26399,26462,26827,26820,27231,27450,27683,27773,27778,28103,29592,29734,29738,29826,29859,30072,30079,30849,30959,31041,31047,31048,31098,31637,32e3,32186,32648,32774,32813,32908,35352,35663,35912,36215,37665,37668,39138,39249,39438,39439,39525,40594,32202,20342,21513,25326,26708,37329,21931,20794,63755,63756,23068,25062,63757,25295,25343,63758,63759,63760,63761,63762,63763,37027,63764,63765,63766,63767,63768,35582,63769,63770,63771,63772,26262,63773,29014,63774,63775,38627,63776,25423,25466,21335,63777,26511,26976,28275,63778,30007,63779,63780,63781,32013,63782,63783,34930,22218,23064,63784,63785,63786,63787,63788,20035,63789,20839,22856,26608,32784,63790,22899,24180,25754,31178,24565,24684,25288,25467,23527,23511,21162,63791,22900,24361,24594,63792,63793,63794,29785,63795,63796,63797,63798,63799,63800,39377,63801,63802,63803,63804,63805,63806,63807,63808,63809,63810,63811,28611,63812,63813,33215,36786,24817,63814,63815,33126,63816,63817,23615,63818,63819,63820,63821,63822,63823,63824,63825,23273,35365,26491,32016,63826,63827,63828,63829,63830,63831,33021,63832,63833,23612,27877,21311,28346,22810,33590,20025,20150,20294,21934,22296,22727,24406,26039,26086,27264,27573,28237,30701,31471,31774,32222,34507,34962,37170,37723,25787,28606,29562,30136,36948,21846,22349,25018,25812,26311,28129,28251,28525,28601,30192,32835,33213,34113,35203,35527,35674,37663,27795,30035,31572,36367,36957,21776,22530,22616,24162,25095,25758,26848,30070,31958,34739,40680,20195,22408,22382,22823,23565,23729,24118,24453,25140,25825,29619,33274,34955,36024,38538,40667,23429,24503,24755,20498,20992,21040,22294,22581,22615,23566,23648,23798,23947,24230,24466,24764,25361,25481,25623,26691,26873,27330,28120,28193,28372,28644,29182,30428,30585,31153,31291,33796,35241,36077,36339,36424,36867,36884,36947,37117,37709,38518,38876,27602,28678,29272,29346,29544,30563,31167,31716,32411,35712,22697,24775,25958,26109,26302,27788,28958,29129,35930,38931,20077,31361,20189,20908,20941,21205,21516,24999,26481,26704,26847,27934,28540,30140,30643,31461,33012,33891,37509,20828,26007,26460,26515,30168,31431,33651,63834,35910,36887,38957,23663,33216,33434,36929,36975,37389,24471,23965,27225,29128,30331,31561,34276,35588,37159,39472,21895,25078,63835,30313,32645,34367,34746,35064,37007,63836,27931,28889,29662,32097,33853,63837,37226,39409,63838,20098,21365,27396,27410,28734,29211,34349,40478,21068,36771,23888,25829,25900,27414,28651,31811,32412,34253,35172,35261,25289,33240,34847,24266,26391,28010,29436,29701,29807,34690,37086,20358,23821,24480,33802,20919,25504,30053,20142,20486,20841,20937,26753,27153,31918,31921,31975,33391,35538,36635,37327,20406,20791,21237,21570,24300,24942,25150,26053,27354,28670,31018,34268,34851,38317,39522,39530,40599,40654,21147,26310,27511,28701,31019,36706,38722,24976,25088,25891,28451,29001,29833,32244,32879,34030,36646,36899,37706,20925,21015,21155,27916,28872,35010,24265,25986,27566,28610,31806,29557,20196,20278,22265,63839,23738,23994,24604,29618,31533,32666,32718,32838,36894,37428,38646,38728,38936,40801,20363,28583,31150,37300,38583,21214,63840,25736,25796,27347,28510,28696,29200,30439,32769,34310,34396,36335,36613,38706,39791,40442,40565,30860,31103,32160,33737,37636,40575,40595,35542,22751,24324,26407,28711,29903,31840,32894,20769,28712,29282,30922,36034,36058,36084,38647,20102,20698,23534,24278,26009,29134,30274,30637,32842,34044,36988,39719,40845,22744,23105,23650,27155,28122,28431,30267,32047,32311,34078,35128,37860,38475,21129,26066,26611,27060,27969,28316,28687,29705,29792,30041,30244,30827,35628,39006,20845,25134,38520,20374,20523,23833,28138,32184,36650,24459,24900,26647,63841,38534,21202,32907,20956,20940,26974,31260,32190,33777,38517,20442,21033,21400,21519,21774,23653,24743,26446,26792,28012,29313,29432,29702,29827,63842,30178,31852,32633,32696,33673,35023,35041,37324,37328,38626,39881,21533,28542,29136,29848,34298,36522,38563,40023,40607,26519,28107,29747,33256,38678,30764,31435,31520,31890,25705,29802,30194,30908,30952,39340,39764,40635,23518,24149,28448,33180,33707,37e3,19975,21325,23081,24018,24398,24930,25405,26217,26364,28415,28459,28771,30622,33836,34067,34875,36627,39237,39995,21788,25273,26411,27819,33545,35178,38778,20129,22916,24536,24537,26395,32178,32596,33426,33579,33725,36638,37017,22475,22969,23186,23504,26151,26522,26757,27599,29028,32629,36023,36067,36993,39749,33032,35978,38476,39488,40613,23391,27667,29467,30450,30431,33804,20906,35219,20813,20885,21193,26825,27796,30468,30496,32191,32236,38754,40629,28357,34065,20901,21517,21629,26126,26269,26919,28319,30399,30609,33559,33986,34719,37225,37528,40180,34946,20398,20882,21215,22982,24125,24917,25720,25721,26286,26576,27169,27597,27611,29279,29281,29761,30520,30683,32791,33468,33541,35584,35624,35980,26408,27792,29287,30446,30566,31302,40361,27519,27794,22818,26406,33945,21359,22675,22937,24287,25551,26164,26483,28218,29483,31447,33495,37672,21209,24043,25006,25035,25098,25287,25771,26080,26969,27494,27595,28961,29687,30045,32326,33310,33538,34154,35491,36031,38695,40289,22696,40664,20497,21006,21563,21839,25991,27766,32010,32011,32862,34442,38272,38639,21247,27797,29289,21619,23194,23614,23883,24396,24494,26410,26806,26979,28220,28228,30473,31859,32654,34183,35598,36855,38753,40692,23735,24758,24845,25003,25935,26107,26108,27665,27887,29599,29641,32225,38292,23494,34588,35600,21085,21338,25293,25615,25778,26420,27192,27850,29632,29854,31636,31893,32283,33162,33334,34180,36843,38649,39361,20276,21322,21453,21467,25292,25644,25856,26001,27075,27886,28504,29677,30036,30242,30436,30460,30928,30971,31020,32070,33324,34784,36820,38930,39151,21187,25300,25765,28196,28497,30332,36299,37297,37474,39662,39747,20515,20621,22346,22952,23592,24135,24439,25151,25918,26041,26049,26121,26507,27036,28354,30917,32033,32938,33152,33323,33459,33953,34444,35370,35607,37030,38450,40848,20493,20467,63843,22521,24472,25308,25490,26479,28227,28953,30403,32972,32986,35060,35061,35097,36064,36649,37197,38506,20271,20336,24091,26575,26658,30333,30334,39748,24161,27146,29033,29140,30058,63844,32321,34115,34281,39132,20240,31567,32624,38309,20961,24070,26805,27710,27726,27867,29359,31684,33539,27861,29754,20731,21128,22721,25816,27287,29863,30294,30887,34327,38370,38713,63845,21342,24321,35722,36776,36783,37002,21029,30629,40009,40712,19993,20482,20853,23643,24183,26142,26170,26564,26821,28851,29953,30149,31177,31453,36647,39200,39432,20445,22561,22577,23542,26222,27493,27921,28282,28541,29668,29995,33769,35036,35091,35676,36628,20239,20693,21264,21340,23443,24489,26381,31119,33145,33583,34068,35079,35206,36665,36667,39333,39954,26412,20086,20472,22857,23553,23791,23792,25447,26834,28925,29090,29739,32299,34028,34562,36898,37586,40179,19981,20184,20463,20613,21078,21103,21542,21648,22496,22827,23142,23386,23413,23500,24220,63846,25206,25975,26023,28014,28325,29238,31526,31807,32566,33104,33105,33178,33344,33433,33705,35331,36e3,36070,36091,36212,36282,37096,37340,38428,38468,39385,40167,21271,20998,21545,22132,22707,22868,22894,24575,24996,25198,26128,27774,28954,30406,31881,31966,32027,33452,36033,38640,63847,20315,24343,24447,25282,23849,26379,26842,30844,32323,40300,19989,20633,21269,21290,21329,22915,23138,24199,24754,24970,25161,25209,26e3,26503,27047,27604,27606,27607,27608,27832,63848,29749,30202,30738,30865,31189,31192,31875,32203,32737,32933,33086,33218,33778,34586,35048,35513,35692,36027,37145,38750,39131,40763,22188,23338,24428,25996,27315,27567,27996,28657,28693,29277,29613,36007,36051,38971,24977,27703,32856,39425,20045,20107,20123,20181,20282,20284,20351,20447,20735,21490,21496,21766,21987,22235,22763,22882,23057,23531,23546,23556,24051,24107,24473,24605,25448,26012,26031,26614,26619,26797,27515,27801,27863,28195,28681,29509,30722,31038,31040,31072,31169,31721,32023,32114,32902,33293,33678,34001,34503,35039,35408,35422,35613,36060,36198,36781,37034,39164,39391,40605,21066,63849,26388,63850,20632,21034,23665,25955,27733,29642,29987,30109,31639,33948,37240,38704,20087,25746,27578,29022,34217,19977,63851,26441,26862,28183,33439,34072,34923,25591,28545,37394,39087,19978,20663,20687,20767,21830,21930,22039,23360,23577,23776,24120,24202,24224,24258,24819,26705,27233,28248,29245,29248,29376,30456,31077,31665,32724,35059,35316,35443,35937,36062,38684,22622,29885,36093,21959,63852,31329,32034,33394,29298,29983,29989,63853,31513,22661,22779,23996,24207,24246,24464,24661,25234,25471,25933,26257,26329,26360,26646,26866,29312,29790,31598,32110,32214,32626,32997,33298,34223,35199,35475,36893,37604,40653,40736,22805,22893,24109,24796,26132,26227,26512,27728,28101,28511,30707,30889,33990,37323,37675,20185,20682,20808,21892,23307,23459,25159,25982,26059,28210,29053,29697,29764,29831,29887,30316,31146,32218,32341,32680,33146,33203,33337,34330,34796,35445,36323,36984,37521,37925,39245,39854,21352,23633,26964,27844,27945,28203,33292,34203,35131,35373,35498,38634,40807,21089,26297,27570,32406,34814,36109,38275,38493,25885,28041,29166,63854,22478,22995,23468,24615,24826,25104,26143,26207,29481,29689,30427,30465,31596,32854,32882,33125,35488,37266,19990,21218,27506,27927,31237,31545,32048,63855,36016,21484,22063,22609,23477,23567,23569,24034,25152,25475,25620,26157,26803,27836,28040,28335,28703,28836,29138,29990,30095,30094,30233,31505,31712,31787,32032,32057,34092,34157,34311,35380,36877,36961,37045,37559,38902,39479,20439,23660,26463,28049,31903,32396,35606,36118,36895,23403,24061,25613,33984,36956,39137,29575,23435,24730,26494,28126,35359,35494,36865,38924,21047,63856,28753,30862,37782,34928,37335,20462,21463,22013,22234,22402,22781,23234,23432,23723,23744,24101,24833,25101,25163,25480,25628,25910,25976,27193,27530,27700,27929,28465,29159,29417,29560,29703,29874,30246,30561,31168,31319,31466,31929,32143,32172,32353,32670,33065,33585,33936,34010,34282,34966,35504,35728,36664,36930,36995,37228,37526,37561,38539,38567,38568,38614,38656,38920,39318,39635,39706,21460,22654,22809,23408,23487,28113,28506,29087,29729,29881,32901,33789,24033,24455,24490,24642,26092,26642,26991,27219,27529,27957,28147,29667,30462,30636,31565,32020,33059,33308,33600,34036,34147,35426,35524,37255,37662,38918,39348,25100,34899,36848,37477,23815,23847,23913,29791,33181,34664,28629,25342,32722,35126,35186,19998,20056,20711,21213,21319,25215,26119,32361,34821,38494,20365,21273,22070,22987,23204,23608,23630,23629,24066,24337,24643,26045,26159,26178,26558,26612,29468,30690,31034,32709,33940,33997,35222,35430,35433,35553,35925,35962,22516,23508,24335,24687,25325,26893,27542,28252,29060,31698,34645,35672,36606,39135,39166,20280,20353,20449,21627,23072,23480,24892,26032,26216,29180,30003,31070,32051,33102,33251,33688,34218,34254,34563,35338,36523,36763,63857,36805,22833,23460,23526,24713,23529,23563,24515,27777,63858,28145,28683,29978,33455,35574,20160,21313,63859,38617,27663,20126,20420,20818,21854,23077,23784,25105,29273,33469,33706,34558,34905,35357,38463,38597,39187,40201,40285,22538,23731,23997,24132,24801,24853,25569,27138,28197,37122,37716,38990,39952,40823,23433,23736,25353,26191,26696,30524,38593,38797,38996,39839,26017,35585,36555,38332,21813,23721,24022,24245,26263,30284,33780,38343,22739,25276,29390,40232,20208,22830,24591,26171,27523,31207,40230,21395,21696,22467,23830,24859,26326,28079,30861,33406,38552,38724,21380,25212,25494,28082,32266,33099,38989,27387,32588,40367,40474,20063,20539,20918,22812,24825,25590,26928,29242,32822,63860,37326,24369,63861,63862,32004,33509,33903,33979,34277,36493,63863,20335,63864,63865,22756,23363,24665,25562,25880,25965,26264,63866,26954,27171,27915,28673,29036,30162,30221,31155,31344,63867,32650,63868,35140,63869,35731,37312,38525,63870,39178,22276,24481,26044,28417,30208,31142,35486,39341,39770,40812,20740,25014,25233,27277,33222,20547,22576,24422,28937,35328,35578,23420,34326,20474,20796,22196,22852,25513,28153,23978,26989,20870,20104,20313,63871,63872,63873,22914,63874,63875,27487,27741,63876,29877,30998,63877,33287,33349,33593,36671,36701,63878,39192,63879,63880,63881,20134,63882,22495,24441,26131,63883,63884,30123,32377,35695,63885,36870,39515,22181,22567,23032,23071,23476,63886,24310,63887,63888,25424,25403,63889,26941,27783,27839,28046,28051,28149,28436,63890,28895,28982,29017,63891,29123,29141,63892,30799,30831,63893,31605,32227,63894,32303,63895,34893,36575,63896,63897,63898,37467,63899,40182,63900,63901,63902,24709,28037,63903,29105,63904,63905,38321,21421,63906,63907,63908,26579,63909,28814,28976,29744,33398,33490,63910,38331,39653,40573,26308,63911,29121,33865,63912,63913,22603,63914,63915,23992,24433,63916,26144,26254,27001,27054,27704,27891,28214,28481,28634,28699,28719,29008,29151,29552,63917,29787,63918,29908,30408,31310,32403,63919,63920,33521,35424,36814,63921,37704,63922,38681,63923,63924,20034,20522,63925,21e3,21473,26355,27757,28618,29450,30591,31330,33454,34269,34306,63926,35028,35427,35709,35947,63927,37555,63928,38675,38928,20116,20237,20425,20658,21320,21566,21555,21978,22626,22714,22887,23067,23524,24735,63929,25034,25942,26111,26212,26791,27738,28595,28879,29100,29522,31613,34568,35492,39986,40711,23627,27779,29508,29577,37434,28331,29797,30239,31337,32277,34314,20800,22725,25793,29934,29973,30320,32705,37013,38605,39252,28198,29926,31401,31402,33253,34521,34680,35355,23113,23436,23451,26785,26880,28003,29609,29715,29740,30871,32233,32747,33048,33109,33694,35916,38446,38929,26352,24448,26106,26505,27754,29579,20525,23043,27498,30702,22806,23916,24013,29477,30031,63930,63931,20709,20985,22575,22829,22934,23002,23525,63932,63933,23970,25303,25622,25747,25854,63934,26332,63935,27208,63936,29183,29796,63937,31368,31407,32327,32350,32768,33136,63938,34799,35201,35616,36953,63939,36992,39250,24958,27442,28020,32287,35109,36785,20433,20653,20887,21191,22471,22665,23481,24248,24898,27029,28044,28263,28342,29076,29794,29992,29996,32883,33592,33993,36362,37780,37854,63940,20110,20305,20598,20778,21448,21451,21491,23431,23507,23588,24858,24962,26100,29275,29591,29760,30402,31056,31121,31161,32006,32701,33419,34261,34398,36802,36935,37109,37354,38533,38632,38633,21206,24423,26093,26161,26671,29020,31286,37057,38922,20113,63941,27218,27550,28560,29065,32792,33464,34131,36939,38549,38642,38907,34074,39729,20112,29066,38596,20803,21407,21729,22291,22290,22435,23195,23236,23491,24616,24895,25588,27781,27961,28274,28304,29232,29503,29783,33489,34945,36677,36960,63942,38498,39e3,40219,26376,36234,37470,20301,20553,20702,21361,22285,22996,23041,23561,24944,26256,28205,29234,29771,32239,32963,33806,33894,34111,34655,34907,35096,35586,36949,38859,39759,20083,20369,20754,20842,63943,21807,21929,23418,23461,24188,24189,24254,24736,24799,24840,24841,25540,25912,26377,63944,26580,26586,63945,26977,26978,27833,27943,63946,28216,63947,28641,29494,29495,63948,29788,30001,63949,30290,63950,63951,32173,33278,33848,35029,35480,35547,35565,36400,36418,36938,36926,36986,37193,37321,37742,63952,63953,22537,63954,27603,32905,32946,63955,63956,20801,22891,23609,63957,63958,28516,29607,32996,36103,63959,37399,38287,63960,63961,63962,63963,32895,25102,28700,32104,34701,63964,22432,24681,24903,27575,35518,37504,38577,20057,21535,28139,34093,38512,38899,39150,25558,27875,37009,20957,25033,33210,40441,20381,20506,20736,23452,24847,25087,25836,26885,27589,30097,30691,32681,33380,34191,34811,34915,35516,35696,37291,20108,20197,20234,63965,63966,22839,23016,63967,24050,24347,24411,24609,63968,63969,63970,63971,29246,29669,63972,30064,30157,63973,31227,63974,32780,32819,32900,33505,33617,63975,63976,36029,36019,36999,63977,63978,39156,39180,63979,63980,28727,30410,32714,32716,32764,35610,20154,20161,20995,21360,63981,21693,22240,23035,23493,24341,24525,28270,63982,63983,32106,33589,63984,34451,35469,63985,38765,38775,63986,63987,19968,20314,20350,22777,26085,28322,36920,37808,39353,20219,22764,22922,23001,24641,63988,63989,31252,63990,33615,36035,20837,21316,63991,63992,63993,20173,21097,23381,33471,20180,21050,21672,22985,23039,23376,23383,23388,24675,24904,28363,28825,29038,29574,29943,30133,30913,32043,32773,33258,33576,34071,34249,35566,36039,38604,20316,21242,22204,26027,26152,28796,28856,29237,32189,33421,37196,38592,40306,23409,26855,27544,28538,30430,23697,26283,28507,31668,31786,34870,38620,19976,20183,21280,22580,22715,22767,22892,23559,24115,24196,24373,25484,26290,26454,27167,27299,27404,28479,29254,63994,29520,29835,31456,31911,33144,33247,33255,33674,33900,34083,34196,34255,35037,36115,37292,38263,38556,20877,21705,22312,23472,25165,26448,26685,26771,28221,28371,28797,32289,35009,36001,36617,40779,40782,29229,31631,35533,37658,20295,20302,20786,21632,22992,24213,25269,26485,26990,27159,27822,28186,29401,29482,30141,31672,32053,33511,33785,33879,34295,35419,36015,36487,36889,37048,38606,40799,21219,21514,23265,23490,25688,25973,28404,29380,63995,30340,31309,31515,31821,32318,32735,33659,35627,36042,36196,36321,36447,36842,36857,36969,37841,20291,20346,20659,20840,20856,21069,21098,22625,22652,22880,23560,23637,24283,24731,25136,26643,27583,27656,28593,29006,29728,3e4,30008,30033,30322,31564,31627,31661,31686,32399,35438,36670,36681,37439,37523,37666,37931,38651,39002,39019,39198,20999,25130,25240,27993,30308,31434,31680,32118,21344,23742,24215,28472,28857,31896,38673,39822,40670,25509,25722,34678,19969,20117,20141,20572,20597,21576,22979,23450,24128,24237,24311,24449,24773,25402,25919,25972,26060,26230,26232,26622,26984,27273,27491,27712,28096,28136,28191,28254,28702,28833,29582,29693,30010,30555,30855,31118,31243,31357,31934,32142,33351,35330,35562,35998,37165,37194,37336,37478,37580,37664,38662,38742,38748,38914,40718,21046,21137,21884,22564,24093,24351,24716,25552,26799,28639,31085,31532,33229,34234,35069,35576,36420,37261,38500,38555,38717,38988,40778,20430,20806,20939,21161,22066,24340,24427,25514,25805,26089,26177,26362,26361,26397,26781,26839,27133,28437,28526,29031,29157,29226,29866,30522,31062,31066,31199,31264,31381,31895,31967,32068,32368,32903,34299,34468,35412,35519,36249,36481,36896,36973,37347,38459,38613,40165,26063,31751,36275,37827,23384,23562,21330,25305,29469,20519,23447,24478,24752,24939,26837,28121,29742,31278,32066,32156,32305,33131,36394,36405,37758,37912,20304,22352,24038,24231,25387,32618,20027,20303,20367,20570,23005,32964,21610,21608,22014,22863,23449,24030,24282,26205,26417,26609,26666,27880,27954,28234,28557,28855,29664,30087,31820,32002,32044,32162,33311,34523,35387,35461,36208,36490,36659,36913,37198,37202,37956,39376,31481,31909,20426,20737,20934,22472,23535,23803,26201,27197,27994,28310,28652,28940,30063,31459,34850,36897,36981,38603,39423,33537,20013,20210,34886,37325,21373,27355,26987,27713,33914,22686,24974,26366,25327,28893,29969,30151,32338,33976,35657,36104,20043,21482,21675,22320,22336,24535,25345,25351,25711,25903,26088,26234,26525,26547,27490,27744,27802,28460,30693,30757,31049,31063,32025,32930,33026,33267,33437,33463,34584,35468,63996,36100,36286,36978,30452,31257,31287,32340,32887,21767,21972,22645,25391,25634,26185,26187,26733,27035,27524,27941,28337,29645,29800,29857,30043,30137,30433,30494,30603,31206,32265,32285,33275,34095,34967,35386,36049,36587,36784,36914,37805,38499,38515,38663,20356,21489,23018,23241,24089,26702,29894,30142,31209,31378,33187,34541,36074,36300,36845,26015,26389,63997,22519,28503,32221,36655,37878,38598,24501,25074,28548,19988,20376,20511,21449,21983,23919,24046,27425,27492,30923,31642,63998,36425,36554,36974,25417,25662,30528,31364,37679,38015,40810,25776,28591,29158,29864,29914,31428,31762,32386,31922,32408,35738,36106,38013,39184,39244,21049,23519,25830,26413,32046,20717,21443,22649,24920,24921,25082,26028,31449,35730,35734,20489,20513,21109,21809,23100,24288,24432,24884,25950,26124,26166,26274,27085,28356,28466,29462,30241,31379,33081,33369,33750,33980,20661,22512,23488,23528,24425,25505,30758,32181,33756,34081,37319,37365,20874,26613,31574,36012,20932,22971,24765,34389,20508,63999,21076,23610,24957,25114,25299,25842,26021,28364,30240,33034,36448,38495,38587,20191,21315,21912,22825,24029,25797,27849,28154,29588,31359,33307,34214,36068,36368,36983,37351,38369,38433,38854,20984,21746,21894,24505,25764,28552,32180,36639,36685,37941,20681,23574,27838,28155,29979,30651,31805,31844,35449,35522,22558,22974,24086,25463,29266,30090,30571,35548,36028,36626,24307,26228,28152,32893,33729,35531,38737,39894,64e3,21059,26367,28053,28399,32224,35558,36910,36958,39636,21021,21119,21736,24980,25220,25307,26786,26898,26970,27189,28818,28966,30813,30977,30990,31186,31245,32918,33400,33493,33609,34121,35970,36229,37218,37259,37294,20419,22225,29165,30679,34560,35320,23544,24534,26449,37032,21474,22618,23541,24740,24961,25696,32317,32880,34085,37507,25774,20652,23828,26368,22684,25277,25512,26894,27e3,27166,28267,30394,31179,33467,33833,35535,36264,36861,37138,37195,37276,37648,37656,37786,38619,39478,39949,19985,30044,31069,31482,31569,31689,32302,33988,36441,36468,36600,36880,26149,26943,29763,20986,26414,40668,20805,24544,27798,34802,34909,34935,24756,33205,33795,36101,21462,21561,22068,23094,23601,28810,32736,32858,33030,33261,36259,37257,39519,40434,20596,20164,21408,24827,28204,23652,20360,20516,21988,23769,24159,24677,26772,27835,28100,29118,30164,30196,30305,31258,31305,32199,32251,32622,33268,34473,36636,38601,39347,40786,21063,21189,39149,35242,19971,26578,28422,20405,23522,26517,27784,28024,29723,30759,37341,37756,34756,31204,31281,24555,20182,21668,21822,22702,22949,24816,25171,25302,26422,26965,33333,38464,39345,39389,20524,21331,21828,22396,64001,25176,64002,25826,26219,26589,28609,28655,29730,29752,35351,37944,21585,22022,22374,24392,24986,27470,28760,28845,32187,35477,22890,33067,25506,30472,32829,36010,22612,25645,27067,23445,24081,28271,64003,34153,20812,21488,22826,24608,24907,27526,27760,27888,31518,32974,33492,36294,37040,39089,64004,25799,28580,25745,25860,20814,21520,22303,35342,24927,26742,64005,30171,31570,32113,36890,22534,27084,33151,35114,36864,38969,20600,22871,22956,25237,36879,39722,24925,29305,38358,22369,23110,24052,25226,25773,25850,26487,27874,27966,29228,29750,30772,32631,33453,36315,38935,21028,22338,26495,29256,29923,36009,36774,37393,38442,20843,21485,25420,20329,21764,24726,25943,27803,28031,29260,29437,31255,35207,35997,24429,28558,28921,33192,24846,20415,20559,25153,29255,31687,32232,32745,36941,38829,39449,36022,22378,24179,26544,33805,35413,21536,23318,24163,24290,24330,25987,32954,34109,38281,38491,20296,21253,21261,21263,21638,21754,22275,24067,24598,25243,25265,25429,64006,27873,28006,30129,30770,32990,33071,33502,33889,33970,34957,35090,36875,37610,39165,39825,24133,26292,26333,28689,29190,64007,20469,21117,24426,24915,26451,27161,28418,29922,31080,34920,35961,39111,39108,39491,21697,31263,26963,35575,35914,39080,39342,24444,25259,30130,30382,34987,36991,38466,21305,24380,24517,27852,29644,30050,30091,31558,33534,39325,20047,36924,19979,20309,21414,22799,24264,26160,27827,29781,33655,34662,36032,36944,38686,39957,22737,23416,34384,35604,40372,23506,24680,24717,26097,27735,28450,28579,28698,32597,32752,38289,38290,38480,38867,21106,36676,20989,21547,21688,21859,21898,27323,28085,32216,33382,37532,38519,40569,21512,21704,30418,34532,38308,38356,38492,20130,20233,23022,23270,24055,24658,25239,26477,26689,27782,28207,32568,32923,33322,64008,64009,38917,20133,20565,21683,22419,22874,23401,23475,25032,26999,28023,28707,34809,35299,35442,35559,36994,39405,39608,21182,26680,20502,24184,26447,33607,34892,20139,21521,22190,29670,37141,38911,39177,39255,39321,22099,22687,34395,35377,25010,27382,29563,36562,27463,38570,39511,22869,29184,36203,38761,20436,23796,24358,25080,26203,27883,28843,29572,29625,29694,30505,30541,32067,32098,32291,33335,34898,64010,36066,37449,39023,23377,31348,34880,38913,23244,20448,21332,22846,23805,25406,28025,29433,33029,33031,33698,37583,38960,20136,20804,21009,22411,24418,27842,28366,28677,28752,28847,29074,29673,29801,33610,34722,34913,36872,37026,37795,39336,20846,24407,24800,24935,26291,34137,36426,37295,38795,20046,20114,21628,22741,22778,22909,23733,24359,25142,25160,26122,26215,27627,28009,28111,28246,28408,28564,28640,28649,28765,29392,29733,29786,29920,30355,31068,31946,32286,32993,33446,33899,33983,34382,34399,34676,35703,35946,37804,38912,39013,24785,25110,37239,23130,26127,28151,28222,29759,39746,24573,24794,31503,21700,24344,27742,27859,27946,28888,32005,34425,35340,40251,21270,21644,23301,27194,28779,30069,31117,31166,33457,33775,35441,35649,36008,38772,64011,25844,25899,30906,30907,31339,20024,21914,22864,23462,24187,24739,25563,27489,26213,26707,28185,29029,29872,32008,36996,39529,39973,27963,28369,29502,35905,38346,20976,24140,24488,24653,24822,24880,24908,26179,26180,27045,27841,28255,28361,28514,29004,29852,30343,31681,31783,33618,34647,36945,38541,40643,21295,22238,24315,24458,24674,24724,25079,26214,26371,27292,28142,28590,28784,29546,32362,33214,33588,34516,35496,36036,21123,29554,23446,27243,37892,21742,22150,23389,25928,25989,26313,26783,28045,28102,29243,32948,37237,39501,20399,20505,21402,21518,21564,21897,21957,24127,24460,26429,29030,29661,36869,21211,21235,22628,22734,28932,29071,29179,34224,35347,26248,34216,21927,26244,29002,33841,21321,21913,27585,24409,24509,25582,26249,28999,35569,36637,40638,20241,25658,28875,30054,34407,24676,35662,40440,20807,20982,21256,27958,33016,40657,26133,27427,28824,30165,21507,23673,32007,35350,27424,27453,27462,21560,24688,27965,32725,33288,20694,20958,21916,22123,22221,23020,23305,24076,24985,24984,25137,26206,26342,29081,29113,29114,29351,31143,31232,32690,35440,0],
t.euckrToUTF8=function(r){var a,n=[];for(a=0;a<r.length;++a){var s,i;if(s=r.charCodeAt(a),s>=0&&128>s)n.push(String.fromCharCode(s));else{var o,c=0;a++,i=r.charCodeAt(a),c=94*(s-161)+i-161,0>c||t.tableKSC5601.length<c?(o="?",e.console.log("unknown euckr code ("+s+":"+i+")")):o=t.tableKSC5601[c],n.push(String.fromCharCode(o))}}return n.join("")},t.decodeEUCKR=function(r){var a,n=[];for(a=0;a<r.length;++a){var s,i;if(s=r.charCodeAt(a),s>=0&&128>s)n.push(String.fromCharCode(s));else{var o,c=0;a++,i=r.charCodeAt(a),c=94*(s-161)+i-161,0>c||t.tableKSC5601.length<c?(o="?",e.console.log("unknown euckr code ("+s+":"+i+")")):o=t.tableKSC5601[c],n.push(String.fromCharCode(o))}}return n.join("")},t.encodeEUCKR=function(r){var a,n=[];for(a=0;a<r.length;++a){var s,i,o;if(s=r.charCodeAt(a),s>=0&&128>s)n.push(String.fromCharCode(s));else{var c,u=0;if(u=t.tableKSC5601.indexOf(s),-1==u){e.console.log("unknown euckr code ("+s+")"),n.push("?");continue}c=Math.floor(u/94),i=c+161,o=u-94*c+161,n.push(String.fromCharCode(i)),n.push(String.fromCharCode(o))}}return n.join("")},t.bytesToHex=function(e){for(var t,r=[],a=0;a<e.length;++a){t="";var n=e.charCodeAt(a);16>n&&(t="0"),t+=n.toString(16),r.push(t)}return r.join("")},t.hexToBytes=function(e){var t=[],r=0;for(e.length&!0&&(r=1,t.push(String.fromCharCode(parseInt(e[0],16))));r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},t.encodeUTF8=function(t){return e.util.encodeUtf8(t)},t.decodeUTF8=function(t){return e.util.decodeUtf8(t)};var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];t.encode64=function(e,t){for(var a,n,s,i="",o="",c=0;c<e.length;)a=e.charCodeAt(c++),n=e.charCodeAt(c++),s=e.charCodeAt(c++),i+=r.charAt(a>>2),i+=r.charAt((3&a)<<4|n>>4),isNaN(n)?i+="==":(i+=r.charAt((15&n)<<2|s>>6),i+=isNaN(s)?"=":r.charAt(63&s)),t&&i.length>t&&(o+=i.substr(0,t)+"\r\n",i=i.substr(t));return o+=i},t.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,r,n,s,i="",o=0;o<e.length;)t=a[e.charCodeAt(o++)-43],r=a[e.charCodeAt(o++)-43],n=a[e.charCodeAt(o++)-43],s=a[e.charCodeAt(o++)-43],i+=String.fromCharCode(t<<2|r>>4),64!==n&&(i+=String.fromCharCode((15&r)<<4|n>>2),64!==s&&(i+=String.fromCharCode((3&n)<<6|s)));return i},t.isUTF16String=function(e){var t;for(t=0;t<e.length;++t)if(e.charCodeAt(t)>256)return!0;return!1};var n;n=window.crypto||window.msCrypto}var a="util";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);r=function(e,r){r(t,module)}}var n,s=function(t,r){r.exports=function(r){var s=n.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a]&&r[a].promise)return r[a];for(var i=0;i<s.length;++i)void 0!==s[i]&&s[i](r);return r[a]}},i=r;(r=function(e,t){return n="string"==typeof e?t.slice(2):e.slice(2),r=i,r.apply(null,Array.prototype.slice.call(arguments,0))})("js/jsrose_extension",["require","module","./jsrose_forge_util"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e._asn1,r=e.pki,a=e.oids,n=e.util,s=e.kisa,i={};i.CertId={},i.CertId.toAsn1=function(a){var n,s;return n=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),n.value.push(r.GeneralName.toAsn1(a.issuer)),s=e.util.hexToBytes(a.serialNumber),n.value.push(t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,s)),n},i.AttributeTypeAndValue={},i.AttributeTypeAndValue.toAsn1=function(r){var a,n;switch(a=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),a.value.push(t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.type).getBytes())),r.type){case s.EncryptedVID.oid:n=s.EncryptedVID.toAsn1(r.value);break;case e.oids.oldCertId:n=i.CertId.toAsn1(r.value);break;default:n=r.value}return a.value.push(n),a},i.CertResponse={},i.CertResponse.toObject=function(e,r){var a={};return a.certReqId=t.derToInteger(e.value[0].value),a.status=cmp.PKIStatusInfo.toObject(e.value[1],r),e.value.length>2&&(a.certifiedKeyPair=cmp.CertifiedKeyPair.toObject(e.value[2])),e.value.length>3&&(a.rspInfo=e.value[3].value),a},i.CertRequest={},i.CertRequest.toAsn1=function(e){var r;return r=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(e.certReqId).getBytes()),i.CertTemplate.toAsn1(e.certTemplate)]),e.hasOwnProperty("controls")&&r.value.push(i.Controls.toAsn1(e.controls)),r},i.CertTemplate={},i.CertTemplate.toAsn1=function(a){var n;if(n=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),a.hasOwnProperty("version")&&n.value.push(t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(a.version).getBytes())])),a.hasOwnProperty("serialNumber")){var s;s=e.util.hexToBytes(a.serialNumber),n.value.push(t.create(t.Class.CONTEXT_SPECIFIC,1,!1,s))}if(a.hasOwnProperty("signingAlg")&&n.value.push(t.create(t.Class.CONTEXT_SPECIFIC,2,!0,[r.AlgorithmIdentifier.toAsn1(a.signingAlg)])),a.hasOwnProperty("issuer")&&n.value.push(t.create(t.Class.CONTEXT_SPECIFIC,3,!0,[r.distinguishedNameToAsn1(a.issuer)])),a.hasOwnProperty("validity")&&n.value.push(t.create(t.Class.CONTEXT_SPECIFIC,4,!0,[r.Validity.toAsn1(a.validity)])),a.hasOwnProperty("subject")&&n.value.push(t.create(t.Class.CONTEXT_SPECIFIC,5,!0,[r.distinguishedNameToAsn1(a.subject)])),a.hasOwnProperty("publicKey")&&n.value.push(t.create(t.Class.CONTEXT_SPECIFIC,6,!0,[a.publicKey.value[0],a.publicKey.value[1]])),a.hasOwnProperty("issuerUID")&&n.value.push(t.create(t.Class.CONTEXT_SPECIFIC,7,!0,[t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,String.fromCharCode(0)+a.issuerUID)])),a.hasOwnProperty("subjectUID")&&n.value.push(t.create(t.Class.CONTEXT_SPECIFIC,8,!0,[t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,String.fromCharCode(0)+a.subjectUID)])),a.hasOwnProperty("extentions"))throw"not implemented";return n},i.EncryptedValue={},i.EncryptedValue.toObject=function(e){var r={};return e.value.forEach(function(e){if(e.tagClass==t.Class.CONTEXT_SPECIFIC)switch(e.type){case 2:r.encSymmKey=e.value.substring(1,e.value.length);break;default:throw"unknown EncryptedValue contextID"+e.type}else r.encValue=e.value.substring(1,e.value.length)}),r},i.PBMParameter={},i.PBMParameter.toAsn1=function(e){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTET_STRING,e.salt),r.AlgorithmIdentifier.toAsn1(e.owf)])},i.POPOSigningKeyInput={},i.POPOSigningKeyInput.toAsn1=function(e){var a,n;if(a=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),!("authInfo"in e))throw"authInfo does not exist";if("sender"in e.authInfo)n=t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[r.GeneralName.toAsn1(e.authInfo.sender)]);else{if(!("publicKeyMAC"in e.authInfo))throw"no choice for authInfo";n=i.PKMACValue.toAsn1(e.authInfo.publicKeyMAC)}return a.value.push(n),a.value.push(e.publicKey),a},i.POPOSigningKey={},i.POPOSigningKey.toAsn1=function(e){var a;return a=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),"poposkInput"in e&&a.value.push(t.create(t.Class.CONTEXT_SPECIFIC,0,!0,i.POPOSigningKeyInput.toAsn1(e.poposkInput).value)),a.value.push(r.AlgorithmIdentifier.toAsn1(e.algorithmIdentifier)),a.value.push(t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)),a},i.ProofOfPossession={},i.ProofOfPossession.toAsn1=function(e){var r,a=0;if("raVerified"in e)a=0,r=[t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")];else if("signature"in e)a=1,r=i.POPOSigningKey.toAsn1(e.signature).value;else if("keyEncipherment"in e)a=2,r=e.keyEncipherment;else{if(!("keyAgreement"in e))throw"proofOfPossession does not have any choice.";a=3,r=e.keyAgreement}return t.create(t.Class.CONTEXT_SPECIFIC,a,!0,r)},i.RevDetails={},i.RevDetails.toAsn1=function(e){var r;return r=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[i.CertTemplate.toAsn1(e.certDetails)]),e.hasOwnProperty("revocationReason")&&r.value.push(t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,String.fromCharCode(7)+e.revocationReason)),r},i.RevRepContent={},i.RevRepContent.toObject=function(e,t){var r={};return r.status=[],e.value[0].value.forEach(function(e){r.status.push(cmp.PKIStatusInfo.toObject(e,t))}),r},i.CertReqMsg={},i.CertReqMsg.toAsn1=function(e){var r;return r=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[i.CertRequest.toAsn1(e.certReq)]),"popo"in e&&r.value.push(i.ProofOfPossession.toAsn1(e.popo)),"regInfo"in e&&null!=e.regInfo&&r.value.push(i.RegInfo.toAsn1(e.regInfo)),r},i.SubsequentMessage={},i.SubsequentMessage.encrCert=0,i.SubsequentMessage.challengeResp=1,i.PKMACValue={},i.PKMACValue.toAsn1=function(e){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[r.AlgorithmIdentifier.toAsn1(e.algId),t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,String.fromCharCode(0)+e.value)])},i.POPOPrivKey={},i.POPOPrivKey.toAsn1=function(e){var r,a;if("thisMessage"in e)a=0;else if("subsequentMessage"in e)a=1;else if("dhMAC"in e)a=2;else{if(!("agreeMAC"in e))throw"encryptedKey"in e?(a=4,'not support entry "encryptedKey" in POPOPrivKey'):"cannot found any supported entry in POPOPrivKey";a=3,r=i.PKMACValue.toAsn1(e.agreeMAC)}return t.create(t.Class.CONTEXT_SPECIFIC,a,!0,[r])},i.RegInfo={},i.RegInfo.toAsn1=function(e){var r;return r=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),e.forEach(function(e){r.value.push(i.AttributeTypeAndValue.toAsn1(e))}),r},i.Controls={},i.Controls.toAsn1=function(e){var r;return r=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),e.forEach(function(e){r.value.push(i.AttributeTypeAndValue.toAsn1(e))}),r},i.CertRequestValidator={name:"CertRequest",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,value:[{name:"CertRequest.certReqId",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1}]};({directoryName:{attributes:[{type:a.countryName,value:"KR"},{type:a.commonName,value:"haha"}]}});oid={},oid.id_it="1.3.6.1.5.5.7.4",oid.id_it_caProtEncCert=oid.id_it+".1",cmp=e.cmp=e.cmp||{},cmp.oids={},cmp.oids.it_ca_ProtEncCert="1.3.6.1.5.5.7.4.1",cmp.CertifiedKeyPair={},cmp.CertifiedKeyPair.toObject=function(e){var t={};if(t.certOrEncCert=cmp.CertOrEncCert.toObject(e.value[0]),e.value.length>1)throw"this message has not supported entries in CertifiedKeyPair.";return t},cmp.CertOrEncCert={},cmp.CertOrEncCert.toObject=function(e){var t={};return 0==e.type?t.certificate=r.certificateFromAsn1(e.value[0]):t.encryptedCert=i.EncryptedValue.toObject(e.value[0]),t},i.CertRepMessage={},i.CertRepMessage.toObject=function(e,t){var a,n,s=[];return a=e.value[0],n=e.value[0],1==a.type&&(s.caPubs=[],a=a.value[0],a.value.forEach(function(e){s.caPubs.push(r.certificateFromAsn1(e))}),n=e.value[1]),s.response=[],n.value.forEach(function(e){s.response.push(i.CertResponse.toObject(e,t))}),s},cmp.oid=oid,cmp.ErrorMsgContent={},cmp.ErrorMsgContent.toObject=function(e,t){var r={};return r.pKIStatusInfo=cmp.PKIStatusInfo.toObject(e.value[0],t),e.value.length>1&&(r.errorCode=e.value[1].value.charCodeAt(0)),e.value.length>2&&(r.errorDetails=cmp.PKIFreeText.toObject(e.value[2],t)),r},cmp.GenRepContent={},cmp.GenRepContent.toObject=function(e){var t=[];return e.value.forEach(function(e){t.push(cmp.InfoTypeAndValue.toObject(e))}),t},cmp.InfoTypeAndValue={},cmp.InfoTypeAndValue.toAsn1=function(e){var r,a;switch(r=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),a=t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(e.infoType).getBytes()),r.value.push(a),e.infoType){case oid.id_it_caProtEncCert:a=void 0;break;default:throw"not supported oid for InfoTypeAndValue"}return r.value.push(a),r},cmp.InfoTypeAndValue.toObject=function(e){var r={};return r.infoType=t.derToOid(e.value[0].value),e.value.length>1&&(r.infoValue=t.toDer(e.value[1])),r},cmp.PKIBody={},cmp.PKIBody.toAsn1=function(e){var r,a,n;if(e.hasOwnProperty("ir"))a=e.ir,n=0,r=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),a.forEach(function(e){r.value.push(i.CertReqMsg.toAsn1(e))});else if(e.hasOwnProperty("kur"))a=e.kur,n=7,r=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),a.forEach(function(e){r.value.push(i.CertReqMsg.toAsn1(e))});else if(e.hasOwnProperty("rr"))a=e.rr,n=11,r=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),a.forEach(function(e){r.value.push(i.RevDetails.toAsn1(e))});else if(e.hasOwnProperty("conf"))a=e.conf,n=19,r=t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"");else{if(!e.hasOwnProperty("genm"))throw"not supported PKIBody type";a=e.genm,n=21,r=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),void 0!=a&&a.forEach(function(e){r.value.push(cmp.InfoTypeAndValue.toAsn1(e))})}return t.create(t.Class.CONTEXT_SPECIFIC,n,!0,[r])},cmp.PKIBody.toObject=function(t,r){var a={};switch(t.type){case 1:a.ip=i.CertRepMessage.toObject(t.value[0],r);break;case 8:a.kup=i.CertRepMessage.toObject(t.value[0],r);break;case 12:a.rp=i.RevRepContent.toObject(t.value[0],r);break;case 22:a.genp=e.cmp.GenRepContent.toObject(t.value[0]);break;case 23:a.error=e.cmp.ErrorMsgContent.toObject(t.value[0],r);break;default:throw"not supported CMP message type:"+t.type}return a},cmp.PKIFailureInfo={},cmp.PKIFailureInfo.toObject=function(e){return 0},cmp.PKIFreeText={},cmp.PKIFreeText.toAsn1=function(e){var r,a;return r=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),e.forEach(function(e){a=t.create(t.Class.UNIVERSAL,t.Type.UTF8,!1,n.encodeUtf8(e)),r.value.push(a)}),r},cmp.PKIFreeText.toObject=function(t,r){var a,n=[];return t.value.forEach(function(t){a=t.value,a="undefined"!=typeof r&&1==r?e.util.decodeEUCKR(a):e.util.decodeUTF8(a),n.push(a)}),n},cmp.PKIHeader={},cmp.PKIHeader.cmp1999=1,cmp.PKIHeader.cmp2000=2,cmp.PKIHeader.toAsn1=function(e){var a,n;return a=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(e.pvno).getBytes()),r.GeneralName.toAsn1(e.sender),r.GeneralName.toAsn1(e.recipient)]),"messageTime"in e&&(n=t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.GENERALIZEDTIME,!1,t.dateToGeneralizedTime(e.messageTime))]),a.value.push(n)),"protectionAlg"in e&&(n=t.create(t.Class.CONTEXT_SPECIFIC,1,!0,[r.AlgorithmIdentifier.toAsn1(e.protectionAlg)]),a.value.push(n)),"senderKID"in e&&(n=t.create(t.Class.CONTEXT_SPECIFIC,2,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,e.senderKID)]),a.value.push(n)),"recipKID"in e&&(n=t.create(t.Class.CONTEXT_SPECIFIC,3,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,e.recipKID)]),a.value.push(n)),"transactionID"in e&&(n=t.create(t.Class.CONTEXT_SPECIFIC,4,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,e.transactionID)]),a.value.push(n)),"senderNonce"in e&&(n=t.create(t.Class.CONTEXT_SPECIFIC,5,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,e.senderNonce)]),a.value.push(n)),"recipNonce"in e&&(n=t.create(t.Class.CONTEXT_SPECIFIC,6,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,e.recipNonce)]),a.value.push(n)),"freeText"in e&&(n=t.create(t.Class.CONTEXT_SPECIFIC,7,!0,[cmp.PKIFreeText.toAsn1(e.freeText)]),a.value.push(n)),"generalInfo"in e&&(n=t.create(t.Class.CONTEXT_SPECIFIC,8,!0,[cmp.PKIFreeText.toAsn1(e.freeText)]),a.value.push(n)),a},cmp.PKIHeader.toObject=function(e,t){var r,a,n={};for(n.pvno=e.value[0].value.charCodeAt(0),n.sender=e.value[1].value,n.recipient=e.value[2].value,r=3;r<e.value.length;++r)switch(a=e.value[r],a.type){case 7:n.freeText=cmp.PKIFreeText.toObject(a.value[0],t)}return n},cmp.PKIMessage={},cmp.PKIMessage.toAsn1=function(e){var r;if(r=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[cmp.PKIHeader.toAsn1(e.header),cmp.PKIBody.toAsn1(e.body)]),"protection"in e){var a;a=t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,String.fromCharCode(0)+e.protection),a=t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[a]),r.value.push(a)}return r},cmp.PKIMessage.toObject=function(e,t){var r={};return r.header=cmp.PKIHeader.toObject(e.value[0],t),r.body=cmp.PKIBody.toObject(e.value[1],t),r},cmp.PKIStatus={},cmp.PKIStatus.accepted=0,cmp.PKIStatus.grantedWithMods=1,cmp.PKIStatus.rejection=2,cmp.PKIStatus.waiting=3,cmp.PKIStatus.revocationWarning=4,cmp.PKIStatus.revocationNotification=5,cmp.PKIStatus.keyUpdateWarning=6,cmp.PKIStatusInfo={},cmp.PKIStatusInfo.toObject=function(e,t){var r={},a="";switch(r.status=e.value[0].value.charCodeAt(0),e.value.length>1&&(r.statusString=cmp.PKIFreeText.toObject(e.value[1],t)),e.value.length>2&&(r.failInfo=cmp.PKIFailureInfo.toObject(e.value[2])),r.status){case cmp.PKIStatus.accepted:a="granted";case cmp.PKIStatus.grantedWithMods:a="grantedWithMods";case cmp.PKIStatus.rejection:a="rejection";case cmp.PKIStatus.waiting:a="waiting";case cmp.PKIStatus.revocationWarning:a="revocationWarning";case cmp.PKIStatus.revocationNotification:a="revocationNotification";case cmp.PKIStatus.keyUpdateWarning:a="keyUpdateWarning"}return r.asnReason=a,r},cmp.ProtectedPart={},cmp.ProtectedPart.toAsn1=function(e){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[cmp.PKIHeader.toAsn1(e.header),cmp.PKIBody.toAsn1(e.body)])},e.crmf=i,e.cmp=cmp}var a="cmp";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);r=function(e,r){r(t,module)}}var n,s=function(t,r){r.exports=function(r){var s=n.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];for(var i=0;i<s.length;++i)s[i](r);return r[a]}},i=r;(r=function(e,t){return n="string"==typeof e?t.slice(2):e.slice(2),r=i,r.apply(null,Array.prototype.slice.call(arguments,0))})("js/jsrose_cmpasn1",["require","module"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e._asn1,r=e.pki,a=e.oids,n=e.pkcs5||{},s={name:"PBES2Algorithms",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,onstructed:!0,capture:"kdfIterationCount"}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},i=function(e,t,r){var a,n;a=ytcrypto.md.sha1.create(),a.update(e),a.update(t),n=a.digest().getBytes();for(var s=1;r>s;++s)a.start(),a.update(n),n=a.digest().getBytes();return n};getCipherForSEED=function(e,r,a,n){var s,o,c,u,l,p,d=16,f=16,y="CBC";s=r.value[0].value,o=t.derToInteger(r.value[1].value),c=i(a,s,o),u=c.substr(0,d),l=ytcrypto.md.sha1.create().update(c.substr(d)).digest().getBytes().substr(0,f),p=n?ytcrypto.seed.createEncryptionCipher:ytcrypto.seed.createDecryptionCipher;var C=p(u,y);return C.start(l),C},getCipherForPBES2=function(a,n,i){var o={},c=[];if(!t.validate(n,s,o,c))throw{message:"Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.",errors:c};if(a=t.derToOid(o.kdfOid),a!==r.oids.pkcs5PBKDF2)throw{message:"Cannot read encrypted private key. Unsupported key derivation function OID.",oid:a,supportedOids:["pkcs5PBKDF2"]};if(a=t.derToOid(o.encOid),a!==r.oids["aes128-CBC"]&&a!==r.oids["aes192-CBC"]&&a!==r.oids["aes256-CBC"]&&a!==r.oids["des-EDE3-CBC"]&&a!==r.oids.desCBC&&a!==r.oids.seedCBC)throw{message:"Cannot read encrypted private key. Unsupported encryption scheme OID.",oid:a,supportedOids:["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC","seedCBC"]};var u=o.kdfSalt,l=e.util.createBuffer(o.kdfIterationCount);l=l.getInt(l.length()<<3);var p,d;switch(r.oids[a]){case"aes128-CBC":p=16,d=ytcrypto.aes.createDecryptionCipher;break;case"aes192-CBC":p=24,d=ytcrypto.aes.createDecryptionCipher;break;case"aes256-CBC":p=32,d=ytcrypto.aes.createDecryptionCipher;break;case"des-EDE3-CBC":p=24,d=ytcrypto.des.createDecryptionCipher;break;case"desCBC":p=8,d=ytcrypto.des.createDecryptionCipher;break;case"seedCBC":p=16,d=ytcrypto.seed.createDecryptionCipher}var f=e.pkcs5.pbkdf2(i,u,l,p),y=o.encIv,C=d(f);return C.start(y),C};var o=function(e,t,a,n){switch(e){case r.oids.pkcs5PBES2:return getCipherForPBES2(e,t,a);case r.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case r.oids["pbewithSHAAnd40BitRC2-CBC"]:return r.pbe.getCipherForPKCS12PBE(e,t,a);case r.oids.seedCBCWithSHA1:return getCipherForSEED(e,t,a,n);default:throw{message:"Cannot read encrypted PBE data block. Unsupported OID.",oid:e,supportedOids:["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC","seedCBCWithSHA1"]}}};n.encrypt=function(r,n,s,i,c){void 0===s&&(s="seedCBCWithSHA1"),void 0===i&&(i=ytcrypto.random.getBytes(8)),void 0===c&&(c=2048);var u,l=a[s];u=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,i),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(c).getBytes())]);var p=o(l,u,n,!0);p.update(e.util.createBuffer(r)),p.finish();var d;return d=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),d.value.push(t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(l).getBytes()),u])),d.value.push(t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,p.output.getBytes())),e.asn1.fromRaw(d)},n.decrypt=function(r,a,n,s){var i=null,a=t.derToOid(a),c=o(a,n,r,!1),u=e.util.createBuffer(s);return c.update(u),c.finish()&&(i=e.asn1.fromDer(c.output)),i},e.pkcs5=n}var a="pkcs5";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);r=function(e,r){r(t,module)}}var n,s=function(t,r){r.exports=function(r){var s=n.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<s.length;++i)void 0!==s[i]&&s[i](r);return r[a]}},i=r;(r=function(e,t){return n="string"==typeof e?t.slice(2):e.slice(2),r=i,r.apply(null,Array.prototype.slice.call(arguments,0))})("js/jsrose_pkcs5",["require","module","./jsrose_asn1","./jsrose_extension"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(e,t,r,a){for(var n=[],s=0;s<e.length;s++)for(var i=0;i<e[s].safeBags.length;i++){var o=e[s].safeBags[i];void 0!==a&&o.type!==a||void 0!==o.attributes[t]&&o.attributes[t].indexOf(r)>=0&&n.push(o)}return n}function r(e,t,r,s){if(t=i.fromDer(t,r),t.tagClass!==i.Class.UNIVERSAL||t.type!==i.Type.SEQUENCE||t.constructed!==!0)throw{message:"PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo"};for(var c=0;c<t.value.length;c++){var l=t.value[c],p={},d=[];if(!i.validate(l,u,p,d))throw{message:"Cannot read ContentInfo.",errors:d};var f={encrypted:!1},y=null,C=p.content.value[0];switch(i.derToOid(p.contentType)){case o.oids.data:if(C.tagClass!==i.Class.UNIVERSAL||C.type!==i.Type.OCTETSTRING)throw{message:"PKCS#12 SafeContents Data is not an OCTET STRING."};y=C.value;break;case o.oids.encryptedData:if(void 0===s)throw{message:"Found PKCS#12 Encrypted SafeContents Data but no password available."};y=a(C,s),f.encrypted=!0;break;default:throw{message:"Unsupported PKCS#12 contentType.",contentType:i.derToOid(p.contentType)}}f.safeBags=n(y,r,s),e.safeContents.push(f)}}function a(t,r){var a={},n=[];if(!i.validate(t,e.pkcs7.asn1.encryptedDataValidator,a,n))throw{message:"Cannot read EncryptedContentInfo. ",errors:n};var s=i.derToOid(a.contentType);if(s!==o.oids.data)throw{message:"PKCS#12 EncryptedContentInfo ContentType is not Data.",oid:s};s=i.derToOid(a.encAlgorithm);var c=o.pbe.getCipher(s,a.encParameter,r),u=e.util.createBuffer(a.encryptedContent);if(c.update(u),!c.finish())throw{message:"Failed to decrypt PKCS#12 SafeContents."};return c.output.getBytes()}function n(e,t,r){if(e=i.fromDer(e,t),e.tagClass!==i.Class.UNIVERSAL||e.type!==i.Type.SEQUENCE||e.constructed!==!0)throw{message:"PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag"};for(var a=[],n=0;n<e.value.length;n++){var c=e.value[n],u={},l=[];if(!i.validate(c,p,u,l))throw{message:"Cannot read SafeBag.",errors:l};var d={type:i.derToOid(u.bagId),attributes:s(u.bagAttributes)};a.push(d);var y,C,g=u.bagValue.value[0];switch(d.type){case o.oids.pkcs8ShroudedKeyBag:if(void 0===r)throw{message:"Found PKCS#8 ShroudedKeyBag but no password available."};if(g=o.decryptPrivateKeyInfo(g,r),null===g)throw{message:"Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?"};case o.oids.keyBag:d.key=o.privateKeyFromAsn1(g);continue;case o.oids.certBag:y=f,C=function(){if(i.derToOid(u.certId)!==o.oids.x509Certificate)throw{message:"Unsupported certificate type, only X.509 supported.",oid:i.derToOid(u.certId)};d.cert=o.certificateFromAsn1(i.fromDer(u.cert,t),!0)};break;default:throw{message:"Unsupported PKCS#12 SafeBag type.",oid:d.type}}if(void 0!==y&&!i.validate(g,y,u,l))throw{message:"Cannot read PKCS#12 "+y.name,errors:l};C()}return a}function s(e){var t={};if(void 0!==e)for(var r=0;r<e.length;++r){var a={},n=[];if(!i.validate(e[r],d,a,n))throw{message:"Cannot read PKCS#12 BagAttribute.",errors:n};var s=i.derToOid(a.oid);if(void 0!==o.oids[s]){t[o.oids[s]]=[];for(var c=0;c<a.values.length;++c)t[o.oids[s]].push(a.values[c].value)}}return t}var i=e.asn1,o=e.pki,c=e.pkcs12=e.pkcs12||{},u={name:"ContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},l={name:"PFX",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},u,{name:"PFX.macData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:i.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},p={name:"SafeBag",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},d={name:"Attribute",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,capture:"values"}]},f={name:"CertBag",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:i.Class.UNIVERSAL,type:i.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};c.pkcs12FromAsn1=function(a,n,s){"string"==typeof n?(s=n,n=!0):void 0===n&&(n=!0);var u={},p=[];if(!i.validate(a,l,u,p))throw{message:"Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.",errors:p};var d={version:u.version.charCodeAt(0),safeContents:[],getBags:function(r){var a,n={};return"localKeyId"in r?a=r.localKeyId:"localKeyIdHex"in r&&(a=e.util.hexToBytes(r.localKeyIdHex)),void 0!==a&&(n.localKeyId=t(d.safeContents,"localKeyId",a,r.bagType)),"friendlyName"in r&&(n.friendlyName=t(d.safeContents,"friendlyName",r.friendlyName,r.bagType)),n},getBagsByFriendlyName:function(e,r){return t(d.safeContents,"friendlyName",e,r)},getBagsByLocalKeyId:function(e,r){return t(d.safeContents,"localKeyId",e,r)}};if(3!==u.version.charCodeAt(0))throw{message:"PKCS#12 PFX of version other than 3 not supported.",version:u.version.charCodeAt(0)};if(i.derToOid(u.contentType)!==o.oids.data)throw{message:"Only PKCS#12 PFX in password integrity mode supported.",oid:i.derToOid(u.contentType)};var f=u.content.value[0];if(f.tagClass!==i.Class.UNIVERSAL||f.type!==i.Type.OCTETSTRING)throw{message:"PKCS#12 authSafe content data is not an OCTET STRING."};if(u.mac){var y=null,C=0,g=i.derToOid(u.macAlgorithm);switch(g){case o.oids.sha1:y=ytcrypto.md.sha1.create(),C=20;break;case o.oids.sha256:y=ytcrypto.md.sha256.create(),C=32;break;case o.oids.sha384:y=ytcrypto.md.sha384.create(),C=48;break;case o.oids.sha512:y=ytcrypto.md.sha512.create(),C=64;break;case o.oids.md5:y=ytcrypto.md.md5.create(),C=16}if(null===y)throw{message:"PKCS#12 uses unsupported MAC algorithm: "+g};var h=new e.util.ByteBuffer(u.macSalt),m="macIterations"in u?parseInt(e.util.bytesToHex(u.macIterations),16):1,E=c.generateKey(s||"",h,3,m,C,y),v=e.hmac.create();v.start(y,E),v.update(f.value);var I=v.getMac();if(I.getBytes()!==u.macDigest)throw{message:"PKCS#12 MAC could not be verified. Invalid password?"}}return r(d,f.value,n,s),d},c.toPkcs12Asn1=function(t,r,a,n){n=n||{},n.saltSize=n.saltSize||8,n.count=n.count||2048,n.algorithm=n.algorithm||n.encAlgorithm||"aes128","useMac"in n||(n.useMac=!0),"localKeyId"in n||(n.localKeyId=null),"generateLocalKeyId"in n||(n.generateLocalKeyId=!0);var s,u=n.localKeyId;if(null!==u)u=e.util.hexToBytes(u);else if(n.generateLocalKeyId)if(r){var l=e.util.isArray(r)?r[0]:r;"string"==typeof l&&(l=o.certificateFromPem(l));var p=ytcrypto.md.sha1.create();p.update(i.toDer(o.certificateToAsn1(l)).getBytes()),u=p.digest().getBytes()}else u=ytcrypto.random.getBytes(20);var d=[];null!==u&&d.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.localKeyId).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,u)])])),"friendlyName"in n&&d.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.friendlyName).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.BMPSTRING,!1,n.friendlyName)])])),d.length>0&&(s=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,d));var f=[],y=[];null!==r&&(y=e.util.isArray(r)?r:[r]);for(var C=[],g=0;g<y.length;++g){r=y[g],"string"==typeof r&&(r=o.certificateFromPem(r));var h=0===g?s:void 0,m=o.certificateToAsn1(r),E=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.certBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.x509Certificate).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(m).getBytes())])])]),h]);C.push(E)}if(C.length>0){var v=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,C),I=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(v).getBytes())])]);
f.push(I)}var T=null;if(null!==t){var S=o.wrapRsaPrivateKey(o.privateKeyToAsn1(t));T=null===a?i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.keyBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[S]),s]):i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.pkcs8ShroudedKeyBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[o.encryptPrivateKeyInfo(S,a,n)]),s]);var A=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[T]),N=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(A).getBytes())])]);f.push(N)}var R,b=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,f);if(n.useMac){var p=ytcrypto.md.sha1.create(),U=new e.util.ByteBuffer(ytcrypto.random.getBytes(n.saltSize)),B=n.count,t=c.generateKey(a||"",U,3,B,20),P=e.hmac.create();P.start(p,t),P.update(i.toDer(b).getBytes());var O=P.getMac();R=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.sha1).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,O.getBytes())]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,U.getBytes()),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(B).getBytes())])}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(3).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(b).getBytes())])]),R])},c.generateKey=e.pbe.generatePkcs12Key}var a="pkcs12";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);var n=!0;r=function(e,r){r(t,module)}}var s,i=function(t,r){r.exports=function(r){var n=s.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<n.length;++i)n[i](r);return r[a]}},o=r;(r=function(e,t){return s="string"==typeof e?t.slice(2):e.slice(2),n?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/jsrose_forge_pkcs12",["require","module","./jsrose_forge_asn1","./jsrose_forge_oids","./jsrose_forge_pkcs7asn1","./jsrose_forge_pbe","./jsrose_forge_util","./jsrose_forge_x509"],function(){i.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e._asn1,r=e.pki=e.pki||{};r.pemToDer=function(t){var r=e.pem.decode(t)[0];if(r.procType&&"ENCRYPTED"===r.procType.type)throw{message:"Could not convert PEM to DER; PEM is encrypted."};return e.util.createBuffer(r.body)},r.privateKeyFromPem=function(a){var n=e.pem.decode(a)[0];if("PRIVATE KEY"!==n.type&&"RSA PRIVATE KEY"!==n.type)throw{message:'Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".',headerType:n.type};if(n.procType&&"ENCRYPTED"===n.procType.type)throw{message:"Could not convert private key from PEM; PEM is encrypted."};var s=t.fromDer(n.body);return r.privateKeyFromAsn1(s)},r.privateKeyToPem=function(a,n){var s={type:"RSA PRIVATE KEY",body:t.toDer(r.privateKeyToAsn1(a)).getBytes()};return e.pem.encode(s,{maxline:n})},r.privateKeyInfoToPem=function(r,a){var n={type:"PRIVATE KEY",body:t.toDer(r).getBytes()};return e.pem.encode(n,{maxline:a})}}var a="pki";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);var n=!0;r=function(e,r){r(t,module)}}var s,i=function(t,r){r.exports=function(r){var n=s.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<n.length;++i)n[i](r);return r[a]}},o=r;(r=function(e,t){return s="string"==typeof e?t.slice(2):e.slice(2),n?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/jsrose_forge_pki",["require","module","./jsrose_forge_asn1","./jsrose_forge_oids","./jsrose_forge_pbe","./jsrose_forge_pem","./jsrose_forge_pbkdf2","./jsrose_forge_pkcs12","./jsrose_forge_util","./jsrose_forge_x509"],function(){i.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(e){var t=[];return e.attributes.forEach(function(e){var r=t[e.rdnIndex];"undefined"==typeof r?t[e.rdnIndex]=e.shortName+"="+e.value:t[e.rdnIndex]=r+"+"+e.shortName+"="+e.value}),t.reverse().join(",")}function r(e){switch(e.type){case 4:var r=ytcrypto.md.sha1.create(),a=u.RDNAttributesAsArray(e.value[0],r);return t({attributes:a});case 6:return e.value}}function a(t,r){var a,n;r.value.forEach(function(r){r.value instanceof Array&&(a=e._asn1.derToOid(r.value[0].value),"1.2.410.200004.10.1.1"===a&&(n=r.value[1].value[0],t.realName=e.util.decodeUTF8(n.value[0].value)))})}function n(t,a){a.value&&a.value.forEach(function(a){switch(a.type){case 0:t.keyIdentifier=e.util.bytesToHex(a.value);break;case 1:;t.authorityCertIssuer=[],a.value.forEach(function(e){t.authorityCertIssuer.push(r(e))});break;case 2:t.authorityCertSerialNumber=e._asn1.derToInteger(a.value)}})}function s(t){var r;return r={},t.value.forEach(function(t){var a,n;switch(a=e._asn1.derToOid(t.value[0].value)){case"1.2.410.200004.5.4.1.1":n="odinaryPersonal";break;case"1.2.410.200005.1.1.4":n="restrictedPersonalFinancial";break;default:n=a}r[a]={name:n},t.value.length>1&&t.value[1].value.forEach(function(t){var n=e._asn1.derToOid(t.value[0].value);switch(n){case"1.3.6.1.5.5.7.2.1":r[a].CPSuri=t.value[1].value;break;case"1.3.6.1.5.5.7.2.2":r[a].userNotice=[],t.value[1].value.forEach(function(e){r[a].userNotice.push(e.value)})}})}),r}function i(e,t){switch(t.type){case 0:t.value.forEach(function(t){e.push(r(t))});break;case 1:default:console.log("not supported dpname")}}function o(e,t){t.value.forEach(function(t){switch(t.type){case 0:var r=[];i(r,t.value[0]),e.distributionPoint=r;break;default:console.log("not supported dp")}})}function c(e,t){t.value.forEach(function(t){var r={};o(r,t),e.hasOwnProperty("distributionPoints")||(e.distributionPoints=[]),e.distributionPoints.push(r)})}var u;e.pki||(e.pki={}),u=e.pki;var l=function(r,i){var o=this;this._cert=r,this.serialNumber=r.serialNumber,this.issuer=t(r.issuer),this.subject=t(r.subject),this.validity=r.validity,void 0!=i?this.publicKey=i:this.publicKey=new ytcrypto.crypto.key(r.publicKey),this.signature=r.signature,r.extensions&&(this.extensions={},r.extensions.forEach(function(t){var r={};switch(t.id){case e.oids.keyUsage:r.name="keyUsage",r.dataEncipherment=t.dataEncipherment,r.digitalSignature=t.digitalSignature,r.decipherOnly=t.decipherOnly,r.encipherOnly=t.encipherOnly,r.cRLSign=t.cRLSign,r.keyAgreement=t.keyAgreement,r.keyCertSign=t.keyCertSign,r.keyEncipherment=t.keyEncipherment,r.nonRepudiation=t.nonRepudiation;break;case e.oids.extKeyUsage:for(var i in t)"id"!==i&&"value"!==i&&"critical"!==i&&(r[i]=t[i]);break;case e.oids.basicConstraints:r.name="basicConstraints",t.hasOwnProperty("cA")&&(r.cA=t.cA),t.hasOwnProperty("pathLenConstraint")&&(r.pathLenConstraint=t.pathLenConstraint);break;case"2.5.29.32":var u;u=e._asn1.fromDer(t.value),r.name="certificatePolicies",r.policies=s(u);break;case e.oids.subjectAltName:r.name="subjectAltName",a(r,e._asn1.fromDer(t.value));break;case e.oids.subjectKeyIdentifier:r.name="subjectKeyIdentifier",r.subjectKeyIdentifier=t.subjectKeyIdentifier;break;case"2.5.29.35":r.name="authorityKeyIdentifier",n(r,e._asn1.fromDer(t.value));break;case"2.5.29.31":r.name="cRLDistributionPoints",c(r,e._asn1.fromDer(t.value));break;case"1.3.6.1.5.5.7.1.1":default:return!0}r.value=t.value,o.extensions[r.name]=r}))};l.prototype.toAsn1=function(){return e.asn1.fromRaw(e.pki.certificateToAsn1(this._cert))},l.fromRaw=function(e,t){return new l(e,t)},l.fromPem=function(t,r){return this.fromRaw(e.pki.certificateFromPem(t,!0,!0),r)},l.fromAsn1=function(t,r,a){var n,s;if(n=e.pki.certificateFromAsn1(t.getAsn1()),void 0===r)return l.fromRaw(n);var i;i=ytcrypto.pki.publicKeyToAsn1(n.publicKey),s=e._asn1.toDer(i).getBytes(),ytcrypto.crypto.key.fromBytes(s,function(e){r(l.fromRaw(n,e))},a,n.oid)},l.fromBytes=function(t,r,a){return l.fromAsn1(e.asn1.fromDer(t),r,a)},l.fromDer=l.fromBytes,l.fromString=function(t,r,a){return l.fromAsn1(e.asn1.fromString(t),r,a)},u.Certificate=l;var p=function(e,t){this.obj={},this.obj.userAgreement=e,this.obj.userAgree={}};p.prototype.request=function(t){var r=null;switch(r=t.toLowerCase()){case"realname":this.obj.userAgree.realName=!0;break;case"gender":this.obj.userAgree.gender=!0;break;case"nationalinfo":this.obj.userAgree.nationalInfo=!0;break;case"birthdate":this.obj.userAgree.birthDate=!0;break;default:throw new e.error("unknown field:"+r)}},p.prototype.toAsn1=function(){return e.util.isUTF16String(this.obj.userAgreement)&&(this.obj.userAgreement=e.util.encodeUTF8(this.obj.userAgreement)),new e.asn1(e.kisa.PersonInfoReq.toAsn1(this.obj))},e.pki.PersonInfoReq=p}var a="pki";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);r=function(e,r){r(t,module)}}var n,s=function(t,r){r.exports=function(r){var s=n.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<s.length;++i)void 0!==s[i]&&s[i](r);return r[a]}},i=r;(r=function(e,t){return n="string"==typeof e?t.slice(2):e.slice(2),r=i,r.apply(null,Array.prototype.slice.call(arguments,0))})("js/jsrose_pki",["require","module","./jsrose_asn1","./jsrose_pkcs8","./jsrose_pkcs5","./jsrose_forge_pki"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=ytcrypto.asn1,r=e.oids,a={},n={name:"PrivateKeyInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"privateKey"},{name:"PrivateKeyInfo.attributes",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,captureAsn1:"attributes",optional:!0}]},s={name:"EncryptedPrivateKeyInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},i=function(a){var s,i,c=a,u={},l={},p=[];if(a instanceof e.asn1||(a=new e.asn1(a)),"pkcs5"in e&&(s=e.pkcs5),u=new Object,a.validate(n,l,p))i=new ytcrypto.crypto.key(ytcrypto.pki.privateKeyFromAsn1(ytcrypto.asn1.fromDer(l.privateKey)));else try{i=new ytcrypto.crypto.key(e.pki.privateKeyFromAsn1(a.getAsn1())),l.privateKeyOid=r.rsaEncryption}catch(d){throw"input may not PrivateKeyInfo:"+d}if(u.privateKey=i,u.privateKeyOID=l.privateKeyOid,u.encrypt=function(e,t,r,a){var n;if(void 0===s)throw"pkcs5 module does not loaded.";return n=s.encrypt(c.toBytes(),e,t,r,a),o(n)},u.attributes={},l.attributes){var f,y,C;l.attributes.value.forEach(function(a){switch(f=t.derToOid(a.value[0].value),y=a.value[1].value,f){case r.randomNum:C=e.util.createBuffer(y[0].value),++C.read,C=C.getBytes(),u.attributes.randomNum=C;break;default:console.log("warning - not supported privateKeyInfo attribute:"+f)}})}return u.envelopeVid=function(r,a){var n,s,i,o,c,l,p,d,f,y,C,g;if(2!==arguments.length)throw"envelopeVid: invalid arguments";if(a instanceof e.pki.Certificate)C=a;else try{C=e.pki.Certificate.fromPem(a)}catch(h){throw"Invalid Server Certificate"}c=u.attributes.randomNum,n="seed",i="CBC",s=ytcrypto.crypto.random.getBytes(16);var m=e.util.createBuffer();for(g=0;16>g;g++)m.putByte(0);o=m.getBytes(),l=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.PRINTABLESTRING,!1,r),t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,String.fromCharCode(0)+c)]);var E=e.asn1.fromDer(t.toDer(l));return p=ytcrypto.crypto.blockCipher.createEncryptionCipher(n,s,i),p.start(o),p.update(E.toBytes()),p.finish(),d=p.output.getBytes(),f=C.publicKey.raw.encrypt(s,"RSAES-PKCS1-V1_5"),y=e.util.createBuffer(),y.putBytes(f),y.putBytes(d),e.util.bytesToHex(y.getBytes())},u.toAsn1=function(){return c},u},o=function(t){var r,a,n={},o={},c=[];if(!(t instanceof e.asn1))throw"yt.pkcs8: invalid input";if("pkcs5"in e&&(a=e.pkcs5),r=t,!t.validate(s,o,c))throw"input may not EncryptedPrivateKeyInfo";return n.encryptionOID=o.encryptionOid,n.encryptionParameters=o.encryptionParams,n.encryptedData=o.encryptedData,n.decrypt=function(e){var t;if(void 0===a)throw"pkcs5 module does not loaded.";return t=a.decrypt(e,this.encryptionOID,this.encryptionParameters,this.encryptedData),i(t)},n.toAsn1=function(){return r},n};a.createPrivateKeyInfoFromAsn1=function(e){return i(e)},a.createPrivateKeyInfo=function(n,s,i){if("string"!=typeof n)throw"yt.pkcs8: invalid input privateKey:"+n;var o;if(o=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),o.value.push(t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(0).getBytes())),o.value.push(t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.rsaEncryption).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")])),o.value.push(t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,n)),s){var c;atav=t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[]),"randomNum"in s&&(c=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.randomNum).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,[t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,String.fromCharCode(0)+s.randomNum)])]),atav.value.push(c)),o.value.push(atav)}return a.createPrivateKeyInfoFromAsn1(e.asn1.fromRaw(o))},a.createEncryptedPrivateKeyInfoFromAsn1=function(e){return o(e)},e.pkcs8=a}var a="pkcs8";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);r=function(e,r){r(t,module)}}var n,s=function(t,r){r.exports=function(r){var s=n.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<s.length;++i)void 0!==s[i]&&s[i](r);return r[a]}},i=r;(r=function(e,t){return n="string"==typeof e?t.slice(2):e.slice(2),r=i,r.apply(null,Array.prototype.slice.call(arguments,0))})("js/jsrose_pkcs8",["require","module","./jsrose_asn1","./jsrose_extension","./jsrose_pkcs5","./jsrose_pki"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e._asn1,r=(e.crypto,e.pkcs7),a=e.oids,n={};n.createSignedData=function(){var n=null;return n={type:e.pki.oids.signedData,version:1,certificates:[],crls:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(s,i,o){function c(r,s){n.rawCapture={};var i;if(r.value[0].type==t.Type.OID&&(r=r.value[1].value[0]),!t.validate(r,s,n.rawCapture,i))throw"message does not signedData";n.rawCapture.signerInfos.forEach(function(r){var s,i,o,c=0;if(s={},c=1,o=ytcrypto.sha1.create(),s.issuerAndSerial={},s.issuerAndSerial.issuer={},s.issuerAndSerial.issuer.attributes=e.pki.RDNAttributesAsArray(r.value[c].value[0],o),s.issuerAndSerial.issuer.hash=o.digest().toHex(),s.issuerAndSerial.serialNumber=t.derToInteger(r.value[c].value[1].value),delete o,c++,i=e.pki.AlgorithmIdentifier.toObject(r.value[c]),s.digestAlgorithm=i,r.value[c+1].tagClass==t.Class.CONTEXT_SPECIFIC){var u;c++,u=r.value[c].value,s.signedAttributes={},u.forEach(function(e){var r,n=[];switch(r=t.derToOid(e.value[0].value),a[r]){case"contentType":n.push(e.value[1].value[0].value),s.signedAttributes[a[r]]=n;break;case"messageDigest":n.push(e.value[1].value[0].value),s.signedAttributes[a[r]]=n;break;case"signingTime":n.push(t.utcTimeToDate(e.value[1].value[0].value)),s.signedAttributes[a[r]]=n;break;default:throw"not supported attribute:"+r}})}c++;var l=r.value[c];l=e.pki.AlgorithmIdentifier.toObject(l),s.signatureAlgorithm=l,c++;signatureValue=r.value[c],s.signature=signatureValue.value,n.signerInfos||(n.signerInfos=[]),n.signerInfos.push(s)}),n.content=n.rawCapture.content.value[0].value}n.certificates=[],n.crls=[],n.digestAlgorithmIdentifiers=[],n.contentInfo=null,n.signerInfos=[],c(s.getAsn1(),r.asn1.signedDataValidator);for(var u=n.rawCapture.certificates.value,l=0;l<u.length;++l)e.pki.Certificate.fromAsn1(e.asn1.fromRaw(u[l]),function(e){n.certificates.push(e),n.certificates.length==u.length&&i(!0)},o)},toAsn1:function(r){n.contentInfo||n.sign();for(var a=[],s=0;s<n.certificates.length;++s)a.push(e.pki.certificateToAsn1(n.certificates[0]._cert));var i;return i=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(n.version).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,n.digestAlgorithmIdentifiers),n.contentInfo,t.create(t.Class.CONTEXT_SPECIFIC,0,!0,a),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,n.signerInfos)]),"undefined"!=typeof r&&r?e.asn1.fromRaw(i):e.asn1.fromRaw(t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(n.type).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[i])]))},sign:function(r,s,i){"undefined"==typeof i&&(i={});var o=!1,c=!1;if(r.hasOwnProperty("useSubjectAndSerialNumber")&&r.useSubjectAndSerialNumber&&(o=!0),r.hasOwnProperty("unWrapContentInfo")&&r.unWrapContentInfo&&(c=!0),"object"==typeof n.content)throw"content is object...";n.contentInfo=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(e.pki.oids.data).getBytes())]),"content"in n&&n.contentInfo.value.push(t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,n.content)]));var u,l,p;p="object"!==r.hash?"sha256":r.hash,u=ytcrypto.md.algorithms[p].create(),l=e.pki.AlgorithmIdentifier.toAsn1({algorithm:e.oids[p],parameters:null}),n.digestAlgorithmIdentifiers.push(l);var d,f,y;if(!("certificate"in r))throw"no cert";n.addCertificate(r.certificate),d=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[e.pki.distinguishedNameToAsn1({attributes:o?r.certificate._cert.subject.attributes:r.certificate._cert.issuer.attributes}),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,e.util.hexToBytes(r.certificate._cert.serialNumber))]);var C;if("signedAttributes"in r){var g;f=t.create(t.Class.UNIVERSAL,t.Type.SET,!0,[]),r.signedAttributes.forEach(function(e){var r,s;g=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),s=t.create(t.Class.UNIVERSAL,t.Type.SET,!0,[]),r=t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(a[e]).getBytes()),"contentType"===e?s.value.push(t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(a.data).getBytes())):"messageDigest"===e?(u.start(),u.update(n.content),s.value.push(t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,u.digest().getBytes()))):"signingTime"===e&&s.value.push(t.create(t.Class.UNIVERSAL,t.Type.UTCTIME,!1,t.dateToUtcTime(new Date))),g.value.push(r),g.value.push(s),f.value.push(g)}),C=t.toDer(f).getBytes()}else C=n.content;y={algorithm:e.oids.rsaEncryption,parameters:null};var h;h={},h.name="RSASSA-PKCS1-v1_5",h.hash={},h.hash.name="SHA-256",r.key.sign(h,C,function(r){var a=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(1).getBytes()),d,l]);void 0!==f&&(f.tagClass=t.Class.CONTEXT_SPECIFIC,f.type=0,a.value.push(f)),a.value.push(e.pki.AlgorithmIdentifier.toAsn1(y)),a.value.push(t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,r)),n.signerInfos.push(a),s("")})},verify:function(r,a){function s(e){if(i.push(e),n.signerInfos.length==i.length){for(var t=0;t<i.length;++t)if(0==i[t])return void a(!1);a(!0)}}var i=[];n.signerInfos.forEach(function(i,o){var c,u,l,p;if(p=e.oids[i.digestAlgorithm.algorithm],c=ytcrypto.md.algorithms[p],i.signedAttributes){if(c=c.create(),c.update(n.content),c.digest().toHex()!==e.util.bytesToHex(i.signedAttributes.messageDigest[0]))return e.consoleLog&&console.log("messageDigest does not matched1"),s(!1),!0;l=t.toDer(t.create(t.Class.UNIVERSAL,t.Type.SET,!0,n.rawCapture.authenticatedAttributes)).getBytes()}else l=n.content;if(n.certificates.forEach(function(e){var t=!1;if(r.hasOwnProperty("useSubjectAndSerialNumber")&&r.useSubjectAndSerialNumber&&(t=!0),t){if(i.issuerAndSerial.issuer.hash!==e._cert.subject.hash)return!0}else if(i.issuerAndSerial.issuer.hash!==e._cert.issuer.hash)return!0;return u=e.publicKey,!1}),!u)throw"not found matched publickey";var d={};switch(i.signatureAlgorithm.algorithm){case e.oids.rsaEncryption:d.name="RSASSA-PKCS1-V1_5";break;default:throw"not supported signatureAlgorithm "+i.signatureAlgorithm.algorithm}switch(d.hash={},p){case"sha256":d.hash.name="SHA-256";break;case"sha1":d.hash.name="SHA-1";break;default:throw"not supported digestAlgorithm "+p}try{u.verify(d,i.signature,l,s)}catch(f){return a(new e.error(f)),!1}})},addCertificate:function(t){"string"==typeof t&&(t=e.pki.certificateFromPem(t)),n.certificates.push(t)},addCertificateRevokationList:function(e){throw"PKCS#7 CRL support not yet implemented."},setContent:function(e){n.content=e},getContent:function(){return n.content}}},e.cms=n}var a="cms";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);r=function(e,r){r(t,module)}}var n,s=function(t,r){r.exports=function(r){var s=n.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<s.length;++i)void 0!==s[i]&&s[i](r);return r[a]}},i=r;(r=function(e,t){return n="string"==typeof e?t.slice(2):e.slice(2),r=i,r.apply(null,Array.prototype.slice.call(arguments,0))})("js/jsrose_cms",["require","module","./jsrose_asn1","./jsrose_extension"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){var t=e.cmp=e.cmp||{},r=e._asn1;e.crypto;t.catype={CROSSCERT_CA:"crosscert",SIGNKOREA_CA:"signkorea"},t.purpose={ISSUE:"issue",UPDATE:"update",REVOKE:"revoke"},t.revocationReason={unused:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,privilegeWithdrawn:7,aACompromise:8},t.getClient=function(e,r){return new t.client(e,r)},CMPClient=function(a,n){function s(t,a){m(t,function(t){data=r.toDer(t).getBytes(),e.consoleLog&&console.log("CONFIRM: "+e.util.bytesToHex(data)),A.http.send(A.url.all?A.url.all:A.url.conf,A.messageReqType,data,function(t,r,n,s){t instanceof e.error;try{l(s)}catch(i){}e.consoleLog&&e.console.log("real issuing was done."),a(A.certAndKey)})})}function i(t){C(function(a){data=r.toDer(a).getBytes(),A.http.newSession(),A.http.send(A.url.all?A.url.all:A.url.genmgenp,A.messageReqType,data,function(r,a,n,s){if(r instanceof e.error)return void t(r);e.consoleLog&&console.log(n+" "+e.util.bytesToHex(s));try{l(s),t(A.revokeResult)}catch(i){t(new e.error(i))}})})}function o(t,a,n,s){var i,o,u;if(i=e.cmp.ProtectedPart.toAsn1({header:t,body:a}),u=r.toDer(i),n.hasOwnProperty("authCode"))o=c(u,"aaaaabbbbb",n.authCode,2,ytcrypto.md.sha1.create(),ytcrypto.cmac.create(),ytcrypto.des),s(o.getBytes());else if(n.hasOwnProperty("signature")){var l={name:"RSASSA-PKCS1-v1_5",hash:{name:n.options.hash}};n.signature.sign(l,u.getBytes(),function(e){s(e)})}else s(new e.error("not supported protection algorithm"))}function c(t,r,a,n,s,i,o){var c,u="",l=0;for(c=e.util.createBuffer(),c.putBytes(r),c.putBytes(a),u=c.getBytes(),l=0;n>l;++l)s.start(),s.update(u),u=s.digest().getBytes();return i.start(o,u),i.update(t),i.getMac()}function u(e,t,r,a){this.hasOwnProperty("keyGenerator")?this.keyGenerator(e,t,r,a):ytcrypto.crypto.generateKey(e,t,r,a)}function l(a){var n,s,i=!1;if(A.type==t.catype.SIGNKOREA_CA&&(i=!0),n=r.fromDer(a),s=e.cmp.PKIMessage.toObject(n,i),"error"in s.body){var o,c;if(o=s.body.error.pKIStatusInfo,void 0!=o.statusString)throw c="cmp error from CA reason:"+o.statusString.join(),e.consoleLog&&console.log(c),c}else if("genp"in s.body)f(s.header,s.body.genp);else if("ip"in s.body)g(s.body.ip);else if("kup"in s.body)g(s.body.kup);else{if(!("rp"in s.body))throw"unknown cmp message";h(s.body.rp)}}function p(){var e={};switch(A.senderNonce=ytcrypto.random.getBytesSync(16),e={pvno:0,sender:{},recipient:{rfc822Name:" "},messageTime:new Date,senderNonce:A.senderNonce},A.purpose){case t.purpose.ISSUE:e.senderKID=A.refNum,e.sender.rfc822Name=" ";break;case t.purpose.UPDATE:;e.freeText=[],e.freeText.push("YT_NA_RENEW"),e.sender.directoryName=A.updateTarget[0].cert._cert.subject;var r=new ytcrypto.jsbn.BigInteger(A.updateTarget[0].cert.serialNumber,16);e.senderKID=r.toRadix(10),delete r;break;case t.purpose.REVOKE:e.sender.directoryName=A.revokeTarget[0].cert._cert.subject}return A.type==t.catype.SIGNKOREA_CA&&(e.recipKID="101029"),e}function d(){var t;return t={},t.header=p(),t.body={},t.body.genm=[{infoType:e.cmp.oid.id_it_caProtEncCert}],e.cmp.PKIMessage.toAsn1(t)}function f(a,n){A.attrs={},a.freeText&&a.freeText.forEach(function(e){var t;t=e.split("$"),t.forEach(function(e){var t;t=e.split("="),A.attrs[t[0]]=t[1]})}),n.forEach(function(t){t.infoType==e.cmp.oids.it_ca_ProtEncCert?(A.CAProtocolEncryptionCertificate=e.pki.certificateFromAsn1(r.fromDer(t.infoValue)),e.consoleLog&&console.log("got CA Protection Encryption certificate")):t.infoType==e.yessign.VIDCertificate.oid&&(e.consoleLog&&console.log("got VID Encryption certificate"),A.VIDEncryptionCertificate=e.pki.certificateFromAsn1(r.fromDer(t.infoValue)))}),null==A.VIDEncryptionCertificate&&(A.VIDEncryptionCertificate=A.CAProtocolEncryptionCertificate),A.type==t.catype.SIGNKOREA_CA&&(A.VIDEncryptionCertificate=A.CAProtocolEncryptionCertificate)}function y(r,a,n){var s;A.keyPair=[],s={},this.senderNonce=ytcrypto.random.getBytesSync(16),s.header={pvno:e.cmp.PKIHeader.cmp1999,sender:{rfc822Name:" "},recipient:{rfc822Name:" "},messageTime:new Date,senderKID:r,senderNonce:this.senderNonce},this.type==t.catype.SIGNKOREA_CA&&(s.header.sender.rfc822Name="YT_NA_NEW"),s.body={},s.body.ir=[];var i={name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}};u(i,!0,["sign"],function(t){return t instanceof e.error?(t.pushReason("generateKeyPair failed"),void n(t)):(e.consoleLog&&console.log("generateKey for sign in cmp ok"),A.keyPair.push({publicKey:t.publicKey,privateKey:t.privateKey}),void E(0,t.publicKey,t.privateKey,function(t){return t instanceof e.error?(t.pushReason("failed to generateCertReqMsg(0)"),void n(t)):(e.consoleLog&&console.log("generate certreq0 ok"),s.body.ir.push(t),void(A.attrs.hasOwnProperty("km_key_gen")&&"user"==A.attrs.km_key_gen?u(i,!0,["sign"],function(t){return t instanceof e.error?(t.pushReason("generateKeyPair failed"),void n(t)):(e.consoleLog&&console.log("generateKey for km in cmp ok"),A.keyPair.push({publicKey:t.publicKey,privateKey:t.privateKey}),void E(1,t.publicKey,t.privateKey,function(t){return t instanceof e.error?(t.pushReason("failed to generateCertReqMsg(1)"),void n(t)):(e.consoleLog&&console.log("generate certreq1 ok"),s.body.ir.push(t),void o(s.header,s.body,{authCode:a},function(t){s.protection=t,n(e.cmp.PKIMessage.toAsn1(s))}))}))}):(e.consoleLog&&console.log("this won't request km."),o(s.header,s.body,{authCode:a},function(t){s.protection=t,n(e.cmp.PKIMessage.toAsn1(s))}))))}))})}function C(t){var r;r={},r.header=p(),r.body={},r.header.sender.directoryName=A.revokeTarget[0].cert._cert.subject,r.header.freeText=[],r.header.freeText.push("YT_NA_REVOKE"),r.body.rr=[],A.revokeTarget.forEach(function(e){rd={},rd.certDetails={},rd.revocationReason=A.revocationReason,rd.revocationReason=String.fromCharCode(128),rd.certDetails.serialNumber=e.cert.serialNumber,rd.certDetails.issuer=e.cert._cert.issuer,r.body.rr.push(rd)}),r.header.protectionAlg={algorithm:e.oids.sha1WithRSAEncryption,parameters:null},o(r.header,r.body,{signature:A.revokeTarget[0].key,options:{hash:"SHA-1"}},function(a){r.protection=a,t(e.cmp.PKIMessage.toAsn1(r))})}function g(t){var r;r=t.caPubs,A.certAndKey=[],t.response.forEach(function(t,r){var a,n,s,i;if(0!=t.status.status)throw"CMP response is error:"+t.status.statusString.join();if(a=t.certifiedKeyPair,n=a.certOrEncCert,"encryptedCert"in n){s=n.encryptedCert;var o,c,u;o=A.keyPair[r].privateKey.decrypt(s.encSymmKey),c="01234567",console.log("EncryptedCert:"+e.util.bytesToHex(s.encValue)),console.log("decryptedCert_key:"+e.util.bytesToHex(o)),console.log("decryptedCert_iv:"+e.util.bytesToHex(c)),u=ytcrypto.des.startDecrypting(o,c),u.update(e.util.createBuffer(s.encValue)),u.finish(),console.log("decryptedCert:"+u.output.toHex())}else"certificate"in n&&(i=n.certificate);A.certAndKey.push({certificate:new e.pki.Certificate(i),privateKey:A.keyPair[r].privateKey,vid:A.keyPair[r].vid})})}function h(e){if(0!=e.status[0].status){var t=[];throw e.status.forEach(function(e){t.push(e.statusString.join(""))}),A.revokeResult=!1,"CMP response is error:"+t}A.revokeResult=!0}function m(t,r){var a,n={};a={},a.header={pvno:e.cmp.PKIHeader.cmp1999,sender:{rfc822Name:" "},recipient:{rfc822Name:" "},senderKID:""},a.body={},a.body.conf=[],t.hasOwnProperty("pbmac")&&(a.header.senderKID=t.pbmac.refNum,n.authCode=t.pbmac.authCode),o(a.header,a.body,n,function(t){a.protection=t,r(e.cmp.PKIMessage.toAsn1(a))})}function E(a,n,s,i){var o,c={},u={},l={};n.exportKeyInfo(function(n){if(n instanceof e.error&&(n.pushReason("failed to export publicKey"),i(n)),o=r.fromDer(n),c.certReq=u,u.certReqId=a,u.certTemplate=l,l.publicKey=o,A.purpose==t.purpose.UPDATE){var p={};p.issuer={},p.issuer.directoryName=A.updateTarget[a].cert._cert.issuer,p.serialNumber=A.updateTarget[a].cert.serialNumber,u.controls=[],u.controls.push({type:e.oids.oldCertId,value:p})}var d=e.oids.sha256WithRSAEncryption;S(d,o,s,function(t){return t instanceof e.error?(t.pushReason("failed to generate ProofOfPosession"),void i(t)):(c.popo=t,c.regInfo=v(a),void i(c))})})}function v(e){var t=[];return 0!=e?null:(A.keyPair[e].vid=ytcrypto.random.getBytesSync(20),t.push(T("1234561234567",A.keyPair[e].vid,A.VIDEncryptionCertificate)),t)}function I(e,t,a){var n,s;return n={idn:e,randomNum:t},s=r.toDer(HashContent.toAsn1(n)).getBytes(),a.start(),a.update(s),s=a.digest().getBytes(),a.start(),a.update(s),s=a.digest().getBytes()}function T(t,a,n){var s,i,o,c={},u={};return i={hashAlg:{algorithm:e.oids.sha256}},i.virtualID=I(t,a,ytcrypto.md.sha256.create()),s=r.toDer(e.kisa.EncryptContent.toAsn1({vid:i,randomNum:a})),o=n.publicKey.encrypt(s.getBytes()),u.version=0,u.vidEncAlg={algorithm:e.oids.rsaEncryption,parameters:null},u.certID={issuer:n.issuer,serialNumber:n.serialNumber},u.encryptedVID=o,c.type=e.kisa.EncryptedVID.oid,c.value=u,c}function S(t,a,n,s){var i,o,c={},u={},l={};u={authInfo:{sender:{rfc822Name:" "}},publicKey:a},i=e.crmf.POPOSigningKeyInput.toAsn1(u),o=r.toDer(i).getBytes(),n.sign({name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},o,function(r){return r instanceof e.error?(r.pushReason("failed to generate POPSigningKey"),void s(r)):(l.poposkInput=u,l.algorithmIdentifier={algorithm:t},l.signature=r,c.signature=l,
void s(c))})}var A=this;this.purpose="",this.type=a,this.url=n,this.http=new HTTPTransfer,this.VIDEncryptionCertificate=null,this.messageReqType=HTTPTransfer.pkiReq,A.type==t.catype.SIGNKOREA_CA&&(this.messageReqType=HTTPTransfer.signKoreaIPReq),CMPClient.prototype.setKeyGenerator=function(e){this.keyGenerator=e},CMPClient.prototype.issue=function(a,n,i){function o(t){try{y(a,n,function(i){return i instanceof e.error?void t(i):(p=r.toDer(i).getBytes(),e.consoleLog&&console.log("IR: "+e.util.bytesToHex(p)),void f.http.send(f.url.all?f.url.all:f.url.irip,f.messageReqType,p,function(r,i,o,c){if(r instanceof e.error)return void t(r);e.consoleLog&&console.log("result:"+o+" "+e.util.bytesToHex(c));try{l(c)}catch(u){return void t(new e.error(u))}e.cmp.testIssue?(e.consoleLog&&console.log("test issuing was done."),t(f.certAndKey)):s({pbmac:{refNum:a,authCode:n}},t)}))})}catch(i){t(new e.error(i))}}function c(t){u=d(),p=r.toDer(u).getBytes(),f.http.newSession(),f.http.send(f.url.all?f.url.all:f.url.genmgenp,f.messageReqType,p,function(r,a,n,s){if(r instanceof e.error)return void t(r);e.consoleLog&&console.log(n+" "+e.util.bytesToHex(s));try{l(s),o(t)}catch(i){t(new e.error(i))}})}var u,p,f=this;if(void 0==a)throw"reference number is not defined.";if(void 0==n)throw"authentication code is not defined.";if(void 0==i)throw"resultCallback is not defined.";this.purpose=t.purpose.ISSUE,this.refNum=a,this.authCode=n,c(i)},CMPClient.prototype.update=function(a,n){function i(t){var r={};g.keyPair=[],r.header=p(),r.body={},r.body.kur=[];var a={name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}};u(a,!0,["sign"],function(n){return n instanceof e.error?(n.pushReason("generateKeyPair failed"),void t(n)):(e.consoleLog&&console.log("generateKey for sign in cmp ok"),g.keyPair.push({publicKey:n.publicKey,privateKey:n.privateKey}),void E(0,n.publicKey,n.privateKey,function(n){return n instanceof e.error?(n.pushReason("failed to generateCertReqMsg(0)"),void t(n)):(e.consoleLog&&console.log("generate certreq0 ok"),r.body.kur.push(n),void(g.attrs.hasOwnProperty("km_key_gen")&&"user"==g.attrs.km_key_gen?u(a,!0,["sign"],function(a){return a instanceof e.error?(a.pushReason("generateKeyPair failed"),void t(a)):(e.consoleLog&&console.log("generateKey for km in cmp ok"),g.keyPair.push({publicKey:a.publicKey,privateKey:a.privateKey}),void E(1,a.publicKey,a.privateKey,function(a){return a instanceof e.error?(a.pushReason("failed to generateCertReqMsg(1)"),void t(a)):(e.consoleLog&&console.log("generate certreq1 ok"),r.body.kur.push(a),void o(r.header,r.body,{signature:g.updateTarget[0].key,options:{hash:"SHA-256"}},function(a){r.protection=a,t(e.cmp.PKIMessage.toAsn1(r))}))}))}):(e.consoleLog&&console.log("this won't request km."),o(r.header,r.body,{signature:g.updateTarget[0].key,options:{hash:"SHA-256"}},function(a){r.protection=a,t(e.cmp.PKIMessage.toAsn1(r))}))))}))})}function c(t){try{i(function(a){return a instanceof e.error?void t(a):(C=r.toDer(a).getBytes(),e.consoleLog&&console.log("KUR: "+e.util.bytesToHex(C)),void g.http.send(g.url.all?g.url.all:g.url.irip,g.messageReqType,C,function(r,a,n,i){if(r instanceof e.error)return void t(r);e.consoleLog&&console.log("result:"+n+" "+e.util.bytesToHex(i));try{l(i)}catch(o){return void t(new e.error(o))}e.cmp.testIssue?(e.consoleLog&&console.log("test issuing was done."),t(g.certAndKey)):s({signature:g.updateTarget[0].key},t)}))})}catch(a){t(new e.error(a))}}function f(t){y=d(),C=r.toDer(y).getBytes(),g.http.newSession(),g.http.send(g.url.all?g.url.all:g.url.genmgenp,g.messageReqType,C,function(r,a,n,s){if(r instanceof e.error)return void t(r);e.consoleLog&&console.log(n+" "+e.util.bytesToHex(s));try{l(s),c(t)}catch(i){t(new e.error(i))}})}var y,C,g=this;if(void 0==a)throw"keycert is not defined.";if(void 0==n)throw"resultCallback is not defined.";this.purpose=t.purpose.UPDATE,this.updateTarget=a,f(n)},CMPClient.prototype.revoke=function(e,r,a){if("undefined"==typeof e)throw"keycert is not defined";if(0==e.length)throw"keycert is empty.";if("undefined"==typeof r)throw"reason is not defined";if("undefined"==typeof a)throw"resultCallback is not defined";this.purpose=t.purpose.REVOKE,this.revokeTarget=e,this.revocationReason=String.fromCharCode(r),i(a)}},t.client=CMPClient,HTTPTransfer=function(){this.previousURL=null,this.previousXHR=null,this.identifier=""},HTTPTransfer.pkiReq=0,HTTPTransfer.pkiRep=5,HTTPTransfer.errorMsgRep=6,HTTPTransfer.signKoreaIPReq=48,HTTPTransfer.prototype.newSession=function(){this.identifier=""},HTTPTransfer.prototype.send=function(t,r,a,n){var s,i,o=this;i=e.util.createBuffer(),i.putInt32(a.length+3),i.putByte(10),i.putByte(0),i.putByte(r),i.putBytes(a),e.consoleLog&&console.log("HTTP Data Message: "+e.util.encode64(a)),s=new XMLHttpRequest,s.withCredentials=!0,s.open("post",t,!0),""!=this.identifier&&s.setRequestHeader("Identifier",this.identifier),s.onreadystatechange=function(){if(4==s.readyState){var t,r,a,i,c,u;if(o.identifier=s.getResponseHeader("Identifier"),200!=s.status)return void n(new e.error("XHR recieved status code:"+s.status+" with "+s.statusText));e.consoleLog&&console.log("ajax response length:"+s.responseText.length),t=e.util.createBuffer(e.util.decode64(decodeURIComponent(s.responseText))),r=t.getInt32(),a=t.getByte(),i=t.getByte(),c=t.getByte(),u=t.getBytes(),n(a,i,c,u)}},i=e.util.encode64(i.getBytes()),i=encodeURIComponent(i),s.setRequestHeader("Content-type","application/pkixcmp");try{s.send(i)}catch(c){n(new e.error(c))}},e.cmp=t}var a="cmp";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);r=function(e,r){r(t,module)}}var n,s=function(t,r){r.exports=function(r){var s=n.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<s.length;++i)void 0!==s[i]&&s[i](r);return r.cmp}},i=r;(r=function(e,t){return n="string"==typeof e?t.slice(2):e.slice(2),r=i,r.apply(null,Array.prototype.slice.call(arguments,0))})("js/jsrose_cmp",["require","module","./jsrose_forge_extension","./jsrose_cmpasn1","./jsrose_extension"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(e,t,r,a){for(var n=[],s=0;s<e.length;s++)for(var i=0;i<e[s].safeBags.length;i++){var o=e[s].safeBags[i];void 0!==a&&o.type!==a||void 0!==o.attributes[t]&&o.attributes[t].indexOf(r)>=0&&n.push(o)}return n}function r(e,t,r,s){if(t=o.fromDer(t,r),t.tagClass!==o.Class.UNIVERSAL||t.type!==o.Type.SEQUENCE||t.constructed!==!0)throw{message:"PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo"};for(var i=0;i<t.value.length;i++){var u=t.value[i],p={},d=[];if(!o.validate(u,l,p,d))throw{message:"Cannot read ContentInfo.",errors:d};var f={encrypted:!1},y=null,C=p.content.value[0];switch(o.derToOid(p.contentType)){case c.oids.data:if(C.tagClass!==o.Class.UNIVERSAL||C.type!==o.Type.OCTETSTRING)throw{message:"PKCS#12 SafeContents Data is not an OCTET STRING."};y=C.value;break;case c.oids.encryptedData:if(void 0===s)continue;y=a(C,s),f.encrypted=!0;break;default:throw{message:"Unsupported PKCS#12 contentType.",contentType:o.derToOid(p.contentType)}}f.safeBags=n(y,r,s),e.safeContents.push(f)}}function a(t,r){var a={},n=[];if(!o.validate(t,e.pkcs7.asn1.encryptedDataValidator,a,n))throw{message:"Cannot read EncryptedContentInfo. ",errors:n};var s=o.derToOid(a.contentType);if(s!==c.oids.data)throw{message:"PKCS#12 EncryptedContentInfo ContentType is not Data.",oid:s};s=o.derToOid(a.encAlgorithm);var i=c.pbe.getCipher(s,a.encParameter,r),u=e.util.createBuffer(a.encryptedContent);if(i.update(u),!i.finish())throw{message:"Failed to decrypt PKCS#12 SafeContents."};return i.output.getBytes()}function n(t,r,a){if(t=o.fromDer(t,r),t.tagClass!==o.Class.UNIVERSAL||t.type!==o.Type.SEQUENCE||t.constructed!==!0)throw{message:"PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag"};for(var n=[],i=0;i<t.value.length;i++){var u=t.value[i],l={},p=[];if(!o.validate(u,d,l,p))throw{message:"Cannot read SafeBag.",errors:p};var f={type:o.derToOid(l.bagId),attributes:s(l.bagAttributes)};n.push(f);var C,g,h=l.bagValue.value[0];switch(f.type){case c.oids.pkcs8ShroudedKeyBag:if(void 0===a)throw{message:"Found PKCS#8 ShroudedKeyBag but no password available."};if(h=c.decryptPrivateKeyInfo(h,a),null===h)throw{message:"Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?"};case c.oids.keyBag:f.key=e.pkcs8.createPrivateKeyInfoFromAsn1(e.asn1.fromRaw(h));continue;case c.oids.certBag:C=y,g=function(){if(o.derToOid(l.certId)!==c.oids.x509Certificate)throw{message:"Unsupported certificate type, only X.509 supported.",oid:o.derToOid(l.certId)};f.cert=e.pki.Certificate.fromDer(l.cert)};break;default:throw{message:"Unsupported PKCS#12 SafeBag type.",oid:f.type}}if(void 0!==C&&!o.validate(h,C,l,p))throw{message:"Cannot read PKCS#12 "+C.name,errors:p};g()}return n}function s(e){var t={};if(void 0!==e)for(var r=0;r<e.length;++r){var a={},n=[];if(!o.validate(e[r],f,a,n))throw{message:"Cannot read PKCS#12 BagAttribute.",errors:n};var s=o.derToOid(a.oid);if(void 0!==c.oids[s]){t[c.oids[s]]=[];for(var i=0;i<a.values.length;++i)t[c.oids[s]].push(a.values[i].value)}}return t}function i(t,r){var a=this,n=u.pkcs12FromAsn1(t.getAsn1(),r);this.contents={},this.contents.keys=[],n.safeContents.forEach(function(t){t.safeBags.forEach(function(t,r){var n;if(n=t.attributes.localKeyId,void 0===n)throw"pkcs12: localKeyId does not exist";switch(void 0===a.contents[n]&&(a.contents[n]={},a.contents.keys.push(n)),t.type){case e.pki.oids.pkcs8ShroudedKeyBag:case e.pki.oids.keyBag:a.contents[n].key=t.key;break;case e.pki.oids.certBag:a.contents[n].cert=t.cert;break;default:throw"not supported safeBag type:"+t.type}})})}var o=e._asn1,c=e.pki,u={},l={name:"ContentInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:o.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},p={name:"PFX",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"version"},l,{name:"PFX.macData",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:o.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},d={name:"SafeBag",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:o.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:o.Class.UNIVERSAL,type:o.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},f={name:"Attribute",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:o.Class.UNIVERSAL,type:o.Type.SET,constructed:!0,capture:"values"}]},y={name:"CertBag",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:o.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:o.Class.UNIVERSAL,type:o.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};u.pkcs12FromAsn1=function(a,n,s){"string"==typeof n?(s=n,n=!0):void 0===n&&(n=!0);var i={},l=[];if(!o.validate(a,p,i,l))throw{message:"Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.",errors:l};var d={version:i.version.charCodeAt(0),safeContents:[],getBags:function(r){var a,n={};return"localKeyId"in r?a=r.localKeyId:"localKeyIdHex"in r&&(a=e.util.hexToBytes(r.localKeyIdHex)),void 0!==a&&(n.localKeyId=t(d.safeContents,"localKeyId",a,r.bagType)),"friendlyName"in r&&(n.friendlyName=t(d.safeContents,"friendlyName",r.friendlyName,r.bagType)),n},getBagsByFriendlyName:function(e,r){return t(d.safeContents,"friendlyName",e,r)},getBagsByLocalKeyId:function(e,r){return t(d.safeContents,"localKeyId",e,r)}};if(3!==i.version.charCodeAt(0))throw{message:"PKCS#12 PFX of version other than 3 not supported.",version:i.version.charCodeAt(0)};if(o.derToOid(i.contentType)!==c.oids.data)throw{message:"Only PKCS#12 PFX in password integrity mode supported.",oid:o.derToOid(i.contentType)};var f=i.content.value[0];if(f.tagClass!==o.Class.UNIVERSAL||f.type!==o.Type.OCTETSTRING)throw{message:"PKCS#12 authSafe content data is not an OCTET STRING."};if(i.mac&&s){var y=null,C=0,g=o.derToOid(i.macAlgorithm);switch(g){case c.oids.sha1:y=ytcrypto.md.sha1.create(),C=20;break;case c.oids.sha256:y=ytcrypto.md.sha256.create(),C=32;break;case c.oids.sha384:y=ytcrypto.md.sha384.create(),C=48;break;case c.oids.sha512:y=ytcrypto.md.sha512.create(),C=64;break;case c.oids.md5:y=ytcrypto.md.md5.create(),C=16}if(null===y)throw{message:"PKCS#12 uses unsupported MAC algorithm: "+g};var h=new e.util.ByteBuffer(i.macSalt),m="macIterations"in i?parseInt(e.util.bytesToHex(i.macIterations),16):1,E=u.generateKey(s||"",h,3,m,C,y),v=ytcrypto.hmac.create();v.start(y,E),v.update(f.value);var I=v.getMac();if(I.getBytes()!==i.macDigest)throw{message:"PKCS#12 MAC could not be verified. Invalid password?"}}return r(d,f.value,n,s),d},generatePkcs12Key=function(t,r,a,n,s,i){var o,c;"undefined"!=typeof i&&null!==i||(i=ytcrypto.md.sha1.create());var u=i.digestLength,l=i.blockLength,p=new e.util.ByteBuffer,d=new e.util.ByteBuffer;for(c=0;c<t.length;c++)d.putInt16(t.charCodeAt(c));d.putInt16(0);var f=d.length(),y=r.length(),C=new e.util.ByteBuffer;C.fillWithByte(a,l);var g=l*Math.ceil(y/l),h=new e.util.ByteBuffer;for(c=0;g>c;c++)h.putByte(r.at(c%y));var m=l*Math.ceil(f/l),E=new e.util.ByteBuffer;for(c=0;m>c;c++)E.putByte(d.at(c%f));var v=h;v.putBuffer(E);for(var I=Math.ceil(s/u),T=1;I>=T;T++){var S=new e.util.ByteBuffer;S.putBytes(C.bytes()),S.putBytes(v.bytes());for(var A=0;n>A;A++)i.start(),i.update(S.getBytes()),S=i.digest();var N=new e.util.ByteBuffer;for(c=0;l>c;c++)N.putByte(S.at(c%u));var R=Math.ceil(y/l)+Math.ceil(f/l),b=new e.util.ByteBuffer;for(o=0;R>o;o++){var U=new e.util.ByteBuffer(v.getBytes(l)),B=511;for(c=N.length()-1;c>=0;c--)B>>=8,B+=N.at(c)+U.at(c),U.setAt(c,255&B);b.putBuffer(U)}v=b,p.putBuffer(S)}return p.truncate(p.length()-s),p},u.generateKey=generatePkcs12Key;var C={};i.fromAsn1=function(e,t){return new i(e,t)},i.fromString=function(t,r){return i.fromAsn1(e.asn1.fromString(t),r)},i.generateToAsn1=function(t,r,a,n){n=n||{},n.saltSize=n.saltSize||8,n.count=n.count||2048,n.algorithm=n.algorithm||n.encAlgorithm||"aes128","useMac"in n||(n.useMac=!0),"localKeyId"in n||(n.localKeyId=null),"generateLocalKeyId"in n||(n.generateLocalKeyId=!0);var s,i=n.localKeyId;if(null!==i)i=e.util.hexToBytes(i);else if(n.generateLocalKeyId)if(r){var l=e.util.isArray(r)?r[0]:r;"string"==typeof l?l=c.certificateFromPem(l):l.constructor===e.pki.Certificate&&(l=l._cert);var p=ytcrypto.md.sha1.create();p.update(o.toDer(c.certificateToAsn1(l)).getBytes()),i=p.digest().getBytes()}else i=ytcrypto.random.getBytes(20);var d=[];null!==i&&d.push(o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(c.oids.localKeyId).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SET,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,i)])])),"friendlyName"in n&&d.push(o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(c.oids.friendlyName).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SET,!0,[o.create(o.Class.UNIVERSAL,o.Type.BMPSTRING,!1,n.friendlyName)])])),d.length>0&&(s=o.create(o.Class.UNIVERSAL,o.Type.SET,!0,d));var f=[],y=[];null!==r&&(y=e.util.isArray(r)?r:[r]);for(var C=[],g=0;g<y.length;++g){r=y[g],"string"==typeof r?r=c.certificateFromPem(r):r.constructor===e.pki.Certificate&&(r=r._cert);var h=0===g?s:void 0,m=c.certificateToAsn1(r),E=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(c.oids.certBag).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(c.oids.x509Certificate).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(m).getBytes())])])]),h]);C.push(E)}if(C.length>0){var v=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,C),I=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(c.oids.data).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(v).getBytes())])]);f.push(I)}var T=null;if(null!==t){var S=t.toAsn1().getAsn1();T=null===a?o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(c.oids.keyBag).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[S]),s]):o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(c.oids.pkcs8ShroudedKeyBag).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[c.encryptPrivateKeyInfo(S,a,n)]),s]);var A=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[T]),N=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(c.oids.data).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(A).getBytes())])]);f.push(N)}var R,b=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,f);if(n.useMac){var p=ytcrypto.md.sha1.create(),U=new e.util.ByteBuffer(ytcrypto.random.getBytes(n.saltSize)),B=n.count,t=u.generateKey(a||"",U,3,B,20),P=ytcrypto.hmac.create();P.start(p,t),P.update(o.toDer(b).getBytes());var O=P.getMac();R=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(c.oids.sha1).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,O.getBytes())]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,U.getBytes()),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(B).getBytes())])}return e.asn1.fromRaw(o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(3).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(c.oids.data).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(b).getBytes())])]),R]))},C.PFX=i,e.pkcs12=C}var a="pkcs12";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={}),e(yt);r=function(e,r){r(t,module)}}var n,s=function(t,r){r.exports=function(r){var s=n.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<s.length;++i)void 0!==s[i]&&s[i](r);return r[a]}},i=r;(r=function(e,t){return n="string"==typeof e?t.slice(2):e.slice(2),r=i,r.apply(null,Array.prototype.slice.call(arguments,0))})("js/jsrose_pkcs12",["require","module","./jsrose_asn1","./jsrose_extension"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function e(e){function t(){throw"not implemented. see u soon!"}e.consoleLog=!1,e.console={},e.console.log=function(t){0!=e.consoleLog&&("undefined"==typeof window.console?document.title=t:window.console.log(t))},e.error=function(e,t){void 0===t&&(t=e,e=void 0),this.code=e,this.reason=[t],this.getReason=function(){return this.reason},this.pushReason=function(e){this.reason.push(e)}},e.common={},e.common.addEvent=function(e,t,r){var a,n;if(a=t.toLowerCase(),n=a.indexOf("on"),window.addEventListener)0==n&&(a=a.substring(2)),e.addEventListener(a,r,!1),e[a]||(e[a]=r);else{if(!window.attachEvent)throw"unknown add event method";0!=n&&(a="on"+a),e.attachEvent(a,r)}},t.prototype.toArrayBuffer=function(){},t.prototype.toHex=function(){},t.fromString=function(){return new t},e.bytes=t}var a="yt";if("function"!=typeof r){if("object"!=typeof module||!module.exports)return"undefined"==typeof yt&&(yt={disableNativeCode:!1}),e(yt);var n=!0;r=function(e,r){r(t,module)}}var s,i=function(t,r){r.exports=function(r){var n=s.map(function(e){return t(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[a])return r[a];r.defined[a]=!0;for(var i=0;i<n.length;++i)n[i](r);return r},r.exports.disableNativeCode=!1,r.exports(r.exports)},o=r;(r=function(e,t){return s="string"==typeof e?t.slice(2):e.slice(2),n?(delete r,o.apply(null,Array.prototype.slice.call(arguments,0))):(r=o,r.apply(null,Array.prototype.slice.call(arguments,0)))})("js/jsrose",["require","module","./jsrose_asn1","./jsrose_forge_extension","./jsrose_extension","./jsrose_cmpasn1","./jsrose_pkcs8","./jsrose_pkcs5","./jsrose_pki","./jsrose_cms","./jsrose_cmp","./jsrose_pkcs12"],function(){i.apply(null,Array.prototype.slice.call(arguments,0))})}(),window.yt=window.yt||{},window.yt=t("js/jsrose"),window.yt.crypto=window.ytcrypto.crypto,window.yt.getVersion=function(){return"2.2.0_859a9068a9c64fe56d7d3e0f6c481cbffec4fce1"}}();